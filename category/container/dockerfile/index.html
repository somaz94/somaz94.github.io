<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    
    

    
    

    
    

    <!-- ‚úÖ Google Tag Manager Ï∂îÍ∞Ä -->
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MBP83N4Q');
    </script>
      <!-- ‚úÖ End Google Tag Manager -->

    <!-- Mermaid.js ÏßÅÏ†ë Î°úÎìú -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>

    <title>Dockerfile - Complete Guide to Container Image Creation and Best Practices | somaz</title>
    <meta name="description" content="Comprehensive guide to Dockerfile creation, instructions, best practices, and security configurations for building efficient Docker images">
    
        <meta name="keywords" content="dockerfile, docker, container-images, automation, devops, image-optimization, security, best-practices, multi-stage-builds">
    

    <!-- Social: Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Dockerfile - Complete Guide to Container Image Creation and Best Practices | somaz">
    <meta name="twitter:description" content="Comprehensive guide to Dockerfile creation, instructions, best practices, and security configurations for building efficient Docker images">

    
        <meta property="twitter:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1755656803/dockerfile-1_xe6akt.png">
    
    
    
        <meta name="twitter:site" content="@twitter_username">
    

    <!-- Social: Facebook / Open Graph -->
    <meta property="og:url" content="https://somaz.blog/category/container/dockerfile/">
    <meta property="og:title" content="Dockerfile - Complete Guide to Container Image Creation and Best Practices | somaz">
    <meta property="og:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1755656803/dockerfile-1_xe6akt.png">
    <meta property="og:description" content="Comprehensive guide to Dockerfile creation, instructions, best practices, and security configurations for building efficient Docker images">
    <meta property="og:site_name" content="Somaz Tech Blog">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/img/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png" />

    <!-- Windows 8 Tile Icons -->
    <meta name="application-name" content="somaz">
    <meta name="msapplication-TileColor" content="#141414">
    <meta name="msapplication-square70x70logo" content="smalltile.png" />
    <meta name="msapplication-square150x150logo" content="mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="widetile.png" />
    <meta name="msapplication-square310x310logo" content="largetile.png" />
    
    <!-- Android Lolipop Theme Color -->
    <meta name="theme-color" content="#141414">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="canonical" href="https://somaz.blog/category/container/dockerfile/">
    <link rel="alternate" type="application/rss+xml" title="Somaz Tech Blog" href="https://somaz.blog/feed.xml" />

    <!-- Include extra styles -->
    

    <!-- JavaScript enabled/disabled -->
    <script>
        document.querySelector('html').classList.remove('no-js');
    </script>

    <!-- Google Adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8725590811736154"
        crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"> -->
    <!-- <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/variable/woff2/SUIT-Variable.css" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;700&display=swap" rel="stylesheet"> -->

    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />

</head>
<!-- ‚úÖ Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBP83N4Q"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- ‚úÖ End Google Tag Manager (noscript) -->
    <body class="has-push-menu">
        





        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-close" viewBox="0 0 1000 1000"><path d="M969.8,870.3c27,27.7,27,71.8,0,99.1C955.7,983,937.9,990,920,990c-17.9,0-35.7-7-49.7-20.7L500,599L129.6,969.4C115.6,983,97.8,990,79.9,990s-35.7-7-49.7-20.7c-27-27.3-27-71.4,0-99.1L400.9,500L30.3,129.3c-27-27.3-27-71.4,0-99.1c27.3-27,71.8-27,99.4,0L500,400.9L870.4,30.2c27.7-27,71.8-27,99.4,0c27,27.7,27,71.8,0,99.1L599.1,500L969.8,870.3z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-clock" viewBox="0 0 1000 1000"><path d="M500,10C229.8,10,10,229.8,10,500c0,270.2,219.8,490,490,490c270.2,0,490-219.8,490-490C990,229.8,770.2,10,500,10z M500,910.2c-226.2,0-410.2-184-410.2-410.2c0-226.2,184-410.2,410.2-410.2c226.2,0,410.2,184,410.2,410.2C910.2,726.1,726.2,910.2,500,910.2z M753.1,374c8.2,11.9,5.2,28.1-6.6,36.3L509.9,573.7c-4.4,3.1-9.6,4.6-14.8,4.6c-4.1,0-8.3-1-12.1-3c-8.6-4.5-14-13.4-14-23.1V202.5c0-14.4,11.7-26.1,26.1-26.1c14.4,0,26.1,11.7,26.1,26.1v300l195.6-135.1C728.7,359.2,744.9,362.1,753.1,374z"/></symbol><symbol id="icon-calendar" viewBox="0 0 1000 1000"><path d="M920,500v420H80V500H920 M990,430H10v490c0,38.7,31.3,70,70,70h840c38.7,0,70-31.3,70-70V430L990,430z"/><path d="M850,80v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80H360v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80C72.8,80,10,142.7,10,220v140h980V220C990,142.7,927.2,80,850,80z"/><path d="M255,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C290,25.8,274.3,10,255,10z"/><path d="M745,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C780,25.8,764.3,10,745,10z"/></symbol><symbol id="icon-github" viewBox="0 0 12 14"><path d="M6 1q1.633 0 3.012 0.805t2.184 2.184 0.805 3.012q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.312-0.055t-0.102-0.234q0-0.023 0.004-0.598t0.004-1.051q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.93-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.664-0.105q-0.352 0.883-0.062 1.594-0.617 0.68-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.305 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.691t0.004 0.426q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805zM2.273 9.617q0.023-0.055-0.055-0.094-0.078-0.023-0.102 0.016-0.023 0.055 0.055 0.094 0.070 0.047 0.102-0.016zM2.516 9.883q0.055-0.039-0.016-0.125-0.078-0.070-0.125-0.023-0.055 0.039 0.016 0.125 0.078 0.078 0.125 0.023zM2.75 10.234q0.070-0.055 0-0.148-0.062-0.102-0.133-0.047-0.070 0.039 0 0.141t0.133 0.055zM3.078 10.562q0.062-0.062-0.031-0.148-0.094-0.094-0.156-0.023-0.070 0.062 0.031 0.148 0.094 0.094 0.156 0.023zM3.523 10.758q0.023-0.086-0.102-0.125-0.117-0.031-0.148 0.055t0.102 0.117q0.117 0.047 0.148-0.047zM4.016 10.797q0-0.102-0.133-0.086-0.125 0-0.125 0.086 0 0.102 0.133 0.086 0.125 0 0.125-0.086zM4.469 10.719q-0.016-0.086-0.141-0.070-0.125 0.023-0.109 0.117t0.141 0.062 0.109-0.109z"></path></symbol><symbol id="icon-medium" viewBox="0 0 1000 1000"><path d="M336.5,240.2v641.5c0,9.1-2.3,16.9-6.8,23.2s-11.2,9.6-20,9.6c-6.2,0-12.2-1.5-18-4.4L37.3,782.7c-7.7-3.6-14.1-9.8-19.4-18.3S10,747.4,10,739V115.5c0-7.3,1.8-13.5,5.5-18.6c3.6-5.1,8.9-7.7,15.9-7.7c5.1,0,13.1,2.7,24.1,8.2l279.5,140C335.9,238.6,336.5,239.5,336.5,240.2L336.5,240.2z M371.5,295.5l292,473.6l-292-145.5V295.5z M990,305.3v576.4c0,9.1-2.6,16.5-7.7,22.1c-5.1,5.7-12,8.5-20.8,8.5s-17.3-2.4-25.7-7.1L694.7,784.9L990,305.3z M988.4,239.7c0,1.1-46.8,77.6-140.3,229.4C754.6,621,699.8,709.8,683.8,735.7L470.5,389l177.2-288.2c6.2-10.2,15.7-15.3,28.4-15.3c5.1,0,9.8,1.1,14.2,3.3l295.9,147.7C987.6,237.1,988.4,238.2,988.4,239.7L988.4,239.7z"/></symbol><symbol id="icon-instagram" viewBox="0 0 489.84 489.84"><path d="M249.62,50.46c65.4,0,73.14.25,99,1.43C372.47,53,385.44,57,394.07,60.32a75.88,75.88,0,0,1,28.16,18.32,75.88,75.88,0,0,1,18.32,28.16c3.35,8.63,7.34,21.6,8.43,45.48,1.18,25.83,1.43,33.57,1.43,99s-0.25,73.14-1.43,99c-1.09,23.88-5.08,36.85-8.43,45.48a81.11,81.11,0,0,1-46.48,46.48c-8.63,3.35-21.6,7.34-45.48,8.43-25.82,1.18-33.57,1.43-99,1.43s-73.15-.25-99-1.43c-23.88-1.09-36.85-5.08-45.48-8.43A75.88,75.88,0,0,1,77,423.86,75.88,75.88,0,0,1,58.69,395.7c-3.35-8.63-7.34-21.6-8.43-45.48-1.18-25.83-1.43-33.57-1.43-99s0.25-73.14,1.43-99c1.09-23.88,5.08-36.85,8.43-45.48A75.88,75.88,0,0,1,77,78.64a75.88,75.88,0,0,1,28.16-18.32c8.63-3.35,21.6-7.34,45.48-8.43,25.83-1.18,33.57-1.43,99-1.43m0-44.13c-66.52,0-74.86.28-101,1.47s-43.87,5.33-59.45,11.38A120.06,120.06,0,0,0,45.81,47.44,120.06,120.06,0,0,0,17.56,90.82C11.5,106.4,7.36,124.2,6.17,150.27s-1.47,34.46-1.47,101,0.28,74.86,1.47,101,5.33,43.87,11.38,59.45a120.06,120.06,0,0,0,28.25,43.38,120.06,120.06,0,0,0,43.38,28.25c15.58,6.05,33.38,10.19,59.45,11.38s34.46,1.47,101,1.47,74.86-.28,101-1.47,43.87-5.33,59.45-11.38a125.24,125.24,0,0,0,71.63-71.63c6.05-15.58,10.19-33.38,11.38-59.45s1.47-34.46,1.47-101-0.28-74.86-1.47-101-5.33-43.87-11.38-59.45a120.06,120.06,0,0,0-28.25-43.38,120.06,120.06,0,0,0-43.38-28.25C394.47,13.13,376.67,9,350.6,7.8s-34.46-1.47-101-1.47h0Z" transform="translate(-4.7 -6.33)" /><path d="M249.62,125.48A125.77,125.77,0,1,0,375.39,251.25,125.77,125.77,0,0,0,249.62,125.48Zm0,207.41a81.64,81.64,0,1,1,81.64-81.64A81.64,81.64,0,0,1,249.62,332.89Z" transform="translate(-4.7 -6.33)"/><circle cx="375.66" cy="114.18" r="29.39" /></symbol><symbol id="icon-linkedin" viewBox="0 0 12 14"><path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"></path></symbol><symbol id="icon-heart" viewBox="0 0 34 30"><path d="M17,29.7 L16.4,29.2 C3.5,18.7 0,15 0,9 C0,4 4,0 9,0 C13.1,0 15.4,2.3 17,4.1 C18.6,2.3 20.9,0 25,0 C30,0 34,4 34,9 C34,15 30.5,18.7 17.6,29.2 L17,29.7 Z M9,2 C5.1,2 2,5.1 2,9 C2,14.1 5.2,17.5 17,27.1 C28.8,17.5 32,14.1 32,9 C32,5.1 28.9,2 25,2 C21.5,2 19.6,4.1 18.1,5.8 L17,7.1 L15.9,5.8 C14.4,4.1 12.5,2 9,2 Z" id="Shape"></path></symbol><symbol id="icon-arrow-right" viewBox="0 0 25.452 25.452"><path d="M4.471,24.929v-2.004l12.409-9.788c0.122-0.101,0.195-0.251,0.195-0.411c0-0.156-0.073-0.31-0.195-0.409L4.471,2.526V0.522c0-0.2,0.115-0.384,0.293-0.469c0.18-0.087,0.396-0.066,0.552,0.061l15.47,12.202c0.123,0.1,0.195,0.253,0.195,0.409c0,0.16-0.072,0.311-0.195,0.411L5.316,25.34c-0.155,0.125-0.372,0.147-0.552,0.061C4.586,25.315,4.471,25.13,4.471,24.929z"/></symbol><symbol id="icon-star" viewBox="0 0 48 48"><path fill="currentColor" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"/><path fill="#ffffff" d="M24,11l3.898,7.898l8.703,1.301l-6.301,6.102l1.5,8.699L24,30.898L16.199,35l1.5-8.699l-6.301-6.102  l8.703-1.301L24,11z"/></symbol><symbol id="icon-read" viewBox="0 0 32 32"><path fill="currentColor" d="M29,4H3C1.343,4,0,5.343,0,7v18c0,1.657,1.343,3,3,3h10c0,0.552,0.448,1,1,1h4c0.552,0,1-0.448,1-1h10  c1.657,0,3-1.343,3-3V7C32,5.343,30.657,4,29,4z M29,5v20H18.708c-0.618,0-1.236,0.146-1.789,0.422l-0.419,0.21V5H29z M15.5,5  v20.632l-0.419-0.21C14.528,25.146,13.91,25,13.292,25H3V5H15.5z M31,25c0,1.103-0.897,2-2,2H18v1h-4v-1H3c-1.103,0-2-0.897-2-2V7  c0-0.737,0.405-1.375,1-1.722V25c0,0.552,0.448,1,1,1h10.292c0.466,0,0.925,0.108,1.342,0.317l0.919,0.46  c0.141,0.07,0.294,0.106,0.447,0.106c0.153,0,0.306-0.035,0.447-0.106l0.919-0.46C17.783,26.108,18.242,26,18.708,26H29  c0.552,0,1-0.448,1-1V5.278C30.595,5.625,31,6.263,31,7V25z M6,12.5C6,12.224,6.224,12,6.5,12h5c0.276,0,0.5,0.224,0.5,0.5  S11.776,13,11.5,13h-5C6.224,13,6,12.776,6,12.5z M6,14.5C6,14.224,6.224,14,6.5,14h5c0.276,0,0.5,0.224,0.5,0.5S11.776,15,11.5,15  h-5C6.224,15,6,14.776,6,14.5z M6,16.5C6,16.224,6.224,16,6.5,16h5c0.276,0,0.5,0.224,0.5,0.5S11.776,17,11.5,17h-5  C6.224,17,6,16.776,6,16.5z M20,12.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,13,25.5,13h-5  C20.224,13,20,12.776,20,12.5z M20,14.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,15,25.5,15h-5  C20.224,15,20,14.776,20,14.5z M20,16.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,17,25.5,17h-5  C20.224,17,20,16.776,20,16.5z"></path></symbol><symbol id="icon-tistory" viewBox="0 0 24 24"><path d="M4 4h16v3h-6v13h-4V7H4V4z"/></symbol></defs></svg>

        <header class="bar-header">
    <a id="menu" role="button">
        <svg id="open" class="icon-menu"><use xlink:href="#icon-menu"></use></svg>
    </a>
    <h1 class="logo">
        <a href="/">
            
                somaz <span class="version">v3.1.2</span>
            
        </a>
    </h1>
    <a id="search" class="dosearch" role="button">
        <svg class="icon-search"><use xlink:href="#icon-search"></use></svg>
    </a>
    
        <a href="https://github.com/thiagorossener/jekflix-template" class="get-theme" role="button">
            Get this theme!
        </a>
    
</header>

<div id="mask" class="overlay"></div>

<aside class="sidebar" id="sidebar">
    <nav id="navigation">
      <h2>Menu</h2>
      <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>

    </nav>
</aside>

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search">
        <svg class="icon-remove-sign"><use xlink:href="#icon-close"></use></svg>
        <ul class="search-results search-list"></ul>
    </div>
</div>



        <section class="post two-columns">
            <article role="article" class="post-content">
                <p class="post-info">
                    
                        <svg class="icon-calendar" id="date"><use xlink:href="#icon-calendar"></use></svg>
                        <time class="date" datetime="2026-01-20T00:00:00+00:00">
                            


January 20, 2026

                        </time>
                    
                    <svg id="clock" class="icon-clock"><use xlink:href="#icon-clock"></use></svg>
                    <span>15 min to read</span>
                </p>
                <h1 class="post-title">Dockerfile - Complete Guide to Container Image Creation and Best Practices</h1>
                <p class="post-subtitle">Master containerized application development with Dockerfile automation and optimization</p>

                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1755656803/dockerfile-1_xe6akt.png" alt="Featured image" class="post-cover">
                

                <!-- Pagination links -->



                <!-- Add your table of contents here -->


                <p><br /></p>

<hr />

<h2 id="overview">Overview</h2>

<p><strong>Dockerfile</strong> is a script containing a series of instructions that Docker uses to automatically build container images.</p>

<p>It serves as a blueprint for creating consistent, reproducible environments that can run anywhere Docker is installed.</p>

<p>By defining your application‚Äôs dependencies, configuration, and runtime environment in a single text file, Dockerfile enables <strong>Infrastructure as Code</strong> for containerized applications.</p>

<p>Dockerfile transforms the complex process of container creation into <strong>automated, version-controlled, and reproducible workflows</strong>.</p>

<p>It ensures that your application runs consistently across development, testing, and production environments, eliminating the ‚Äúit works on my machine‚Äù problem.</p>

<p><br /></p>

<h3 id="key-benefits-of-dockerfile">Key Benefits of Dockerfile</h3>

<div class="info-box info-box-success-not-check">
  <strong>Why Use Dockerfile?</strong>
  <ul>
    <li><strong>Automation</strong>: Eliminates manual container setup and configuration</li>
    <li><strong>Reproducibility</strong>: Ensures consistent environments across all deployment stages</li>
    <li><strong>Version Control</strong>: Track changes to your infrastructure alongside your code</li>
    <li><strong>Portability</strong>: Run identical containers on any Docker-compatible system</li>
    <li><strong>Efficiency</strong>: Leverage layer caching for faster builds and smaller images</li>
    <li><strong>Documentation</strong>: Self-documenting infrastructure requirements</li>
  </ul>
</div>

<p><br /></p>

<hr />

<h2 id="dockerfile-architecture-and-workflow">Dockerfile Architecture and Workflow</h2>

<p>Understanding how Dockerfile integrates with the Docker ecosystem is crucial for effective container development.</p>

<p><br /></p>

<h3 id="container-build-workflow">Container Build Workflow</h3>

<div style="width: 100%; margin: 20px auto;">
  <div class="mermaid">
    graph TD
        A[Dockerfile] --&gt; B[docker build]
        B --&gt; C[Docker Image]
        C --&gt; D[Container Registry]
        C --&gt; E[docker run]
        E --&gt; F[Running Container]
        
        G[Application Code] --&gt; A
        H[Dependencies] --&gt; A
        I[Configuration] --&gt; A
        
        style A fill:#f9f,stroke:#333,stroke-width:2px
        style C fill:#bbf,stroke:#333,stroke-width:2px
        style F fill:#bfb,stroke:#333,stroke-width:2px
  </div>
</div>

<p><br /></p>

<h3 id="layer-based-architecture">Layer-Based Architecture</h3>

<p>Dockerfile creates images using a <strong>layered filesystem</strong> where each instruction creates a new layer. This architecture enables:</p>

<ul>
  <li><strong>Efficient Storage</strong>: Shared layers reduce disk usage</li>
  <li><strong>Fast Builds</strong>: Unchanged layers are cached and reused</li>
  <li><strong>Incremental Updates</strong>: Only modified layers need rebuilding</li>
  <li><strong>Network Efficiency</strong>: Layer-based image distribution</li>
</ul>

<p><br /></p>

<hr />

<h2 id="dockerfile-instructions-reference">Dockerfile Instructions Reference</h2>

<p>Master the essential Dockerfile instructions for building robust container images.</p>

<p><br /></p>

<h3 id="core-instructions-overview">Core Instructions Overview</h3>

<div class="table-container">
  <table class="table-beauty">
    <tr>
      <th style="width: 20%;">Instruction</th>
      <th style="width: 80%;">Description</th>
    </tr>
    <tr>
      <td><strong>FROM</strong></td>
      <td>Specifies the base image from Docker Hub, GCR, Quay, ECR, or other registries</td>
    </tr>
    <tr>
      <td><strong>RUN</strong></td>
      <td>Executes commands during build time (package installation, compilation)</td>
    </tr>
    <tr>
      <td><strong>COPY</strong></td>
      <td>Copies files and directories from build context to container filesystem</td>
    </tr>
    <tr>
      <td><strong>ADD</strong></td>
      <td>Advanced file copying with URL download and archive extraction capabilities</td>
    </tr>
    <tr>
      <td><strong>WORKDIR</strong></td>
      <td>Sets the working directory for subsequent instructions</td>
    </tr>
    <tr>
      <td><strong>ENV</strong></td>
      <td>Sets environment variables available during build and runtime</td>
    </tr>
    <tr>
      <td><strong>ARG</strong></td>
      <td>Defines build-time variables that can be passed during image building</td>
    </tr>
    <tr>
      <td><strong>EXPOSE</strong></td>
      <td>Documents which ports the container will listen on at runtime</td>
    </tr>
    <tr>
      <td><strong>VOLUME</strong></td>
      <td>Creates mount points for external volumes or bind mounts</td>
    </tr>
    <tr>
      <td><strong>USER</strong></td>
      <td>Specifies the user context for running containers (security best practice)</td>
    </tr>
    <tr>
      <td><strong>LABEL</strong></td>
      <td>Adds metadata to images using key-value pairs</td>
    </tr>
    <tr>
      <td><strong>CMD</strong></td>
      <td>Provides default command to execute when container starts (overridable)</td>
    </tr>
    <tr>
      <td><strong>ENTRYPOINT</strong></td>
      <td>Configures container to run as executable with fixed entry command</td>
    </tr>
  </table>
</div>

<p><br /></p>

<h3 id="critical-instruction-differences-run-vs-cmd-vs-entrypoint">Critical Instruction Differences: RUN vs CMD vs ENTRYPOINT</h3>

<p>Understanding when to use each execution instruction is fundamental to Dockerfile mastery.</p>

<h4 id="run-instruction">RUN Instruction</h4>

<ul>
  <li><strong>Purpose</strong>: Execute commands during image build process</li>
  <li><strong>Timing</strong>: Build-time only</li>
  <li><strong>Use Cases</strong>: Package installation, compilation, configuration setup</li>
</ul>

<script src="https://gist.github.com/somaz94/32060f03b8693cd8ebbd2f65b9232208.js"></script>

<p><br /></p>

<h4 id="cmd-instruction">CMD Instruction</h4>

<ul>
  <li><strong>Purpose</strong>: Define default command executed when container starts</li>
  <li><strong>Timing</strong>: Runtime</li>
  <li><strong>Behavior</strong>: Overridable by docker run arguments</li>
</ul>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Shell format</span>
<span class="k">CMD</span><span class="s"> nginx -g "daemon off;"</span>

<span class="c"># Exec format (recommended)</span>
<span class="k">CMD</span><span class="s"> ["nginx", "-g", "daemon off;"]</span>

<span class="c"># As default parameters to ENTRYPOINT</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["python3"]</span>
<span class="k">CMD</span><span class="s"> ["app.py"]  # Default argument</span>
</code></pre></div></div>

<h4 id="entrypoint-instruction">ENTRYPOINT Instruction</h4>

<ul>
  <li><strong>Purpose</strong>: Configure container as executable with fixed entry point</li>
  <li><strong>Timing</strong>: Runtime</li>
  <li><strong>Behavior</strong>: Cannot be overridden, arguments are appended</li>
</ul>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Basic ENTRYPOINT</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["python3", "app.py"]</span>

<span class="c"># ENTRYPOINT with CMD for flexible defaults</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["python3", "app.py"]</span>
<span class="k">CMD</span><span class="s"> ["--port", "8080"]</span>

<span class="c"># Usage examples:</span>
<span class="c"># docker run myapp                    -&gt; python3 app.py --port 8080</span>
<span class="c"># docker run myapp --port 3000       -&gt; python3 app.py --port 3000</span>
<span class="c"># docker run myapp --debug           -&gt; python3 app.py --debug</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="basic-dockerfile-creation">Basic Dockerfile Creation</h2>

<p>Learn to create your first Dockerfile with a practical nginx web server example.</p>

<p><br /></p>

<h3 id="project-structure-setup">Project Structure Setup</h3>

<p>Create a well-organized directory structure for your Docker project:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create project directory</span>
<span class="nb">mkdir </span>nginx-image <span class="o">&amp;&amp;</span> <span class="nb">cd </span>nginx-image

<span class="c"># Create subdirectories</span>
<span class="nb">mkdir </span>files
<span class="nb">mkdir </span>config
<span class="nb">mkdir </span>scripts

<span class="c"># Create essential files</span>
<span class="nb">touch </span>Dockerfile
<span class="nb">touch</span> .dockerignore
<span class="nb">touch </span>README.md
</code></pre></div></div>

<h3 id="dockerignore-configuration">.dockerignore Configuration</h3>

<p>The <code class="language-plaintext highlighter-rouge">.dockerignore</code> file prevents unnecessary files from being sent to the Docker daemon, reducing build context size and improving security.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version control</span>
.git
.gitignore
.dockerignore

<span class="c"># Build artifacts</span>
dist/
build/
target/
node_modules/
coverage/

<span class="c"># Environment files (contain sensitive data)</span>
.env
.env.local
.env.production

<span class="c"># Development files</span>
.editorconfig
Dockerfile
README.md
<span class="k">*</span>.md
.vscode/
.idea/

<span class="c"># Logs and temporary files</span>
<span class="k">*</span>.log
tmp/
temp/
.cache/

<span class="c"># Operating system files</span>
.DS_Store
Thumbs.db
</code></pre></div></div>

<p><br /></p>

<h3 id="sample-application-files">Sample Application Files</h3>

<p>Create the necessary application files for your containerized nginx server.</p>

<h4 id="html-content">HTML Content</h4>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- files/index.html --&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Dockerized Nginx Application<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;style&gt;</span>
        <span class="nt">body</span> <span class="p">{</span>
            <span class="nl">font-family</span><span class="p">:</span> <span class="s2">'Segoe UI'</span><span class="p">,</span> <span class="n">Tahoma</span><span class="p">,</span> <span class="n">Geneva</span><span class="p">,</span> <span class="n">Verdana</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
            <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
            <span class="nl">background</span><span class="p">:</span> <span class="n">linear-gradient</span><span class="p">(</span><span class="m">135deg</span><span class="p">,</span> <span class="m">#667eea</span> <span class="m">0%</span><span class="p">,</span> <span class="m">#764ba2</span> <span class="m">100%</span><span class="p">);</span>
            <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
            <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
            <span class="nl">justify-content</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
            <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
            <span class="nl">min-height</span><span class="p">:</span> <span class="m">100vh</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.container</span> <span class="p">{</span>
            <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
            <span class="nl">background</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">0.1</span><span class="p">);</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">2rem</span><span class="p">;</span>
            <span class="nl">border-radius</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
            <span class="py">backdrop-filter</span><span class="p">:</span> <span class="n">blur</span><span class="p">(</span><span class="m">10px</span><span class="p">);</span>
            <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">8px</span> <span class="m">32px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nt">h1</span> <span class="p">{</span>
            <span class="nl">font-size</span><span class="p">:</span> <span class="m">3rem</span><span class="p">;</span>
            <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">1rem</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nt">h2</span> <span class="p">{</span>
            <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.5rem</span><span class="p">;</span>
            <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">1rem</span><span class="p">;</span>
            <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.9</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nt">p</span> <span class="p">{</span>
            <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.1rem</span><span class="p">;</span>
            <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.8</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nc">.docker-info</span> <span class="p">{</span>
            <span class="nl">margin-top</span><span class="p">:</span> <span class="m">2rem</span><span class="p">;</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">1rem</span><span class="p">;</span>
            <span class="nl">background</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">0.1</span><span class="p">);</span>
            <span class="nl">border-radius</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h1&gt;</span>üöÄ My Dockerized App<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;h2&gt;</span>Nginx Container Running Successfully<span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;p&gt;</span>This application is running inside a Docker container built with a custom Dockerfile.<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"docker-info"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p&gt;&lt;strong&gt;</span>üê≥ Container Technology:<span class="nt">&lt;/strong&gt;</span> Docker<span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;&lt;strong&gt;</span>üåê Web Server:<span class="nt">&lt;/strong&gt;</span> Nginx<span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;&lt;strong&gt;</span>üì¶ Base Image:<span class="nt">&lt;/strong&gt;</span> Ubuntu 20.04<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<h4 id="nginx-configuration">Nginx Configuration</h4>

<script src="https://gist.github.com/somaz94/be6f5d639c8d2799e1ddeada3426deed.js"></script>

<p><br /></p>

<h3 id="complete-dockerfile-example">Complete Dockerfile Example</h3>

<script src="https://gist.github.com/somaz94/3331837c814e2acb0a9cb8acfa445894.js"></script>

<p><br /></p>

<hr />

<h2 id="building-and-testing-docker-images">Building and Testing Docker Images</h2>

<p>Learn the complete workflow for building, testing, and validating your Docker images.</p>

<p><br /></p>

<h3 id="image-building-commands">Image Building Commands</h3>

<h4 id="basic-build-commands">Basic Build Commands</h4>

<script src="https://gist.github.com/somaz94/5d13664e575cacebc2806ebe5425972d.js"></script>

<p><br /></p>

<h3 id="image-verification-and-inspection">Image Verification and Inspection</h3>

<script src="https://gist.github.com/somaz94/0867af2cd82c4f3fddef2a223cb0a1c7.js"></script>

<p><br /></p>

<h3 id="container-testing-and-validation">Container Testing and Validation</h3>

<h4 id="basic-container-operations">Basic Container Operations</h4>

<script src="https://gist.github.com/somaz94/416dbc1f7a13198633d747470c8ea269.js"></script>

<p><br /></p>

<h4 id="container-monitoring-and-debugging">Container Monitoring and Debugging</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check container status</span>
docker ps
docker ps <span class="nt">-a</span>

<span class="c"># View container logs</span>
docker logs webserver
docker logs <span class="nt">-f</span> webserver  <span class="c"># Follow logs</span>

<span class="c"># Execute commands in running container</span>
docker <span class="nb">exec</span> <span class="nt">-it</span> webserver bash
docker <span class="nb">exec </span>webserver curl <span class="nt">-f</span> http://localhost/health

<span class="c"># Monitor resource usage</span>
docker stats webserver

<span class="c"># Inspect container configuration</span>
docker inspect webserver
</code></pre></div></div>

<h4 id="health-and-functionality-testing">Health and Functionality Testing</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Test HTTP response</span>
curl <span class="nt">-I</span> http://localhost:8080

<span class="c"># Comprehensive health check</span>
curl <span class="nt">-f</span> http://localhost:8080/health

<span class="c"># Load testing (using ab if available)</span>
ab <span class="nt">-n</span> 1000 <span class="nt">-c</span> 10 http://localhost:8080/

<span class="c"># Security scan</span>
docker <span class="nb">exec </span>webserver netstat <span class="nt">-tulpn</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="cleanup-and-maintenance">Cleanup and Maintenance</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Stop and remove container</span>
docker stop webserver
docker <span class="nb">rm </span>webserver

<span class="c"># Remove image</span>
docker rmi nginx:custom

<span class="c"># Clean up unused resources</span>
docker system prune <span class="nt">-f</span>

<span class="c"># Remove all unused images</span>
docker image prune <span class="nt">-a</span>

<span class="c"># Complete cleanup (careful!)</span>
docker system prune <span class="nt">-a</span> <span class="nt">--volumes</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="advanced-dockerfile-patterns">Advanced Dockerfile Patterns</h2>

<p>Explore sophisticated Dockerfile techniques for production-ready containers.</p>

<p><br /></p>

<h3 id="multi-stage-builds">Multi-Stage Builds</h3>

<p>Multi-stage builds enable you to create smaller, more secure production images by separating build dependencies from runtime requirements.</p>

<h4 id="nodejs-application-example">Node.js Application Example</h4>

<script src="https://gist.github.com/somaz94/34f2c9b28b723dc93e3ca36afdc761d2.js"></script>

<p><br /></p>

<h4 id="go-application-with-scratch-base">Go Application with Scratch Base</h4>

<script src="https://gist.github.com/somaz94/4c693aaf04ac13d45426e82b5db2847f.js"></script>

<p><br /></p>

<h3 id="arg-and-env-best-practices">ARG and ENV Best Practices</h3>

<h4 id="build-time-customization-with-arg">Build-time Customization with ARG</h4>

<script src="https://gist.github.com/somaz94/93cd47b8177282600150a971e2cc8cfd.js"></script>

<p><br /></p>

<h4 id="environment-variables-for-runtime-configuration">Environment Variables for Runtime Configuration</h4>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> node:18-alpine</span>

<span class="c"># Runtime environment variables</span>
<span class="k">ENV</span><span class="s"> NODE_ENV=production</span>
<span class="k">ENV</span><span class="s"> PORT=3000</span>
<span class="k">ENV</span><span class="s"> LOG_LEVEL=info</span>
<span class="k">ENV</span><span class="s"> REDIS_URL=redis://localhost:6379</span>
<span class="k">ENV</span><span class="s"> DATABASE_URL=postgresql://localhost:5432/myapp</span>

<span class="c"># Application-specific configuration</span>
<span class="k">ENV</span><span class="s"> APP_NAME="My Application"</span>
<span class="k">ENV</span><span class="s"> APP_DEBUG=false</span>
<span class="k">ENV</span><span class="s"> APP_TIMEOUT=30000</span>

<span class="c"># Health check configuration</span>
<span class="k">ENV</span><span class="s"> HEALTH_CHECK_INTERVAL=30s</span>
<span class="k">ENV</span><span class="s"> HEALTH_CHECK_TIMEOUT=3s</span>
<span class="k">ENV</span><span class="s"> HEALTH_CHECK_RETRIES=3</span>

<span class="c"># User can override these at runtime:</span>
<span class="c"># docker run -e NODE_ENV=development -e PORT=8080 myapp</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="security-hardening-techniques">Security Hardening Techniques</h3>

<h4 id="comprehensive-security-dockerfile">Comprehensive Security Dockerfile</h4>

<script src="https://gist.github.com/somaz94/5b121b95a33249e39435e1aee88a3dbe.js"></script>

<p><br /></p>

<h4 id="distroless-image-example">Distroless Image Example</h4>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Build stage</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">golang:1.21-alpine</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>

<span class="k">WORKDIR</span><span class="s"> /build</span>
<span class="k">COPY</span><span class="s"> . .</span>
<span class="k">RUN </span><span class="nv">CGO_ENABLED</span><span class="o">=</span>0 go build <span class="nt">-o</span> app .

<span class="c"># Production stage with distroless</span>
<span class="k">FROM</span><span class="s"> gcr.io/distroless/static:nonroot</span>

<span class="c"># Copy binary</span>
<span class="k">COPY</span><span class="s"> --from=builder /build/app /app</span>

<span class="c"># Use nonroot user (uid=65532)</span>
<span class="k">USER</span><span class="s"> 65532:65532</span>

<span class="k">EXPOSE</span><span class="s"> 8080</span>

<span class="k">ENTRYPOINT</span><span class="s"> ["/app"]</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="optimization-and-performance">Optimization and Performance</h2>

<p>Implement strategies to create efficient, fast-building Docker images.</p>

<p><br /></p>

<h3 id="layer-caching-optimization">Layer Caching Optimization</h3>

<h4 id="optimal-layer-ordering">Optimal Layer Ordering</h4>

<script src="https://gist.github.com/somaz94/ec86e657b203edb137cc451c9c68a4f6.js"></script>

<p><br /></p>

<h4 id="cache-mount-optimization">Cache Mount Optimization</h4>

<script src="https://gist.github.com/somaz94/bb566d88bff600da4939306cf426997a.js"></script>

<p><br /></p>

<h3 id="image-size-reduction">Image Size Reduction</h3>

<h4 id="alpine-based-optimization">Alpine-based Optimization</h4>

<script src="https://gist.github.com/somaz94/3332f58bb7c837a0e21230b315ef5b91.js"></script>

<p><br /></p>

<h4 id="minimal-python-image">Minimal Python Image</h4>

<script src="https://gist.github.com/somaz94/63bf84b5a8e6c1194713432587c95522.js"></script>

<p><br /></p>

<h3 id="build-performance-optimization">Build Performance Optimization</h3>

<h4 id="parallel-builds-with-buildkit">Parallel Builds with BuildKit</h4>

<script src="https://gist.github.com/somaz94/10b0266b6e8106895c8586a90511935d.js"></script>

<p><br /></p>

<h4 id="build-context-optimization">Build Context Optimization</h4>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use .dockerignore to exclude unnecessary files</span>
<span class="c"># Example .dockerignore:</span>
<span class="c"># node_modules</span>
<span class="c"># .git</span>
<span class="c"># *.md</span>
<span class="c"># tests/</span>
<span class="c"># coverage/</span>

<span class="k">FROM</span><span class="s"> node:18-alpine</span>

<span class="k">WORKDIR</span><span class="s"> /app</span>

<span class="c"># Copy only necessary files</span>
<span class="k">COPY</span><span class="s"> package*.json ./</span>
<span class="k">RUN </span>npm ci <span class="nt">--only</span><span class="o">=</span>production

<span class="c"># Copy source files (excluding what's in .dockerignore)</span>
<span class="k">COPY</span><span class="s"> src/ ./src/</span>
<span class="k">COPY</span><span class="s"> public/ ./public/</span>
<span class="k">COPY</span><span class="s"> config/ ./config/</span>

<span class="k">RUN </span>npm run build

<span class="k">EXPOSE</span><span class="s"> 3000</span>
<span class="k">CMD</span><span class="s"> ["npm", "start"]</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="security-best-practices">Security Best Practices</h2>

<p>Implement comprehensive security measures in your Dockerfiles.</p>

<p><br /></p>

<h3 id="user-security-and-permissions">User Security and Permissions</h3>

<h4 id="non-root-user-implementation">Non-Root User Implementation</h4>

<script src="https://gist.github.com/somaz94/7c154ef2f899f6b64b7a8d52b3682a38.js"></script>

<p><br /></p>

<h4 id="filesystem-security">Filesystem Security</h4>

<script src="https://gist.github.com/somaz94/c91f4128ce68d93ac5e44901ae3b4a01.js"></script>

<p><br /></p>

<h3 id="secret-management">Secret Management</h3>

<h4 id="build-time-secret-handling">Build-time Secret Handling</h4>

<script src="https://gist.github.com/somaz94/760e37837107b39bcc1174cc3fec9ce8.js"></script>

<p><br /></p>

<h4 id="runtime-secret-management">Runtime Secret Management</h4>

<script src="https://gist.github.com/somaz94/79bf33615f93526483b486371ac152da.js"></script>

<p><br /></p>

<h3 id="vulnerability-mitigation">Vulnerability Mitigation</h3>

<h4 id="package-security-updates">Package Security Updates</h4>

<script src="https://gist.github.com/somaz94/a85ddc341e518a41ef320dbb819f98ad.js"></script>

<p><br /></p>

<h4 id="security-scanning-integration">Security Scanning Integration</h4>

<script src="https://gist.github.com/somaz94/82918ace5529d09b9314c22bff6e5e7e.js"></script>

<p><br /></p>

<hr />

<h2 id="debugging-and-troubleshooting">Debugging and Troubleshooting</h2>

<p>Master techniques for diagnosing and resolving Dockerfile and container issues.</p>

<p><br /></p>

<h3 id="build-debugging-strategies">Build Debugging Strategies</h3>

<h4 id="incremental-build-testing">Incremental Build Testing</h4>

<script src="https://gist.github.com/somaz94/a186da0bb4045cd705773cd100f63724.js"></script>

<p><br /></p>

<h4 id="interactive-build-debugging">Interactive Build Debugging</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Build up to specific layer for debugging</span>
docker build <span class="nt">--target</span> dependencies <span class="nt">-t</span> debug:deps <span class="nb">.</span>

<span class="c"># Run interactive container to investigate</span>
docker run <span class="nt">-it</span> <span class="nt">--rm</span> debug:deps sh

<span class="c"># Inside container, debug the environment</span>
/ <span class="nv">$ </span><span class="nb">pwd</span>
/ <span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
/ <span class="nv">$ </span><span class="nb">env</span>
/ <span class="nv">$ </span>ps aux
/ <span class="nv">$ </span><span class="nb">df</span> <span class="nt">-h</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="runtime-debugging">Runtime Debugging</h3>

<h4 id="debug-enabled-dockerfile">Debug-enabled Dockerfile</h4>

<script src="https://gist.github.com/somaz94/34a624f34478cbaf5007bc920ceb0039.js"></script>

<p><br /></p>

<h4 id="container-inspection-commands">Container Inspection Commands</h4>

<script src="https://gist.github.com/somaz94/3c2d3be6b28b116a4ec33d2521a82f31.js"></script>

<p><br /></p>

<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>

<h4 id="build-context-problems">Build Context Problems</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Problem: Large build context</span>
<span class="c"># Solution: Optimize .dockerignore</span>
<span class="nb">echo</span> <span class="s2">"node_modules
.git
*.log
dist
coverage"</span> <span class="o">&gt;</span> .dockerignore

<span class="c"># Problem: Files not found during COPY</span>
<span class="c"># Solution: Verify build context</span>
docker build <span class="nt">--no-cache</span> <span class="nt">--progress</span><span class="o">=</span>plain <span class="nt">-t</span> <span class="nb">test</span> <span class="nb">.</span>

<span class="c"># Problem: Permission denied</span>
<span class="c"># Solution: Check file permissions</span>
<span class="nb">ls</span> <span class="nt">-la</span> Dockerfile
<span class="nb">chmod </span>644 Dockerfile
</code></pre></div></div>

<h4 id="layer-caching-issues">Layer Caching Issues</h4>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Problem: Dependencies reinstalled on every build</span>
<span class="c"># Solution: Copy package files first</span>

<span class="c"># ‚ùå Bad: Source changes invalidate dependency cache</span>
<span class="k">COPY</span><span class="s"> . .</span>
<span class="k">RUN </span>npm <span class="nb">install</span>

<span class="c"># ‚úÖ Good: Package files cached separately</span>
<span class="k">COPY</span><span class="s"> package*.json ./</span>
<span class="k">RUN </span>npm ci
<span class="k">COPY</span><span class="s"> . .</span>
</code></pre></div></div>

<h4 id="runtime-issues">Runtime Issues</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Problem: Container exits immediately</span>
<span class="c"># Solution: Check entrypoint and command</span>
docker run <span class="nt">--rm</span> myapp <span class="nb">echo</span> <span class="s2">"test"</span>
docker logs myapp

<span class="c"># Problem: Permission denied in container</span>
<span class="c"># Solution: Check user and file permissions</span>
docker <span class="nb">exec </span>myapp <span class="nb">ls</span> <span class="nt">-la</span> /app
docker <span class="nb">exec </span>myapp <span class="nb">id</span>

<span class="c"># Problem: Network connectivity issues</span>
<span class="c"># Solution: Debug networking</span>
docker <span class="nb">exec </span>myapp ping google.com
docker <span class="nb">exec </span>myapp netstat <span class="nt">-tlnp</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="best-practices-summary">Best Practices Summary</h2>

<div class="info-box info-box-success-not-check">
  <strong>Dockerfile Excellence Checklist</strong>
  <ul>
    <li>
      <strong>Security First</strong><br />
      - Always use non-root users in production<br />
      - Keep base images updated with security patches<br />
      - Use specific image tags, never 'latest' in production<br />
      - Implement proper secret management for sensitive data
    </li>
    <li>
      <strong>Optimization Strategies</strong><br />
      - Order layers by frequency of change (most stable first)<br />
      - Use multi-stage builds to minimize final image size<br />
      - Leverage BuildKit cache mounts for dependencies<br />
      - Combine RUN commands to reduce layer count
    </li>
    <li>
      <strong>Maintainability</strong><br />
      - Use semantic versioning for image tags<br />
      - Add comprehensive labels for metadata<br />
      - Implement health checks for container monitoring<br />
      - Document build arguments and environment variables
    </li>
    <li>
      <strong>Production Readiness</strong><br />
      - Use distroless or minimal base images<br />
      - Implement proper logging and monitoring<br />
      - Configure resource limits appropriately<br />
      - Plan for graceful shutdown and signal handling
    </li>
  </ul>
</div>

<p><br /></p>

<hr />

<h2 id="conclusion">Conclusion</h2>

<p><strong>Dockerfile mastery</strong> is fundamental to successful containerization strategies.</p>

<p>A well-crafted Dockerfile serves as the foundation for <strong>scalable, secure, and maintainable</strong> containerized applications.</p>

<p>Understanding instruction nuances, optimization techniques, and security best practices enables you to create <strong>production-ready images</strong> that perform efficiently across all environments.</p>

<p>The evolution from simple script automation to sophisticated <strong>multi-stage builds, security hardening, and performance optimization</strong> represents the maturity of containerization practices.</p>

<p>Modern Dockerfile development requires balancing <strong>image size, security, build speed, and runtime performance</strong>.</p>

<p><br /></p>

<h3 id="key-takeaways">Key Takeaways</h3>

<ol>
  <li><strong>Layer Awareness</strong>: Every instruction creates a layer; optimize for caching and size</li>
  <li><strong>Security by Design</strong>: Implement non-root users and minimal attack surfaces from the start</li>
  <li><strong>Multi-Stage Efficiency</strong>: Separate build and runtime concerns for optimal images</li>
  <li><strong>Documentation as Code</strong>: Use labels and comments to make Dockerfiles self-documenting</li>
  <li><strong>Continuous Improvement</strong>: Regularly update base images and dependencies for security</li>
</ol>

<p><br /></p>

<h3 id="future-considerations">Future Considerations</h3>

<p>As containerization continues evolving, stay current with <strong>BuildKit features, distroless images, and security scanning tools</strong>.</p>

<p>The principles learned in Dockerfile development directly apply to <strong>Kubernetes manifests, Helm charts, and other container orchestration platforms</strong>.</p>

<p><strong>Effective Dockerfile practices form the cornerstone of reliable DevOps pipelines and scalable microservice architectures.</strong></p>

<p>Master these fundamentals, and you‚Äôll build containers that stand the test of production workloads.</p>

<p><br /></p>

<hr />

<h2 id="references">References</h2>

<ul>
  <li><a href="https://docs.docker.com/engine/reference/builder/">Dockerfile Reference (Official Documentation)</a></li>
  <li><a href="https://docs.docker.com/develop/dev-best-practices/">Docker Build Best Practices</a></li>
  <li><a href="https://docs.docker.com/develop/dev-best-practices/#use-multi-stage-builds">Multi-stage Build Documentation</a></li>
  <li><a href="https://docs.docker.com/engine/security/">Docker Security Best Practices</a></li>
  <li><a href="https://docs.docker.com/buildx/working-with-buildx/">BuildKit Documentation</a></li>
  <li><a href="https://github.com/GoogleContainerTools/distroless">Distroless Images</a></li>
  <li><a href="https://github.com/hadolint/hadolint">Hadolint - Dockerfile Linter</a></li>
  <li><a href="https://docs.docker.com/engine/scan/">Docker Image Security Scanning</a></li>
  <li><a href="https://semver.org/">Semantic Versioning Guide</a></li>
  <li><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf">Container Security Guide (NIST)</a></li>
  <li><a href="https://alpinelinux.org/about/">Alpine Linux Security</a></li>
  <li><a href="https://www.redhat.com/en/topics/security/container-security">Red Hat Container Security</a></li>
  <li><a href="https://owasp.org/www-project-docker-top-10/">OWASP Container Security</a></li>
  <li><a href="https://hub.docker.com/search?q=&amp;type=image&amp;image_filter=official">Docker Hub Official Images</a></li>
  <li><a href="https://github.com/sigstore/cosign">Container Image Signing with Cosign</a></li>
</ul>


                <!-- Pagination links -->


            </article>

            
                <aside class="see-also">
                    <h2>See also</h2>
                    <ul>
                        
                        
                        
                            <li>
                                <a href="/category/aws/aws-vpc-peering-transit-gateway/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1767769488/aws-network-1_y4kc1r.png">
                                    
                                    <h3>AWS Network Connection Methods Complete Comparison - VPC Peering vs Transit Gateway vs VPN</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/ai/llm-ollama-open-webui/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1770607787/ollama-openwebui-llm-1_dl6rlu.png">
                                    
                                    <h3>Building an On-Premises LLM System with Ollama + Open WebUI</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/container/docker-image-optimization/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1767693107/docker-image-opt-1_bfyljd.png">
                                    
                                    <h3>Docker Image Optimization Practical Guide</h3>
                                </a>
                            </li>
                        
                    </ul>
                </aside>
            

        </section>

        <!-- Add time bar only for pages without pagination -->
        
            <div class="time-bar" data-minutes="15">
    <span class="time-completed"></span>
    <span class="time-remaining"></span>
    <div class="bar">
        <span class="completed" style="width:0%;"></span>
        <span class="remaining" style="width:100%;"></span>
    </div>
</div>

            <button class="toggle-preview" onclick="togglePreview()">
    <span>Hide Preview ‚ñº</span>
</button>

<div id="recommendationSection" class="recommendation">
    <div class="message">
        <strong>Why don't you read something next?</strong>
        <div>
            <button>
                <svg><use xlink:href="#icon-arrow-right"></use></svg>
                <span>Go back to top</span>
            </button>
        </div>
    </div>
    <div id="previewSection" class="preview-section">
        
        <a href="/category/cs/tls-https/" class="post-preview">
            <div class="image">
                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1767770122/tls-handshake-1_nwd3f0.png">
                
            </div>
            <h3 class="title">TLS Handshake and Certificate Architecture - A Deep Dive into HTTPS Security</h3>
        </a>
    </div>
</div>

<style>
.toggle-preview {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #333;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.toggle-preview:hover {
    background: #444;
}

.toggle-preview.visible {
    opacity: 1;
}

.recommendation {
    margin-top: 1000px;
    display: block;
    transition: all 0.3s ease;
}

.recommendation.hidden {
    display: none;
}

.hide-preview {
    margin-left: 10px;
    background: none;
    border: 1px solid #666;
    color: #666;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}

.hide-preview:hover {
    background: #f0f0f0;
}

.preview-section {
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.preview-section.hidden {
    max-height: 0;
}
</style>

<script>
function togglePreview() {
    const recommendation = document.getElementById('recommendationSection');
    const button = document.querySelector('.toggle-preview span');
    
    if (recommendation.classList.contains('hidden')) {
        recommendation.classList.remove('hidden');
        button.textContent = 'Hide Preview ‚ñº';
    } else {
        recommendation.classList.add('hidden');
        button.textContent = 'Show Preview ‚ñ≤';
    }
}

window.addEventListener('scroll', function() {
    const toggleButton = document.querySelector('.toggle-preview');
    const recommendation = document.getElementById('recommendationSection');
    const rect = recommendation.getBoundingClientRect();
    
    if (rect.top <= window.innerHeight) {
        toggleButton.classList.add('visible');
    } else {
        toggleButton.classList.remove('visible');
    }
});
</script>

        

        <!-- Show modal if the post is the last one -->
        

        <!-- Show modal before user leaves the page -->
        

        <!-- Add your newsletter subscription form here -->

        <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;Comprehensive guide to Dockerfile creation, instructions, best practices, and security configurations for building efficient Docker images&quot;%20https://somaz.blog/category/container/dockerfile/%20via%20&#64;twitter_username&hashtags=dockerfile,docker,container-images,automation,devops,image-optimization,security,best-practices,multi-stage-builds"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://somaz.blog/category/container/dockerfile/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
</section>

        

  <section class="author">
    <div class="details">
      
        <img class="img-rounded" src="/assets/img/uploads/profile.png" alt="Somaz">
      
      <p class="def">Author</p>
      <h3 class="name">
        <a href="/authors/somaz/">Somaz</a>
      </h3>
      <p class="desc">DevOps engineer focused on cloud infrastructure and automation</p>
      <p>
        
          <a href="https://github.com/somaz94" title="Github">
            <svg><use xlink:href="#icon-github"></use></svg>
          </a>
        
        
        
        
        
        
          <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
            <svg><use xlink:href="#icon-linkedin"></use></svg>
          </a>
        
        
          <a href="https://somaz.tistory.com" title="Tistory">
            <svg><use xlink:href="#icon-tistory"></use></svg>
          </a>
        
      </p>
    </div>
  </section>

  
  
  
  
  
  
  
  

  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Somaz",
      
      "image": "/assets/img/uploads/profile.png",
      
      "jobTitle": "DevOps Engineer",
      "url": "https://somaz.blog/authors/somaz/",
      "sameAs": [
        "https://github.com/somaz94","https://www.linkedin.com/in/somaz","https://{{ author.tistory_username }}.tistory.com"
      ]
  }
  </script>


        

<section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = 'https-somaz94-github-io';
        var disqus_title = '';
        var disqus_url = '/category/container/dockerfile/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>



        <footer>
    <p>
      
        <a href="https://github.com/somaz94" title="Github">
          <svg><use xlink:href="#icon-github"></use></svg>
        </a>
      
      
        <a href="https://www.facebook.com/facebook_username" title="Facebook">
          <svg><use xlink:href="#icon-facebook"></use></svg>
        </a>
      
      
        <a href="https://twitter.com/twitter_username" title="Twitter">
          <svg><use xlink:href="#icon-twitter"></use></svg>
        </a>
      
      
        <a href="https://medium.com/@medium_username" title="Medium">
          <svg><use xlink:href="#icon-medium"></use></svg>
        </a>
      
      
        <a href="https://www.instagram.com/instagram_username" title="Instagram">
          <svg><use xlink:href="#icon-instagram"></use></svg>
        </a>
      
      
        <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
          <svg><use xlink:href="#icon-linkedin"></use></svg>
        </a>
      
      
        <a href="https://somaz.tistory.com" title="Tistory">
          <svg><use xlink:href="#icon-tistory"></use></svg>
        </a>
      
    </p>

    <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>


    <p>
      <a href="https://somaz.blog/sitemap.xml" title="sitemap">Sitemap</a> |
      <a href="https://somaz.blog/privacy-policy" title="Privacy Policy">Privacy Policy</a>
    </p>

    <p>
      <span>Somaz Tech Blog</span> <svg class="love"><use xlink:href="#icon-heart"></use></svg>
    </p>
</footer>










<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "somaz",
  "description": "DevOps engineer's tech blog.",
  "url": "https://somaz.blog/",
  "logo": {
      "@type": "ImageObject",
      "url": "https://somaz.blog/assets/img/icons/mediumtile.png",
      "width": "600",
      "height": "315"
  },
  "sameAs": [
    "https://github.com/somaz94","https://www.facebook.com/facebook_username","https://twitter.com/twitter_username","https://medium.com/@medium_username","https://www.instagram.com/instagram_username","https://www.linkedin.com/in/somaz","https://{{ site.tistory_username }}.tistory.com"
  ]
}
</script>

<!-- Include the script that allows Netlify CMS login -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<!-- Include the website scripts -->
<script src="/assets/js/scripts.min.js"></script>

<!-- Include Google Analytics script -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
<script>
  var host = window.location.hostname;
  if (host != 'localhost') {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXX-X');
  }
</script>
  


<!-- Include extra scripts -->



        

        
        
        
        
        
        
        
        
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "name": "Dockerfile - Complete Guide to Container Image Creation and Best Practices",
            "headline": "Master containerized application development with Dockerfile automation and optimization",
            "description": "Comprehensive guide to Dockerfile creation, instructions, best practices, and security configurations for building efficient Docker images",
            "image": "https://res.cloudinary.com/dkcm26aem/image/upload/v1755656803/dockerfile-1_xe6akt.png",
            "url": "https://somaz.blog/category/container/dockerfile/",
            "articleBody": "



Overview

Dockerfile is a script containing a series of instructions that Docker uses to automatically build container images.

It serves as a blueprint for creating consistent, reproducible environments that can run anywhere Docker is installed.

By defining your application‚Äôs dependencies, configuration, and runtime environment in a single text file, Dockerfile enables Infrastructure as Code for containerized applications.

Dockerfile transforms the complex process of container creation into automated, version-controlled, and reproducible workflows.

It ensures that your application runs consistently across development, testing, and production environments, eliminating the ‚Äúit works on my machine‚Äù problem.



Key Benefits of Dockerfile


  Why Use Dockerfile?
  
    Automation: Eliminates manual container setup and configuration
    Reproducibility: Ensures consistent environments across all deployment stages
    Version Control: Track changes to your infrastructure alongside your code
    Portability: Run identical containers on any Docker-compatible system
    Efficiency: Leverage layer caching for faster builds and smaller images
    Documentation: Self-documenting infrastructure requirements
  






Dockerfile Architecture and Workflow

Understanding how Dockerfile integrates with the Docker ecosystem is crucial for effective container development.



Container Build Workflow


  
    graph TD
        A[Dockerfile] --&amp;gt; B[docker build]
        B --&amp;gt; C[Docker Image]
        C --&amp;gt; D[Container Registry]
        C --&amp;gt; E[docker run]
        E --&amp;gt; F[Running Container]
        
        G[Application Code] --&amp;gt; A
        H[Dependencies] --&amp;gt; A
        I[Configuration] --&amp;gt; A
        
        style A fill:#f9f,stroke:#333,stroke-width:2px
        style C fill:#bbf,stroke:#333,stroke-width:2px
        style F fill:#bfb,stroke:#333,stroke-width:2px
  




Layer-Based Architecture

Dockerfile creates images using a layered filesystem where each instruction creates a new layer. This architecture enables:


  Efficient Storage: Shared layers reduce disk usage
  Fast Builds: Unchanged layers are cached and reused
  Incremental Updates: Only modified layers need rebuilding
  Network Efficiency: Layer-based image distribution






Dockerfile Instructions Reference

Master the essential Dockerfile instructions for building robust container images.



Core Instructions Overview


  
    
      Instruction
      Description
    
    
      FROM
      Specifies the base image from Docker Hub, GCR, Quay, ECR, or other registries
    
    
      RUN
      Executes commands during build time (package installation, compilation)
    
    
      COPY
      Copies files and directories from build context to container filesystem
    
    
      ADD
      Advanced file copying with URL download and archive extraction capabilities
    
    
      WORKDIR
      Sets the working directory for subsequent instructions
    
    
      ENV
      Sets environment variables available during build and runtime
    
    
      ARG
      Defines build-time variables that can be passed during image building
    
    
      EXPOSE
      Documents which ports the container will listen on at runtime
    
    
      VOLUME
      Creates mount points for external volumes or bind mounts
    
    
      USER
      Specifies the user context for running containers (security best practice)
    
    
      LABEL
      Adds metadata to images using key-value pairs
    
    
      CMD
      Provides default command to execute when container starts (overridable)
    
    
      ENTRYPOINT
      Configures container to run as executable with fixed entry command
    
  




Critical Instruction Differences: RUN vs CMD vs ENTRYPOINT

Understanding when to use each execution instruction is fundamental to Dockerfile mastery.

RUN Instruction


  Purpose: Execute commands during image build process
  Timing: Build-time only
  Use Cases: Package installation, compilation, configuration setup






CMD Instruction


  Purpose: Define default command executed when container starts
  Timing: Runtime
  Behavior: Overridable by docker run arguments


# Shell format
CMD nginx -g &quot;daemon off;&quot;

# Exec format (recommended)
CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]

# As default parameters to ENTRYPOINT
ENTRYPOINT [&quot;python3&quot;]
CMD [&quot;app.py&quot;]  # Default argument


ENTRYPOINT Instruction


  Purpose: Configure container as executable with fixed entry point
  Timing: Runtime
  Behavior: Cannot be overridden, arguments are appended


# Basic ENTRYPOINT
ENTRYPOINT [&quot;python3&quot;, &quot;app.py&quot;]

# ENTRYPOINT with CMD for flexible defaults
ENTRYPOINT [&quot;python3&quot;, &quot;app.py&quot;]
CMD [&quot;--port&quot;, &quot;8080&quot;]

# Usage examples:
# docker run myapp                    -&amp;gt; python3 app.py --port 8080
# docker run myapp --port 3000       -&amp;gt; python3 app.py --port 3000
# docker run myapp --debug           -&amp;gt; python3 app.py --debug






Basic Dockerfile Creation

Learn to create your first Dockerfile with a practical nginx web server example.



Project Structure Setup

Create a well-organized directory structure for your Docker project:

# Create project directory
mkdir nginx-image &amp;amp;&amp;amp; cd nginx-image

# Create subdirectories
mkdir files
mkdir config
mkdir scripts

# Create essential files
touch Dockerfile
touch .dockerignore
touch README.md


.dockerignore Configuration

The .dockerignore file prevents unnecessary files from being sent to the Docker daemon, reducing build context size and improving security.

# Version control
.git
.gitignore
.dockerignore

# Build artifacts
dist/
build/
target/
node_modules/
coverage/

# Environment files (contain sensitive data)
.env
.env.local
.env.production

# Development files
.editorconfig
Dockerfile
README.md
*.md
.vscode/
.idea/

# Logs and temporary files
*.log
tmp/
temp/
.cache/

# Operating system files
.DS_Store
Thumbs.db




Sample Application Files

Create the necessary application files for your containerized nginx server.

HTML Content

&amp;lt;!-- files/index.html --&amp;gt;
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&quot;UTF-8&quot;&amp;gt;
    &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&amp;gt;
    &amp;lt;title&amp;gt;Dockerized Nginx Application&amp;lt;/title&amp;gt;
    &amp;lt;style&amp;gt;
        body {
            font-family: &apos;Segoe UI&apos;, Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }
        p {
            font-size: 1.1rem;
            opacity: 0.8;
        }
        .docker-info {
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
    &amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;div class=&quot;container&quot;&amp;gt;
        &amp;lt;h1&amp;gt;üöÄ My Dockerized App&amp;lt;/h1&amp;gt;
        &amp;lt;h2&amp;gt;Nginx Container Running Successfully&amp;lt;/h2&amp;gt;
        &amp;lt;p&amp;gt;This application is running inside a Docker container built with a custom Dockerfile.&amp;lt;/p&amp;gt;
        &amp;lt;div class=&quot;docker-info&quot;&amp;gt;
            &amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;üê≥ Container Technology:&amp;lt;/strong&amp;gt; Docker&amp;lt;/p&amp;gt;
            &amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;üåê Web Server:&amp;lt;/strong&amp;gt; Nginx&amp;lt;/p&amp;gt;
            &amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;üì¶ Base Image:&amp;lt;/strong&amp;gt; Ubuntu 20.04&amp;lt;/p&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;


Nginx Configuration





Complete Dockerfile Example







Building and Testing Docker Images

Learn the complete workflow for building, testing, and validating your Docker images.



Image Building Commands

Basic Build Commands





Image Verification and Inspection





Container Testing and Validation

Basic Container Operations





Container Monitoring and Debugging

# Check container status
docker ps
docker ps -a

# View container logs
docker logs webserver
docker logs -f webserver  # Follow logs

# Execute commands in running container
docker exec -it webserver bash
docker exec webserver curl -f http://localhost/health

# Monitor resource usage
docker stats webserver

# Inspect container configuration
docker inspect webserver


Health and Functionality Testing

# Test HTTP response
curl -I http://localhost:8080

# Comprehensive health check
curl -f http://localhost:8080/health

# Load testing (using ab if available)
ab -n 1000 -c 10 http://localhost:8080/

# Security scan
docker exec webserver netstat -tulpn




Cleanup and Maintenance

# Stop and remove container
docker stop webserver
docker rm webserver

# Remove image
docker rmi nginx:custom

# Clean up unused resources
docker system prune -f

# Remove all unused images
docker image prune -a

# Complete cleanup (careful!)
docker system prune -a --volumes






Advanced Dockerfile Patterns

Explore sophisticated Dockerfile techniques for production-ready containers.



Multi-Stage Builds

Multi-stage builds enable you to create smaller, more secure production images by separating build dependencies from runtime requirements.

Node.js Application Example





Go Application with Scratch Base





ARG and ENV Best Practices

Build-time Customization with ARG





Environment Variables for Runtime Configuration

FROM node:18-alpine

# Runtime environment variables
ENV NODE_ENV=production
ENV PORT=3000
ENV LOG_LEVEL=info
ENV REDIS_URL=redis://localhost:6379
ENV DATABASE_URL=postgresql://localhost:5432/myapp

# Application-specific configuration
ENV APP_NAME=&quot;My Application&quot;
ENV APP_DEBUG=false
ENV APP_TIMEOUT=30000

# Health check configuration
ENV HEALTH_CHECK_INTERVAL=30s
ENV HEALTH_CHECK_TIMEOUT=3s
ENV HEALTH_CHECK_RETRIES=3

# User can override these at runtime:
# docker run -e NODE_ENV=development -e PORT=8080 myapp




Security Hardening Techniques

Comprehensive Security Dockerfile





Distroless Image Example

# Build stage
FROM golang:1.21-alpine AS builder

WORKDIR /build
COPY . .
RUN CGO_ENABLED=0 go build -o app .

# Production stage with distroless
FROM gcr.io/distroless/static:nonroot

# Copy binary
COPY --from=builder /build/app /app

# Use nonroot user (uid=65532)
USER 65532:65532

EXPOSE 8080

ENTRYPOINT [&quot;/app&quot;]






Optimization and Performance

Implement strategies to create efficient, fast-building Docker images.



Layer Caching Optimization

Optimal Layer Ordering





Cache Mount Optimization





Image Size Reduction

Alpine-based Optimization





Minimal Python Image





Build Performance Optimization

Parallel Builds with BuildKit





Build Context Optimization

# Use .dockerignore to exclude unnecessary files
# Example .dockerignore:
# node_modules
# .git
# *.md
# tests/
# coverage/

FROM node:18-alpine

WORKDIR /app

# Copy only necessary files
COPY package*.json ./
RUN npm ci --only=production

# Copy source files (excluding what&apos;s in .dockerignore)
COPY src/ ./src/
COPY public/ ./public/
COPY config/ ./config/

RUN npm run build

EXPOSE 3000
CMD [&quot;npm&quot;, &quot;start&quot;]






Security Best Practices

Implement comprehensive security measures in your Dockerfiles.



User Security and Permissions

Non-Root User Implementation





Filesystem Security





Secret Management

Build-time Secret Handling





Runtime Secret Management





Vulnerability Mitigation

Package Security Updates





Security Scanning Integration







Debugging and Troubleshooting

Master techniques for diagnosing and resolving Dockerfile and container issues.



Build Debugging Strategies

Incremental Build Testing





Interactive Build Debugging

# Build up to specific layer for debugging
docker build --target dependencies -t debug:deps .

# Run interactive container to investigate
docker run -it --rm debug:deps sh

# Inside container, debug the environment
/ $ pwd
/ $ ls -la
/ $ env
/ $ ps aux
/ $ df -h




Runtime Debugging

Debug-enabled Dockerfile





Container Inspection Commands





Common Issues and Solutions

Build Context Problems

# Problem: Large build context
# Solution: Optimize .dockerignore
echo &quot;node_modules
.git
*.log
dist
coverage&quot; &amp;gt; .dockerignore

# Problem: Files not found during COPY
# Solution: Verify build context
docker build --no-cache --progress=plain -t test .

# Problem: Permission denied
# Solution: Check file permissions
ls -la Dockerfile
chmod 644 Dockerfile


Layer Caching Issues

# Problem: Dependencies reinstalled on every build
# Solution: Copy package files first

# ‚ùå Bad: Source changes invalidate dependency cache
COPY . .
RUN npm install

# ‚úÖ Good: Package files cached separately
COPY package*.json ./
RUN npm ci
COPY . .


Runtime Issues

# Problem: Container exits immediately
# Solution: Check entrypoint and command
docker run --rm myapp echo &quot;test&quot;
docker logs myapp

# Problem: Permission denied in container
# Solution: Check user and file permissions
docker exec myapp ls -la /app
docker exec myapp id

# Problem: Network connectivity issues
# Solution: Debug networking
docker exec myapp ping google.com
docker exec myapp netstat -tlnp






Best Practices Summary


  Dockerfile Excellence Checklist
  
    
      Security First
      - Always use non-root users in production
      - Keep base images updated with security patches
      - Use specific image tags, never &apos;latest&apos; in production
      - Implement proper secret management for sensitive data
    
    
      Optimization Strategies
      - Order layers by frequency of change (most stable first)
      - Use multi-stage builds to minimize final image size
      - Leverage BuildKit cache mounts for dependencies
      - Combine RUN commands to reduce layer count
    
    
      Maintainability
      - Use semantic versioning for image tags
      - Add comprehensive labels for metadata
      - Implement health checks for container monitoring
      - Document build arguments and environment variables
    
    
      Production Readiness
      - Use distroless or minimal base images
      - Implement proper logging and monitoring
      - Configure resource limits appropriately
      - Plan for graceful shutdown and signal handling
    
  






Conclusion

Dockerfile mastery is fundamental to successful containerization strategies.

A well-crafted Dockerfile serves as the foundation for scalable, secure, and maintainable containerized applications.

Understanding instruction nuances, optimization techniques, and security best practices enables you to create production-ready images that perform efficiently across all environments.

The evolution from simple script automation to sophisticated multi-stage builds, security hardening, and performance optimization represents the maturity of containerization practices.

Modern Dockerfile development requires balancing image size, security, build speed, and runtime performance.



Key Takeaways


  Layer Awareness: Every instruction creates a layer; optimize for caching and size
  Security by Design: Implement non-root users and minimal attack surfaces from the start
  Multi-Stage Efficiency: Separate build and runtime concerns for optimal images
  Documentation as Code: Use labels and comments to make Dockerfiles self-documenting
  Continuous Improvement: Regularly update base images and dependencies for security




Future Considerations

As containerization continues evolving, stay current with BuildKit features, distroless images, and security scanning tools.

The principles learned in Dockerfile development directly apply to Kubernetes manifests, Helm charts, and other container orchestration platforms.

Effective Dockerfile practices form the cornerstone of reliable DevOps pipelines and scalable microservice architectures.

Master these fundamentals, and you‚Äôll build containers that stand the test of production workloads.





References


  Dockerfile Reference (Official Documentation)
  Docker Build Best Practices
  Multi-stage Build Documentation
  Docker Security Best Practices
  BuildKit Documentation
  Distroless Images
  Hadolint - Dockerfile Linter
  Docker Image Security Scanning
  Semantic Versioning Guide
  Container Security Guide (NIST)
  Alpine Linux Security
  Red Hat Container Security
  OWASP Container Security
  Docker Hub Official Images
  Container Image Signing with Cosign

",
            "wordcount": "2846",
            "inLanguage": "en",
            "dateCreated": "2026-01-20/",
            "datePublished": "2026-01-20/",
            "dateModified": "2026-01-20/",
            "author": {
                "@type": "Person",
                "name": "Somaz",
                
                "image": "/assets/img/uploads/profile.png",
                
                "jobTitle": "DevOps Engineer",
                "url": "https://somaz.blog/authors/somaz/",
                "sameAs": [
                    "https://github.com/somaz94","https://www.linkedin.com/in/somaz"
                ]
            },
            "publisher": {
                "@type": "Organization",
                "name": "somaz",
                "url": "https://somaz.blog/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://somaz.blog/assets/img/blog-image.png",
                    "width": "600",
                    "height": "315"
                }
            },
            "mainEntityOfPage": "True",
            "genre": "CONTAINER",
            "articleSection": "CONTAINER",
            "keywords": ["dockerfile","docker","container-images","automation","devops","image-optimization","security","best-practices","multi-stage-builds"]
        }
        </script>
    </body>
</html>
