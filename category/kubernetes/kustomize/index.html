<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    
    

    
    

    
    

    <!-- ✅ Google Tag Manager 추가 -->
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MBP83N4Q');
    </script>
      <!-- ✅ End Google Tag Manager -->

    <!-- Mermaid.js 직접 로드 -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>

    <title>What is Kustomize? A Configuration Management Tool for Kubernetes | somaz</title>
    <meta name="description" content="Learn about Kustomize, its features, and how to manage Kubernetes manifests effectively">
    
        <meta name="keywords" content="kubernetes, kustomize, devops, configuration, gitops">
    

    <!-- Social: Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="What is Kustomize? A Configuration Management Tool for Kubernetes | somaz">
    <meta name="twitter:description" content="Learn about Kustomize, its features, and how to manage Kubernetes manifests effectively">

    
        <meta property="twitter:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1739947439/kustomize_luhcoo.png">
    
    
    
        <meta name="twitter:site" content="@twitter_username">
    

    <!-- Social: Facebook / Open Graph -->
    <meta property="og:url" content="https://somaz.blog/category/kubernetes/kustomize/">
    <meta property="og:title" content="What is Kustomize? A Configuration Management Tool for Kubernetes | somaz">
    <meta property="og:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1739947439/kustomize_luhcoo.png">
    <meta property="og:description" content="Learn about Kustomize, its features, and how to manage Kubernetes manifests effectively">
    <meta property="og:site_name" content="Somaz Tech Blog">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/img/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png" />

    <!-- Windows 8 Tile Icons -->
    <meta name="application-name" content="somaz">
    <meta name="msapplication-TileColor" content="#141414">
    <meta name="msapplication-square70x70logo" content="smalltile.png" />
    <meta name="msapplication-square150x150logo" content="mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="widetile.png" />
    <meta name="msapplication-square310x310logo" content="largetile.png" />
    
    <!-- Android Lolipop Theme Color -->
    <meta name="theme-color" content="#141414">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="canonical" href="https://somaz.blog/category/kubernetes/kustomize/">
    <link rel="alternate" type="application/rss+xml" title="Somaz Tech Blog" href="https://somaz.blog/feed.xml" />

    <!-- Include extra styles -->
    

    <!-- JavaScript enabled/disabled -->
    <script>
        document.querySelector('html').classList.remove('no-js');
    </script>

    <!-- Google Adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8725590811736154"
        crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"> -->
    <!-- <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/variable/woff2/SUIT-Variable.css" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;700&display=swap" rel="stylesheet"> -->

    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />

</head>
<!-- ✅ Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBP83N4Q"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- ✅ End Google Tag Manager (noscript) -->
    <body class="has-push-menu">
        





        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-close" viewBox="0 0 1000 1000"><path d="M969.8,870.3c27,27.7,27,71.8,0,99.1C955.7,983,937.9,990,920,990c-17.9,0-35.7-7-49.7-20.7L500,599L129.6,969.4C115.6,983,97.8,990,79.9,990s-35.7-7-49.7-20.7c-27-27.3-27-71.4,0-99.1L400.9,500L30.3,129.3c-27-27.3-27-71.4,0-99.1c27.3-27,71.8-27,99.4,0L500,400.9L870.4,30.2c27.7-27,71.8-27,99.4,0c27,27.7,27,71.8,0,99.1L599.1,500L969.8,870.3z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-clock" viewBox="0 0 1000 1000"><path d="M500,10C229.8,10,10,229.8,10,500c0,270.2,219.8,490,490,490c270.2,0,490-219.8,490-490C990,229.8,770.2,10,500,10z M500,910.2c-226.2,0-410.2-184-410.2-410.2c0-226.2,184-410.2,410.2-410.2c226.2,0,410.2,184,410.2,410.2C910.2,726.1,726.2,910.2,500,910.2z M753.1,374c8.2,11.9,5.2,28.1-6.6,36.3L509.9,573.7c-4.4,3.1-9.6,4.6-14.8,4.6c-4.1,0-8.3-1-12.1-3c-8.6-4.5-14-13.4-14-23.1V202.5c0-14.4,11.7-26.1,26.1-26.1c14.4,0,26.1,11.7,26.1,26.1v300l195.6-135.1C728.7,359.2,744.9,362.1,753.1,374z"/></symbol><symbol id="icon-calendar" viewBox="0 0 1000 1000"><path d="M920,500v420H80V500H920 M990,430H10v490c0,38.7,31.3,70,70,70h840c38.7,0,70-31.3,70-70V430L990,430z"/><path d="M850,80v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80H360v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80C72.8,80,10,142.7,10,220v140h980V220C990,142.7,927.2,80,850,80z"/><path d="M255,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C290,25.8,274.3,10,255,10z"/><path d="M745,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C780,25.8,764.3,10,745,10z"/></symbol><symbol id="icon-github" viewBox="0 0 12 14"><path d="M6 1q1.633 0 3.012 0.805t2.184 2.184 0.805 3.012q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.312-0.055t-0.102-0.234q0-0.023 0.004-0.598t0.004-1.051q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.93-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.664-0.105q-0.352 0.883-0.062 1.594-0.617 0.68-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.305 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.691t0.004 0.426q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805zM2.273 9.617q0.023-0.055-0.055-0.094-0.078-0.023-0.102 0.016-0.023 0.055 0.055 0.094 0.070 0.047 0.102-0.016zM2.516 9.883q0.055-0.039-0.016-0.125-0.078-0.070-0.125-0.023-0.055 0.039 0.016 0.125 0.078 0.078 0.125 0.023zM2.75 10.234q0.070-0.055 0-0.148-0.062-0.102-0.133-0.047-0.070 0.039 0 0.141t0.133 0.055zM3.078 10.562q0.062-0.062-0.031-0.148-0.094-0.094-0.156-0.023-0.070 0.062 0.031 0.148 0.094 0.094 0.156 0.023zM3.523 10.758q0.023-0.086-0.102-0.125-0.117-0.031-0.148 0.055t0.102 0.117q0.117 0.047 0.148-0.047zM4.016 10.797q0-0.102-0.133-0.086-0.125 0-0.125 0.086 0 0.102 0.133 0.086 0.125 0 0.125-0.086zM4.469 10.719q-0.016-0.086-0.141-0.070-0.125 0.023-0.109 0.117t0.141 0.062 0.109-0.109z"></path></symbol><symbol id="icon-medium" viewBox="0 0 1000 1000"><path d="M336.5,240.2v641.5c0,9.1-2.3,16.9-6.8,23.2s-11.2,9.6-20,9.6c-6.2,0-12.2-1.5-18-4.4L37.3,782.7c-7.7-3.6-14.1-9.8-19.4-18.3S10,747.4,10,739V115.5c0-7.3,1.8-13.5,5.5-18.6c3.6-5.1,8.9-7.7,15.9-7.7c5.1,0,13.1,2.7,24.1,8.2l279.5,140C335.9,238.6,336.5,239.5,336.5,240.2L336.5,240.2z M371.5,295.5l292,473.6l-292-145.5V295.5z M990,305.3v576.4c0,9.1-2.6,16.5-7.7,22.1c-5.1,5.7-12,8.5-20.8,8.5s-17.3-2.4-25.7-7.1L694.7,784.9L990,305.3z M988.4,239.7c0,1.1-46.8,77.6-140.3,229.4C754.6,621,699.8,709.8,683.8,735.7L470.5,389l177.2-288.2c6.2-10.2,15.7-15.3,28.4-15.3c5.1,0,9.8,1.1,14.2,3.3l295.9,147.7C987.6,237.1,988.4,238.2,988.4,239.7L988.4,239.7z"/></symbol><symbol id="icon-instagram" viewBox="0 0 489.84 489.84"><path d="M249.62,50.46c65.4,0,73.14.25,99,1.43C372.47,53,385.44,57,394.07,60.32a75.88,75.88,0,0,1,28.16,18.32,75.88,75.88,0,0,1,18.32,28.16c3.35,8.63,7.34,21.6,8.43,45.48,1.18,25.83,1.43,33.57,1.43,99s-0.25,73.14-1.43,99c-1.09,23.88-5.08,36.85-8.43,45.48a81.11,81.11,0,0,1-46.48,46.48c-8.63,3.35-21.6,7.34-45.48,8.43-25.82,1.18-33.57,1.43-99,1.43s-73.15-.25-99-1.43c-23.88-1.09-36.85-5.08-45.48-8.43A75.88,75.88,0,0,1,77,423.86,75.88,75.88,0,0,1,58.69,395.7c-3.35-8.63-7.34-21.6-8.43-45.48-1.18-25.83-1.43-33.57-1.43-99s0.25-73.14,1.43-99c1.09-23.88,5.08-36.85,8.43-45.48A75.88,75.88,0,0,1,77,78.64a75.88,75.88,0,0,1,28.16-18.32c8.63-3.35,21.6-7.34,45.48-8.43,25.83-1.18,33.57-1.43,99-1.43m0-44.13c-66.52,0-74.86.28-101,1.47s-43.87,5.33-59.45,11.38A120.06,120.06,0,0,0,45.81,47.44,120.06,120.06,0,0,0,17.56,90.82C11.5,106.4,7.36,124.2,6.17,150.27s-1.47,34.46-1.47,101,0.28,74.86,1.47,101,5.33,43.87,11.38,59.45a120.06,120.06,0,0,0,28.25,43.38,120.06,120.06,0,0,0,43.38,28.25c15.58,6.05,33.38,10.19,59.45,11.38s34.46,1.47,101,1.47,74.86-.28,101-1.47,43.87-5.33,59.45-11.38a125.24,125.24,0,0,0,71.63-71.63c6.05-15.58,10.19-33.38,11.38-59.45s1.47-34.46,1.47-101-0.28-74.86-1.47-101-5.33-43.87-11.38-59.45a120.06,120.06,0,0,0-28.25-43.38,120.06,120.06,0,0,0-43.38-28.25C394.47,13.13,376.67,9,350.6,7.8s-34.46-1.47-101-1.47h0Z" transform="translate(-4.7 -6.33)" /><path d="M249.62,125.48A125.77,125.77,0,1,0,375.39,251.25,125.77,125.77,0,0,0,249.62,125.48Zm0,207.41a81.64,81.64,0,1,1,81.64-81.64A81.64,81.64,0,0,1,249.62,332.89Z" transform="translate(-4.7 -6.33)"/><circle cx="375.66" cy="114.18" r="29.39" /></symbol><symbol id="icon-linkedin" viewBox="0 0 12 14"><path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"></path></symbol><symbol id="icon-heart" viewBox="0 0 34 30"><path d="M17,29.7 L16.4,29.2 C3.5,18.7 0,15 0,9 C0,4 4,0 9,0 C13.1,0 15.4,2.3 17,4.1 C18.6,2.3 20.9,0 25,0 C30,0 34,4 34,9 C34,15 30.5,18.7 17.6,29.2 L17,29.7 Z M9,2 C5.1,2 2,5.1 2,9 C2,14.1 5.2,17.5 17,27.1 C28.8,17.5 32,14.1 32,9 C32,5.1 28.9,2 25,2 C21.5,2 19.6,4.1 18.1,5.8 L17,7.1 L15.9,5.8 C14.4,4.1 12.5,2 9,2 Z" id="Shape"></path></symbol><symbol id="icon-arrow-right" viewBox="0 0 25.452 25.452"><path d="M4.471,24.929v-2.004l12.409-9.788c0.122-0.101,0.195-0.251,0.195-0.411c0-0.156-0.073-0.31-0.195-0.409L4.471,2.526V0.522c0-0.2,0.115-0.384,0.293-0.469c0.18-0.087,0.396-0.066,0.552,0.061l15.47,12.202c0.123,0.1,0.195,0.253,0.195,0.409c0,0.16-0.072,0.311-0.195,0.411L5.316,25.34c-0.155,0.125-0.372,0.147-0.552,0.061C4.586,25.315,4.471,25.13,4.471,24.929z"/></symbol><symbol id="icon-star" viewBox="0 0 48 48"><path fill="currentColor" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"/><path fill="#ffffff" d="M24,11l3.898,7.898l8.703,1.301l-6.301,6.102l1.5,8.699L24,30.898L16.199,35l1.5-8.699l-6.301-6.102  l8.703-1.301L24,11z"/></symbol><symbol id="icon-read" viewBox="0 0 32 32"><path fill="currentColor" d="M29,4H3C1.343,4,0,5.343,0,7v18c0,1.657,1.343,3,3,3h10c0,0.552,0.448,1,1,1h4c0.552,0,1-0.448,1-1h10  c1.657,0,3-1.343,3-3V7C32,5.343,30.657,4,29,4z M29,5v20H18.708c-0.618,0-1.236,0.146-1.789,0.422l-0.419,0.21V5H29z M15.5,5  v20.632l-0.419-0.21C14.528,25.146,13.91,25,13.292,25H3V5H15.5z M31,25c0,1.103-0.897,2-2,2H18v1h-4v-1H3c-1.103,0-2-0.897-2-2V7  c0-0.737,0.405-1.375,1-1.722V25c0,0.552,0.448,1,1,1h10.292c0.466,0,0.925,0.108,1.342,0.317l0.919,0.46  c0.141,0.07,0.294,0.106,0.447,0.106c0.153,0,0.306-0.035,0.447-0.106l0.919-0.46C17.783,26.108,18.242,26,18.708,26H29  c0.552,0,1-0.448,1-1V5.278C30.595,5.625,31,6.263,31,7V25z M6,12.5C6,12.224,6.224,12,6.5,12h5c0.276,0,0.5,0.224,0.5,0.5  S11.776,13,11.5,13h-5C6.224,13,6,12.776,6,12.5z M6,14.5C6,14.224,6.224,14,6.5,14h5c0.276,0,0.5,0.224,0.5,0.5S11.776,15,11.5,15  h-5C6.224,15,6,14.776,6,14.5z M6,16.5C6,16.224,6.224,16,6.5,16h5c0.276,0,0.5,0.224,0.5,0.5S11.776,17,11.5,17h-5  C6.224,17,6,16.776,6,16.5z M20,12.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,13,25.5,13h-5  C20.224,13,20,12.776,20,12.5z M20,14.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,15,25.5,15h-5  C20.224,15,20,14.776,20,14.5z M20,16.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,17,25.5,17h-5  C20.224,17,20,16.776,20,16.5z"></path></symbol><symbol id="icon-tistory" viewBox="0 0 24 24"><path d="M4 4h16v3h-6v13h-4V7H4V4z"/></symbol></defs></svg>

        <header class="bar-header">
    <a id="menu" role="button">
        <svg id="open" class="icon-menu"><use xlink:href="#icon-menu"></use></svg>
    </a>
    <h1 class="logo">
        <a href="/">
            
                somaz <span class="version">v3.1.2</span>
            
        </a>
    </h1>
    <a id="search" class="dosearch" role="button">
        <svg class="icon-search"><use xlink:href="#icon-search"></use></svg>
    </a>
    
        <a href="https://github.com/thiagorossener/jekflix-template" class="get-theme" role="button">
            Get this theme!
        </a>
    
</header>

<div id="mask" class="overlay"></div>

<aside class="sidebar" id="sidebar">
    <nav id="navigation">
      <h2>Menu</h2>
      <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>

    </nav>
</aside>

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search">
        <svg class="icon-remove-sign"><use xlink:href="#icon-close"></use></svg>
        <ul class="search-results search-list"></ul>
    </div>
</div>



        <section class="post two-columns">
            <article role="article" class="post-content">
                <p class="post-info">
                    
                        <svg class="icon-calendar" id="date"><use xlink:href="#icon-calendar"></use></svg>
                        <time class="date" datetime="2025-03-28T05:00:00+00:00">
                            


March 28, 2025

                        </time>
                    
                    <svg id="clock" class="icon-clock"><use xlink:href="#icon-clock"></use></svg>
                    <span>19 min to read</span>
                </p>
                <h1 class="post-title">What is Kustomize? A Configuration Management Tool for Kubernetes</h1>
                <p class="post-subtitle">A comprehensive guide to Kustomize usage and implementation</p>

                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1739947439/kustomize_luhcoo.png" alt="Featured image" class="post-cover">
                

                <!-- Pagination links -->



                <!-- Add your table of contents here -->


                <p><a href="https://kustomize.io">Image Reference</a></p>

<p><br /></p>

<hr />

<h2 id="overview">Overview</h2>
<blockquote>
  <p>This post explores Kustomize, a powerful tool for customizing Kubernetes manifests.</p>
</blockquote>

<p><br /></p>

<h2 id="what-is-kustomize">What is Kustomize?</h2>

<div class="info-box info-box-modern">
Kustomize is a template-free configuration customization tool for Kubernetes resources. <br /><br />It lets you customize raw, template-free YAML files for multiple environments, leaving the original files untouched and usable as-is.
</div>

<div style="width: 100%; margin: 20px auto;">
  <div class="mermaid">
    graph TD
      A[Base YAML Files] --&gt; B{Kustomize}
      C[Overlay 1 Patches] --&gt; B
      D[Overlay 2 Patches] --&gt; B
      E[Overlay 3 Patches] --&gt; B
      B --&gt; F[Generated YAML for Environment 1]
      B --&gt; G[Generated YAML for Environment 2]
      B --&gt; H[Generated YAML for Environment 3]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#64b5f6,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#ffcc80,stroke:#333,stroke-width:1px
      style E fill:#ffcc80,stroke:#333,stroke-width:1px
      style F fill:#e6ee9c,stroke:#333,stroke-width:1px
      style G fill:#e6ee9c,stroke:#333,stroke-width:1px
      style H fill:#e6ee9c,stroke:#333,stroke-width:1px
  </div>
</div>

<h3 id="key-features-of-kustomize">Key Features of Kustomize</h3>

<p>✅ <strong>No Templates</strong>: Uses plain YAML files without templating languages<br />
✅ <strong>Overlay-Based</strong>: Generates variants from a common base<br />
✅ <strong>Declarative</strong>: Describes the desired state, not how to achieve it<br />
✅ <strong>Native Integration</strong>: Built into kubectl since v1.14<br />
✅ <strong>GitOps Friendly</strong>: Perfect for source-controlled configuration<br />
✅ <strong>No Duplication</strong>: Reuses common configurations with minimal changes</p>

<p><br /></p>

<h2 id="why-kustomize">Why Kustomize?</h2>

<h3 id="the-configuration-challenge">The Configuration Challenge</h3>

<p>Managing Kubernetes YAML manifests across multiple environments presents several challenges:</p>

<ul>
  <li><strong>Duplication</strong>: Copy-pasting configurations for different environments leads to maintenance issues</li>
  <li><strong>Environment Differences</strong>: Managing variations between dev, staging, and production</li>
  <li><strong>Configuration Drift</strong>: Ensuring consistency across environments</li>
  <li><strong>Change Management</strong>: Applying changes systematically across all environments</li>
</ul>

<div class="info-box info-box-default-not-check">
  <strong>Common Approaches to Configuration Management:</strong>
  <ol>
    <li><strong>Copy &amp; Paste</strong>: Duplicate files for each environment (error-prone, hard to maintain)</li>
    <li><strong>Templates</strong>: Use templating engines like Helm (adds complexity with templating language)</li>
    <li><strong>Overlays</strong>: Apply patches to base configurations (Kustomize's approach)</li>
  </ol>
</div>

<h3 id="kustomize-vs-helm">Kustomize vs Helm</h3>

<div class="table-container">
  <table class="table-beauty">
    <tr>
      <th style="width: 20%;">Feature</th>
      <th style="width: 40%;">Kustomize</th>
      <th style="width: 40%;">Helm</th>
    </tr>
    <tr>
      <td>Approach</td>
      <td>Overlay-based patching</td>
      <td>Template-based generation</td>
    </tr>
    <tr>
      <td>Syntax</td>
      <td>Native Kubernetes YAML</td>
      <td>Go templates syntax</td>
    </tr>
    <tr>
      <td>Learning Curve</td>
      <td>Lower (if familiar with Kubernetes YAML)</td>
      <td>Higher (requires learning template syntax)</td>
    </tr>
    <tr>
      <td>Package Management</td>
      <td>No central repository</td>
      <td>Charts repository system</td>
    </tr>
    <tr>
      <td>Versioning</td>
      <td>Git-based versioning</td>
      <td>Chart versioning</td>
    </tr>
    <tr>
      <td>Integration</td>
      <td>Native in kubectl</td>
      <td>Separate CLI tool</td>
    </tr>
    <tr>
      <td>Best For</td>
      <td>Environment-specific variations with same resources</td>
      <td>Distributing/reusing complete applications</td>
    </tr>
  </table>
</div>

<p><br /></p>

<h2 id="installation">Installation</h2>

<h3 id="installing-kustomize-cli">Installing Kustomize CLI</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Method 1: Direct download and install</span>
curl <span class="nt">-s</span> <span class="s2">"https://raw.githubusercontent.com/kubernetes-sigs/kustomize/master/hack/install_kustomize.sh"</span> | bash
<span class="nb">sudo mv </span>kustomize /usr/local/bin/

<span class="c"># Method 2: Using Homebrew (macOS)</span>
brew <span class="nb">install </span>kustomize

<span class="c"># Method 3: Using Chocolatey (Windows)</span>
choco <span class="nb">install </span>kustomize
</code></pre></div></div>

<h3 id="verifying-installation">Verifying Installation</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kustomize version
</code></pre></div></div>

<h3 id="using-built-in-kubectl-support">Using Built-in kubectl Support</h3>

<p>Since Kubernetes v1.14, Kustomize functionality is built into kubectl:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using kubectl with Kustomize</span>
kubectl apply <span class="nt">-k</span> &lt;directory&gt;
kubectl diff <span class="nt">-k</span> &lt;directory&gt;
kubectl delete <span class="nt">-k</span> &lt;directory&gt;
</code></pre></div></div>

<p><br /></p>

<h2 id="core-concepts">Core Concepts</h2>

<h3 id="1-base-and-overlays">1. Base and Overlays</h3>

<p>Kustomize follows a “base + overlay” model:</p>

<div style="width: 100%; margin: 20px auto;">
  <div class="mermaid">
    graph TD
      A[Base] --&gt; B[Dev Overlay]
      A --&gt; C[Staging Overlay]
      A --&gt; D[Production Overlay]
      B --&gt; E[Generated Dev Resources]
      C --&gt; F[Generated Staging Resources]
      D --&gt; G[Generated Production Resources]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#ffcc80,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#ffcc80,stroke:#333,stroke-width:1px
      style E fill:#e6ee9c,stroke:#333,stroke-width:1px
      style F fill:#e6ee9c,stroke:#333,stroke-width:1px
      style G fill:#e6ee9c,stroke:#333,stroke-width:1px
  </div>
</div>

<ul>
  <li><strong>Base</strong>: Common YAML manifests shared across all environments</li>
  <li><strong>Overlays</strong>: Environment-specific customizations applied on top of the base</li>
  <li><strong>Variants</strong>: The resulting manifests for each environment</li>
</ul>

<p>Typical Project Structure:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── base
│   ├── kustomization.yaml     # Defines base resources
│   ├── deployment.yaml        # Common deployment configuration
│   ├── service.yaml           # Common service configuration  
│   └── configmap.yaml         # Common configmap
└── overlays
    ├── dev
    │   ├── kustomization.yaml # References base + dev patches
    │   └── patch-replicas.yaml # Dev-specific patches
    ├── staging
    │   ├── kustomization.yaml # References base + staging patches
    │   └── patch-replicas.yaml # Staging-specific patches
    └── production
        ├── kustomization.yaml # References base + production patches
        ├── patch-replicas.yaml # Production-specific patches
        └── patch-resources.yaml # Additional production patches
</code></pre></div></div>

<h3 id="2-kustomization-file">2. Kustomization File</h3>

<p>The <code class="language-plaintext highlighter-rouge">kustomization.yaml</code> is the configuration file that tells Kustomize what resources to include and how to transform them.</p>

<h4 id="base-kustomization">Base Kustomization</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># base/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">deployment.yaml</span>
<span class="pi">-</span> <span class="s">service.yaml</span>
<span class="pi">-</span> <span class="s">configmap.yaml</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">app</span><span class="pi">:</span> <span class="s">my-application</span>
</code></pre></div></div>

<h4 id="overlay-kustomization">Overlay Kustomization</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/dev/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../base</span>
<span class="na">namePrefix</span><span class="pi">:</span> <span class="s">dev-</span>
<span class="na">namespace</span><span class="pi">:</span> <span class="s">dev</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">dev</span>
  <span class="na">variant</span><span class="pi">:</span> <span class="s">development</span>
<span class="na">patches</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">deployment-patch.yaml</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/dev/deployment-patch.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">my-application</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">2</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="kustomize-transformers">Kustomize Transformers</h2>

<p>Kustomize uses various transformers to modify resources. These are the key transformers available:</p>

<h3 id="1-name-transformers">1. Name Transformers</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Add prefix to all resource names</span>
<span class="na">namePrefix</span><span class="pi">:</span> <span class="s">dev-</span>

<span class="c1"># Add suffix to all resource names</span>
<span class="na">nameSuffix</span><span class="pi">:</span> <span class="s">-v1</span>

<span class="c1"># Replace names</span>
<span class="na">replacements</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">source</span><span class="pi">:</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">source-name</span>
  <span class="na">targets</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">select</span><span class="pi">:</span>
      <span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
    <span class="na">fieldPaths</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">spec.template.spec.volumes[0].configMap.name</span>
</code></pre></div></div>

<h3 id="2-label-transformers">2. Label Transformers</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Add labels to all resources</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">dev</span>
  <span class="na">app</span><span class="pi">:</span> <span class="s">my-application</span>

<span class="c1"># Add annotations to all resources</span>
<span class="na">commonAnnotations</span><span class="pi">:</span>
  <span class="na">note</span><span class="pi">:</span> <span class="s2">"</span><span class="s">This</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">dev</span><span class="nv"> </span><span class="s">environment"</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">v1.0.0"</span>
</code></pre></div></div>

<h3 id="3-patches">3. Patches</h3>

<h4 id="strategic-merge-patches">Strategic Merge Patches</h4>

<p>Strategic merge patches use the Kubernetes resource structure to intelligently merge changes:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># kustomization.yaml</span>
<span class="na">patches</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">patch-deployment.yaml</span>
  <span class="na">target</span><span class="pi">:</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># patch-deployment.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">my-deployment</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>  <span class="c1"># Will override the replicas in base</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
        <span class="na">resources</span><span class="pi">:</span>  <span class="c1"># Will be merged with existing resources</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">512Mi"</span>
</code></pre></div></div>

<h4 id="json-6902-patches">JSON 6902 Patches</h4>

<p>For more precise changes, JSON 6902 patches can be used:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># kustomization.yaml</span>
<span class="na">patchesJson6902</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">target</span><span class="pi">:</span>
    <span class="na">group</span><span class="pi">:</span> <span class="s">apps</span>
    <span class="na">version</span><span class="pi">:</span> <span class="s">v1</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">my-deployment</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s">deployment-patch.yaml</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># deployment-patch.yaml</span>
<span class="pi">-</span> <span class="na">op</span><span class="pi">:</span> <span class="s">replace</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s">/spec/replicas</span>
  <span class="na">value</span><span class="pi">:</span> <span class="m">5</span>

<span class="pi">-</span> <span class="na">op</span><span class="pi">:</span> <span class="s">add</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s">/metadata/annotations/monitoring</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
</code></pre></div></div>

<h3 id="4-configmap-and-secret-generators">4. ConfigMap and Secret Generators</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Generate ConfigMaps from files and literals</span>
<span class="na">configMapGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app-config</span>
  <span class="na">files</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">application.properties</span>
  <span class="pi">-</span> <span class="s">settings.json</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">ENVIRONMENT=dev</span>
  <span class="pi">-</span> <span class="s">DEBUG=true</span>

<span class="c1"># Generate Secrets from files and literals</span>
<span class="na">secretGenerator</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app-secrets</span>
  <span class="na">files</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">secret.properties</span>
  <span class="na">literals</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">API_KEY=secret-value</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="practical-implementation-guide">Practical Implementation Guide</h2>

<p>Let’s build a complete example of a microservice deployment with Kustomize.</p>

<h3 id="step-1-create-base-structure">Step 1: Create Base Structure</h3>

<p>Create basic directory structure and files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> kustomize-demo/<span class="o">{</span>base,overlays/<span class="o">{</span>dev,staging,production<span class="o">}}</span>
</code></pre></div></div>

<h3 id="step-2-define-base-resources">Step 2: Define Base Resources</h3>

<h4 id="deployment">Deployment</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># base/deployment.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">web-app</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">web-app</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.19</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">80</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">64Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">100m"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">128Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">200m"</span>
        <span class="na">volumeMounts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
          <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/etc/nginx/conf.d</span>
      <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
        <span class="na">configMap</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">web-app-config</span>
</code></pre></div></div>

<h4 id="service">Service</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># base/service.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">web-app</span>
  <span class="na">ports</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
    <span class="na">targetPort</span><span class="pi">:</span> <span class="m">80</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">ClusterIP</span>
</code></pre></div></div>

<h4 id="configmap">ConfigMap</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># base/nginx-config.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app-config</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">default.conf</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">server {</span>
      <span class="s">listen 80;</span>
      <span class="s">location / {</span>
        <span class="s">root /usr/share/nginx/html;</span>
        <span class="s">index index.html;</span>
      <span class="s">}</span>
    <span class="s">}</span>
</code></pre></div></div>

<h4 id="base-kustomization-1">Base Kustomization</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># base/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">deployment.yaml</span>
<span class="pi">-</span> <span class="s">service.yaml</span>
<span class="pi">-</span> <span class="s">nginx-config.yaml</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">app</span><span class="pi">:</span> <span class="s">web-app</span>
</code></pre></div></div>

<h3 id="step-3-create-overlays">Step 3: Create Overlays</h3>

<h4 id="dev-environment">Dev Environment</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/dev/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../base</span>
<span class="na">namePrefix</span><span class="pi">:</span> <span class="s">dev-</span>
<span class="na">namespace</span><span class="pi">:</span> <span class="s">dev</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">dev</span>
  <span class="na">variant</span><span class="pi">:</span> <span class="s">development</span>
<span class="na">patches</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">deployment-patch.yaml</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/dev/deployment-patch.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">2</span>
</code></pre></div></div>

<h4 id="staging-environment">Staging Environment</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/staging/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../base</span>
<span class="na">namePrefix</span><span class="pi">:</span> <span class="s">staging-</span>
<span class="na">namespace</span><span class="pi">:</span> <span class="s">staging</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">staging</span>
  <span class="na">variant</span><span class="pi">:</span> <span class="s">pre-production</span>
<span class="na">patches</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">deployment-patch.yaml</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/staging/deployment-patch.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">256Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">300m"</span>
</code></pre></div></div>

<h4 id="production-environment">Production Environment</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/production/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../base</span>
<span class="na">namePrefix</span><span class="pi">:</span> <span class="s">prod-</span>
<span class="na">namespace</span><span class="pi">:</span> <span class="s">production</span>
<span class="na">commonLabels</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">production</span>
  <span class="na">variant</span><span class="pi">:</span> <span class="s">stable</span>
<span class="na">patches</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">deployment-patch.yaml</span>
<span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">service-patch.yaml</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/production/deployment-patch.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">5</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.19-alpine</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">128Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">200m"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">512Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># overlays/production/service-patch.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">LoadBalancer</span>
</code></pre></div></div>

<h3 id="step-4-building-and-applying">Step 4: Building and Applying</h3>

<h4 id="build-manifests">Build Manifests</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generate manifests for different environments</span>
kustomize build overlays/dev <span class="o">&gt;</span> dev-manifests.yaml
kustomize build overlays/staging <span class="o">&gt;</span> staging-manifests.yaml
kustomize build overlays/production <span class="o">&gt;</span> production-manifests.yaml
</code></pre></div></div>

<h4 id="apply-to-cluster">Apply to Cluster</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using kustomize directly</span>
kustomize build overlays/dev | kubectl apply <span class="nt">-f</span> -

<span class="c"># Using kubectl's built-in support</span>
kubectl apply <span class="nt">-k</span> overlays/dev/
</code></pre></div></div>

<p><br /></p>

<h2 id="advanced-features-and-techniques">Advanced Features and Techniques</h2>

<h3 id="component-reuse">Component Reuse</h3>

<p>Components are reusable pieces of kustomization that can be included in different bases or overlays:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># components/monitoring/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">prometheus.yaml</span>
<span class="pi">-</span> <span class="s">grafana.yaml</span>

<span class="c1"># To use the component:</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../base</span>
<span class="na">components</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../components/monitoring</span>
</code></pre></div></div>

<h3 id="composition-and-inheritance">Composition and Inheritance</h3>

<p>Kustomize supports multiple levels of composition:</p>

<div style="width: 100%; margin: 20px auto;">
  <div class="mermaid">
    graph TD
      A[Platform Base] --&gt; B[Service Base]
      B --&gt; C[Dev Overlay]
      B --&gt; D[Staging Overlay]
      B --&gt; E[Production Overlay]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#64b5f6,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#ffcc80,stroke:#333,stroke-width:1px
      style E fill:#ffcc80,stroke:#333,stroke-width:1px
  </div>
</div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># platform-base/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">namespace.yaml</span>
<span class="pi">-</span> <span class="s">network-policy.yaml</span>

<span class="c1"># service-base/kustomization.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kustomize.config.k8s.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kustomization</span>
<span class="na">resources</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../platform-base</span>
<span class="pi">-</span> <span class="s">deployment.yaml</span>
<span class="pi">-</span> <span class="s">service.yaml</span>
</code></pre></div></div>

<h3 id="custom-resource-transformers">Custom Resource Transformers</h3>

<p>Advanced transformations can be achieved with custom transformers:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">transformers</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">mytransformer.yaml</span>

<span class="c1"># mytransformer.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">builtin</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PatchTransformer</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">custom-transformer</span>
<span class="na">patch</span><span class="pi">:</span> <span class="pi">|</span>
  <span class="s">- op: add</span>
    <span class="s">path: /spec/template/spec/containers/0/env/-</span>
    <span class="s">value: </span>
      <span class="s">name: CUSTOM_ENV</span>
      <span class="s">value: custom-value</span>
<span class="na">target</span><span class="pi">:</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="integrating-kustomize-with-cicd">Integrating Kustomize with CI/CD</h2>

<h3 id="gitops-workflow">GitOps Workflow</h3>

<p>A GitOps approach to Kustomize typically involves:</p>

<ol>
  <li><strong>Source Control</strong>: Maintain base and overlays in Git</li>
  <li><strong>Automated Builds</strong>: CI pipeline generates environment-specific manifests</li>
  <li><strong>Deployment</strong>: CD system applies manifests to clusters</li>
</ol>

<div style="width: 100%; margin: 20px auto;">
  <div class="mermaid">
    graph LR
      A[Git Repository] --&gt; B[CI Pipeline]
      B --&gt; C[Generated Manifests]
      C --&gt; D[CD System]
      D --&gt; E[Dev Cluster]
      D --&gt; F[Staging Cluster]
      D --&gt; G[Production Cluster]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#64b5f6,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#e6ee9c,stroke:#333,stroke-width:1px
      style E fill:#ce93d8,stroke:#333,stroke-width:1px
      style F fill:#ce93d8,stroke:#333,stroke-width:1px
      style G fill:#ce93d8,stroke:#333,stroke-width:1px
  </div>
</div>

<h3 id="example-gitlab-ci-pipeline">Example: GitLab CI Pipeline</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .gitlab-ci.yml</span>
<span class="na">stages</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">validate</span>
  <span class="pi">-</span> <span class="s">build</span>
  <span class="pi">-</span> <span class="s">deploy</span>

<span class="na">validate</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">validate</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kustomize build overlays/dev | kubeval --strict</span>
    <span class="pi">-</span> <span class="s">kustomize build overlays/staging | kubeval --strict</span>
    <span class="pi">-</span> <span class="s">kustomize build overlays/production | kubeval --strict</span>

<span class="na">build-manifests</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">build</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kustomize build overlays/dev &gt; build/dev-manifests.yaml</span>
    <span class="pi">-</span> <span class="s">kustomize build overlays/staging &gt; build/staging-manifests.yaml</span>
    <span class="pi">-</span> <span class="s">kustomize build overlays/production &gt; build/production-manifests.yaml</span>
  <span class="na">artifacts</span><span class="pi">:</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">build/</span>

<span class="na">deploy-dev</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">deploy</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">dev</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kubectl apply -f build/dev-manifests.yaml</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">develop</span>

<span class="na">deploy-staging</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">deploy</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">staging</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kubectl apply -f build/staging-manifests.yaml</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">main</span>

<span class="na">deploy-production</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">deploy</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">production</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kubectl apply -f build/production-manifests.yaml</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">tags</span>
  <span class="na">when</span><span class="pi">:</span> <span class="s">manual</span>
</code></pre></div></div>

<h3 id="example-argocd-integration">Example: ArgoCD Integration</h3>

<p>ArgoCD can directly use Kustomize to deploy applications:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Application CRD for ArgoCD</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">argoproj.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Application</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">my-application-dev</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">project</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">source</span><span class="pi">:</span>
    <span class="na">repoURL</span><span class="pi">:</span> <span class="s">https://github.com/myorg/my-kustomize-repo.git</span>
    <span class="na">targetRevision</span><span class="pi">:</span> <span class="s">HEAD</span>
    <span class="na">path</span><span class="pi">:</span> <span class="s">overlays/dev</span>
  <span class="na">destination</span><span class="pi">:</span>
    <span class="na">server</span><span class="pi">:</span> <span class="s">https://kubernetes.default.svc</span>
    <span class="na">namespace</span><span class="pi">:</span> <span class="s">dev</span>
  <span class="na">syncPolicy</span><span class="pi">:</span>
    <span class="na">automated</span><span class="pi">:</span>
      <span class="na">prune</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">selfHeal</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="common-patterns-and-best-practices">Common Patterns and Best Practices</h2>

<div class="info-box info-box-modern">
  <strong>⚙️ Best Practices</strong>
  <ul>
    <li><strong>Directory Structure</strong>
      <ul>
        <li>Keep base configurations minimal and environment-agnostic</li>
        <li>Use meaningful names for overlay directories</li>
        <li>Group related components together</li>
        <li>Consider using components for cross-cutting concerns</li>
      </ul>
    </li>
    <li><strong>Version Control</strong>
      <ul>
        <li>Commit base configurations and overlays together</li>
        <li>Document environment-specific requirements</li>
        <li>Use tags for stable versions</li>
        <li>Consider feature branches for major changes</li>
      </ul>
    </li>
    <li><strong>Resource Management</strong>
      <ul>
        <li>Use namePrefix or nameSuffix to avoid naming conflicts</li>
        <li>Implement proper namespace management</li>
        <li>Use commonLabels for resource tracking</li>
        <li>Generate configmaps and secrets instead of hardcoding</li>
      </ul>
    </li>
    <li><strong>Security Considerations</strong>
      <ul>
        <li>Never commit sensitive data in base configurations</li>
        <li>Use secretGenerator for sensitive information</li>
        <li>Consider using Sealed Secrets or external secret management</li>
        <li>Implement proper RBAC configurations</li>
      </ul>
    </li>
  </ul>
</div>

<h3 id="real-world-example-multi-environment-microservice-deployment">Real-World Example: Multi-Environment Microservice Deployment</h3>

<div class="info-box info-box-default">
  <strong>Case Study: E-commerce Platform</strong>
  <p>An e-commerce company uses Kustomize to manage their 20+ microservices across development, staging, and production environments.</p>
  
  <p><strong>Implementation:</strong></p>
  <ul>
    <li>Platform base with common policies, RBAC, and network rules</li>
    <li>Service-specific bases with standard configurations</li>
    <li>Environment overlays customizing resources and replica counts</li>
    <li>Region-specific overlays for global deployment</li>
    <li>ArgoCD integration for GitOps-based continuous delivery</li>
  </ul>
  
  <p><strong>Benefits:</strong></p>
  <ul>
    <li>90% reduction in duplicate configuration</li>
    <li>Consistent environments with environment-specific tuning</li>
    <li>Faster onboarding of new developers</li>
    <li>Audit trail of all configuration changes</li>
    <li>Reliable continuous deployment</li>
  </ul>
</div>

<p><br /></p>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>

<h4 id="1-resource-not-found">1. Resource Not Found</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Verify the resource exists in base</span>
kubectl kustomize base

<span class="c"># Check overlay configuration</span>
kubectl kustomize overlays/dev
</code></pre></div></div>

<p><strong>Solution</strong>: Ensure file paths in resources sections are correct and verify file existence.</p>

<h4 id="2-patch-not-applied">2. Patch Not Applied</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Debug patch application</span>
kustomize build <span class="nt">--load-restrictor</span> LoadRestrictionsNone overlays/dev

<span class="c"># Verify patch syntax</span>
kustomize build overlays/dev <span class="nt">--enable-alpha-plugins</span>
</code></pre></div></div>

<p><strong>Solution</strong>: Check that target selectors match resource names exactly, including any name prefixes/suffixes.</p>

<h4 id="3-namespace-issues">3. Namespace Issues</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Verify namespace configuration</span>
kubectl config get-contexts
kubectl config set-context <span class="nt">--current</span> <span class="nt">--namespace</span><span class="o">=</span>target-namespace
</code></pre></div></div>

<p><strong>Solution</strong>: Ensure namespace is defined in kustomization.yaml if needed.</p>

<h4 id="4-version-compatibility">4. Version Compatibility</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check Kustomize version</span>
kustomize version

<span class="c"># Check kubectl version</span>
kubectl version
</code></pre></div></div>

<p><strong>Solution</strong>: Update Kustomize or kubectl to compatible versions.</p>

<p><br /></p>

<h2 id="advanced-features">Advanced Features</h2>

<h3 id="1-strategic-merge-patches-vs-json-patches">1. Strategic Merge Patches vs JSON Patches</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Strategic Merge Patch (understands Kubernetes semantics)</span>
<span class="na">patchesStrategicMerge</span><span class="pi">:</span>
<span class="pi">-</span> <span class="pi">|-</span>
  <span class="s">apiVersion: apps/v1</span>
  <span class="s">kind: Deployment</span>
  <span class="s">metadata:</span>
    <span class="s">name: my-deployment</span>
  <span class="s">spec:</span>
    <span class="s">template:</span>
      <span class="s">spec:</span>
        <span class="s">containers:</span>
        <span class="s">- name: nginx</span>
          <span class="s">resources:</span>
            <span class="s">limits:</span>
              <span class="s">memory: 512Mi</span>

<span class="c1"># JSON 6902 Patch (more precise control)</span>
<span class="na">patchesJson6902</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">target</span><span class="pi">:</span>
    <span class="na">version</span><span class="pi">:</span> <span class="s">v1</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">my-deployment</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s">patch.yaml</span>
</code></pre></div></div>

<h3 id="2-cross-cutting-fields-with-transformers">2. Cross-Cutting Fields with Transformers</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Transformer to add fields to all resources</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">builtin</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PatchTransformer</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">global-settings</span>
<span class="na">patch</span><span class="pi">:</span> <span class="pi">|-</span>
  <span class="s">- op: add</span>
    <span class="s">path: /metadata/labels/release-id</span>
    <span class="s">value: v2023-01</span>
<span class="na">target</span><span class="pi">:</span>
  <span class="na">labelSelector</span><span class="pi">:</span> <span class="s">app</span>
</code></pre></div></div>

<h3 id="3-composition-with-components">3. Composition with Components</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Component for monitoring</span>
<span class="na">components</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">../../components/monitoring</span>
<span class="pi">-</span> <span class="s">../../components/logging</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="conclusion-and-takeaways">Conclusion and Takeaways</h2>

<h3 id="key-benefits-of-kustomize">Key Benefits of Kustomize</h3>

<ul>
  <li><strong>Simplicity</strong>: Uses native Kubernetes YAML without templating language</li>
  <li><strong>Reusability</strong>: Promotes sharing common configurations</li>
  <li><strong>Modularity</strong>: Enables compositional, layer-based approach</li>
  <li><strong>GitOps-Friendly</strong>: Works well with Git workflows and CI/CD systems</li>
  <li><strong>Kubernetes-Native</strong>: Integrated directly into kubectl</li>
</ul>

<h3 id="when-to-choose-kustomize">When to Choose Kustomize</h3>

<ul>
  <li>Managing multiple environments with similar configurations</li>
  <li>Need to maintain original manifests in readable form</li>
  <li>GitOps-based workflows</li>
  <li>Environments with predictable variations</li>
  <li>Teams already familiar with Kubernetes YAML</li>
</ul>

<p><br /></p>

<hr />

<h2 id="references">References</h2>
<ul>
  <li><a href="https://kubectl.docs.kubernetes.io/references/kustomize/">Kustomize Documentation</a></li>
  <li><a href="https://github.com/somaz94/kustomize-study">GitHub Repository Examples</a></li>
  <li><a href="https://kubectl.docs.kubernetes.io/guides/introduction/kustomize/">Kustomize Best Practices</a></li>
  <li><a href="https://github.com/kubernetes-sigs/kustomize">Kubernetes SIG Kustomize</a></li>
  <li><a href="https://argo-cd.readthedocs.io/en/stable/user-guide/kustomize/">ArgoCD with Kustomize</a></li>
  <li><a href="https://fluxcd.io/flux/guides/kustomize-introduction/">GitOps with Kustomize</a></li>
</ul>


                <!-- Pagination links -->


            </article>

            
                <aside class="see-also">
                    <h2>See also</h2>
                    <ul>
                        
                        
                        
                            <li>
                                <a href="/category/monitoring/what-is-grafana/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1745821241/grafana_rbydo6.png">
                                    
                                    <h3>What is Grafana?</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/kubernetes/kubernetes-endpoints-endpointslices/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1745818882/endpoints-endpointslices_bhba68.png">
                                    
                                    <h3>Understanding Kubernetes Endpoints and EndpointSlices</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/security/ssh-tunneling-guide/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1745818610/ssh-tunnel_feuxns.png">
                                    
                                    <h3>Mastering SSH Tunneling for Secure Remote Access</h3>
                                </a>
                            </li>
                        
                    </ul>
                </aside>
            

        </section>

        <!-- Add time bar only for pages without pagination -->
        
            <div class="time-bar" data-minutes="19">
    <span class="time-completed"></span>
    <span class="time-remaining"></span>
    <div class="bar">
        <span class="completed" style="width:0%;"></span>
        <span class="remaining" style="width:100%;"></span>
    </div>
</div>

            <button class="toggle-preview" onclick="togglePreview()">
    <span>Hide Preview ▼</span>
</button>

<div id="recommendationSection" class="recommendation">
    <div class="message">
        <strong>Why don't you read something next?</strong>
        <div>
            <button>
                <svg><use xlink:href="#icon-arrow-right"></use></svg>
                <span>Go back to top</span>
            </button>
        </div>
    </div>
    <div id="previewSection" class="preview-section">
        
        <a href="/category/network/curl/" class="post-preview">
            <div class="image">
                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1740039618/curl_uvaprn.png">
                
            </div>
            <h3 class="title">Understanding and Using Curl - A Comprehensive Guide</h3>
        </a>
    </div>
</div>

<style>
.toggle-preview {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #333;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.toggle-preview:hover {
    background: #444;
}

.toggle-preview.visible {
    opacity: 1;
}

.recommendation {
    margin-top: 1000px;
    display: block;
    transition: all 0.3s ease;
}

.recommendation.hidden {
    display: none;
}

.hide-preview {
    margin-left: 10px;
    background: none;
    border: 1px solid #666;
    color: #666;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}

.hide-preview:hover {
    background: #f0f0f0;
}

.preview-section {
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.preview-section.hidden {
    max-height: 0;
}
</style>

<script>
function togglePreview() {
    const recommendation = document.getElementById('recommendationSection');
    const button = document.querySelector('.toggle-preview span');
    
    if (recommendation.classList.contains('hidden')) {
        recommendation.classList.remove('hidden');
        button.textContent = 'Hide Preview ▼';
    } else {
        recommendation.classList.add('hidden');
        button.textContent = 'Show Preview ▲';
    }
}

window.addEventListener('scroll', function() {
    const toggleButton = document.querySelector('.toggle-preview');
    const recommendation = document.getElementById('recommendationSection');
    const rect = recommendation.getBoundingClientRect();
    
    if (rect.top <= window.innerHeight) {
        toggleButton.classList.add('visible');
    } else {
        toggleButton.classList.remove('visible');
    }
});
</script>

        

        <!-- Show modal if the post is the last one -->
        

        <!-- Show modal before user leaves the page -->
        

        <!-- Add your newsletter subscription form here -->

        <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;Learn about Kustomize, its features, and how to manage Kubernetes manifests effectively&quot;%20https://somaz.blog/category/kubernetes/kustomize/%20via%20&#64;twitter_username&hashtags=kubernetes,kustomize,devops,configuration,gitops"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://somaz.blog/category/kubernetes/kustomize/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
</section>

        

  <section class="author">
    <div class="details">
      
        <img class="img-rounded" src="/assets/img/uploads/profile.png" alt="Somaz">
      
      <p class="def">Author</p>
      <h3 class="name">
        <a href="/authors/somaz/">Somaz</a>
      </h3>
      <p class="desc">DevOps engineer focused on cloud infrastructure and automation</p>
      <p>
        
          <a href="https://github.com/somaz94" title="Github">
            <svg><use xlink:href="#icon-github"></use></svg>
          </a>
        
        
        
        
        
        
          <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
            <svg><use xlink:href="#icon-linkedin"></use></svg>
          </a>
        
        
          <a href="https://somaz.tistory.com" title="Tistory">
            <svg><use xlink:href="#icon-tistory"></use></svg>
          </a>
        
      </p>
    </div>
  </section>

  
  
  
  
  
  
  
  

  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Somaz",
      
      "image": "/assets/img/uploads/profile.png",
      
      "jobTitle": "DevOps Engineer",
      "url": "https://somaz.blog/authors/somaz/",
      "sameAs": [
        "https://github.com/somaz94","https://www.linkedin.com/in/somaz","https://{{ author.tistory_username }}.tistory.com"
      ]
  }
  </script>


        

<section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = 'https-somaz94-github-io';
        var disqus_title = '';
        var disqus_url = '/category/kubernetes/kustomize/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>



        <footer>
    <p>
      
        <a href="https://github.com/somaz94" title="Github">
          <svg><use xlink:href="#icon-github"></use></svg>
        </a>
      
      
        <a href="https://www.facebook.com/facebook_username" title="Facebook">
          <svg><use xlink:href="#icon-facebook"></use></svg>
        </a>
      
      
        <a href="https://twitter.com/twitter_username" title="Twitter">
          <svg><use xlink:href="#icon-twitter"></use></svg>
        </a>
      
      
        <a href="https://medium.com/@medium_username" title="Medium">
          <svg><use xlink:href="#icon-medium"></use></svg>
        </a>
      
      
        <a href="https://www.instagram.com/instagram_username" title="Instagram">
          <svg><use xlink:href="#icon-instagram"></use></svg>
        </a>
      
      
        <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
          <svg><use xlink:href="#icon-linkedin"></use></svg>
        </a>
      
      
        <a href="https://somaz.tistory.com" title="Tistory">
          <svg><use xlink:href="#icon-tistory"></use></svg>
        </a>
      
    </p>

    <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>


    <p>
      <a href="https://somaz.blog/sitemap.xml" title="sitemap">Sitemap</a> |
      <a href="https://somaz.blog/privacy-policy.html" title="Privacy Policy">Privacy Policy</a>
    </p>

    <p>
      <span>Somaz Tech Blog</span> <svg class="love"><use xlink:href="#icon-heart"></use></svg>
    </p>
</footer>










<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "somaz",
  "description": "DevOps engineer's tech blog.",
  "url": "https://somaz.blog/",
  "logo": {
      "@type": "ImageObject",
      "url": "https://somaz.blog/assets/img/icons/mediumtile.png",
      "width": "600",
      "height": "315"
  },
  "sameAs": [
    "https://github.com/somaz94","https://www.facebook.com/facebook_username","https://twitter.com/twitter_username","https://medium.com/@medium_username","https://www.instagram.com/instagram_username","https://www.linkedin.com/in/somaz","https://{{ site.tistory_username }}.tistory.com"
  ]
}
</script>

<!-- Include the script that allows Netlify CMS login -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<!-- Include the website scripts -->
<script src="/assets/js/scripts.min.js"></script>

<!-- Include Google Analytics script -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
<script>
  var host = window.location.hostname;
  if (host != 'localhost') {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXX-X');
  }
</script>
  


<!-- Include extra scripts -->



        

        
        
        
        
        
        
        
        
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "name": "What is Kustomize? A Configuration Management Tool for Kubernetes",
            "headline": "A comprehensive guide to Kustomize usage and implementation",
            "description": "Learn about Kustomize, its features, and how to manage Kubernetes manifests effectively",
            "image": "https://res.cloudinary.com/dkcm26aem/image/upload/v1739947439/kustomize_luhcoo.png",
            "url": "https://somaz.blog/category/kubernetes/kustomize/",
            "articleBody": "Image Reference





Overview

  This post explores Kustomize, a powerful tool for customizing Kubernetes manifests.




What is Kustomize?


Kustomize is a template-free configuration customization tool for Kubernetes resources. It lets you customize raw, template-free YAML files for multiple environments, leaving the original files untouched and usable as-is.



  
    graph TD
      A[Base YAML Files] --&amp;gt; B{Kustomize}
      C[Overlay 1 Patches] --&amp;gt; B
      D[Overlay 2 Patches] --&amp;gt; B
      E[Overlay 3 Patches] --&amp;gt; B
      B --&amp;gt; F[Generated YAML for Environment 1]
      B --&amp;gt; G[Generated YAML for Environment 2]
      B --&amp;gt; H[Generated YAML for Environment 3]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#64b5f6,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#ffcc80,stroke:#333,stroke-width:1px
      style E fill:#ffcc80,stroke:#333,stroke-width:1px
      style F fill:#e6ee9c,stroke:#333,stroke-width:1px
      style G fill:#e6ee9c,stroke:#333,stroke-width:1px
      style H fill:#e6ee9c,stroke:#333,stroke-width:1px
  


Key Features of Kustomize

✅ No Templates: Uses plain YAML files without templating languages
✅ Overlay-Based: Generates variants from a common base
✅ Declarative: Describes the desired state, not how to achieve it
✅ Native Integration: Built into kubectl since v1.14
✅ GitOps Friendly: Perfect for source-controlled configuration
✅ No Duplication: Reuses common configurations with minimal changes



Why Kustomize?

The Configuration Challenge

Managing Kubernetes YAML manifests across multiple environments presents several challenges:


  Duplication: Copy-pasting configurations for different environments leads to maintenance issues
  Environment Differences: Managing variations between dev, staging, and production
  Configuration Drift: Ensuring consistency across environments
  Change Management: Applying changes systematically across all environments



  Common Approaches to Configuration Management:
  
    Copy &amp;amp; Paste: Duplicate files for each environment (error-prone, hard to maintain)
    Templates: Use templating engines like Helm (adds complexity with templating language)
    Overlays: Apply patches to base configurations (Kustomize&apos;s approach)
  


Kustomize vs Helm


  
    
      Feature
      Kustomize
      Helm
    
    
      Approach
      Overlay-based patching
      Template-based generation
    
    
      Syntax
      Native Kubernetes YAML
      Go templates syntax
    
    
      Learning Curve
      Lower (if familiar with Kubernetes YAML)
      Higher (requires learning template syntax)
    
    
      Package Management
      No central repository
      Charts repository system
    
    
      Versioning
      Git-based versioning
      Chart versioning
    
    
      Integration
      Native in kubectl
      Separate CLI tool
    
    
      Best For
      Environment-specific variations with same resources
      Distributing/reusing complete applications
    
  




Installation

Installing Kustomize CLI

# Method 1: Direct download and install
curl -s &quot;https://raw.githubusercontent.com/kubernetes-sigs/kustomize/master/hack/install_kustomize.sh&quot; | bash
sudo mv kustomize /usr/local/bin/

# Method 2: Using Homebrew (macOS)
brew install kustomize

# Method 3: Using Chocolatey (Windows)
choco install kustomize


Verifying Installation

kustomize version


Using Built-in kubectl Support

Since Kubernetes v1.14, Kustomize functionality is built into kubectl:

# Using kubectl with Kustomize
kubectl apply -k &amp;lt;directory&amp;gt;
kubectl diff -k &amp;lt;directory&amp;gt;
kubectl delete -k &amp;lt;directory&amp;gt;




Core Concepts

1. Base and Overlays

Kustomize follows a “base + overlay” model:


  
    graph TD
      A[Base] --&amp;gt; B[Dev Overlay]
      A --&amp;gt; C[Staging Overlay]
      A --&amp;gt; D[Production Overlay]
      B --&amp;gt; E[Generated Dev Resources]
      C --&amp;gt; F[Generated Staging Resources]
      D --&amp;gt; G[Generated Production Resources]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#ffcc80,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#ffcc80,stroke:#333,stroke-width:1px
      style E fill:#e6ee9c,stroke:#333,stroke-width:1px
      style F fill:#e6ee9c,stroke:#333,stroke-width:1px
      style G fill:#e6ee9c,stroke:#333,stroke-width:1px
  



  Base: Common YAML manifests shared across all environments
  Overlays: Environment-specific customizations applied on top of the base
  Variants: The resulting manifests for each environment


Typical Project Structure:

├── base
│   ├── kustomization.yaml     # Defines base resources
│   ├── deployment.yaml        # Common deployment configuration
│   ├── service.yaml           # Common service configuration  
│   └── configmap.yaml         # Common configmap
└── overlays
    ├── dev
    │   ├── kustomization.yaml # References base + dev patches
    │   └── patch-replicas.yaml # Dev-specific patches
    ├── staging
    │   ├── kustomization.yaml # References base + staging patches
    │   └── patch-replicas.yaml # Staging-specific patches
    └── production
        ├── kustomization.yaml # References base + production patches
        ├── patch-replicas.yaml # Production-specific patches
        └── patch-resources.yaml # Additional production patches


2. Kustomization File

The kustomization.yaml is the configuration file that tells Kustomize what resources to include and how to transform them.

Base Kustomization

# base/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- deployment.yaml
- service.yaml
- configmap.yaml
commonLabels:
  app: my-application


Overlay Kustomization

# overlays/dev/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base
namePrefix: dev-
namespace: dev
commonLabels:
  environment: dev
  variant: development
patches:
- path: deployment-patch.yaml


# overlays/dev/deployment-patch.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-application
spec:
  replicas: 2




Kustomize Transformers

Kustomize uses various transformers to modify resources. These are the key transformers available:

1. Name Transformers

# Add prefix to all resource names
namePrefix: dev-

# Add suffix to all resource names
nameSuffix: -v1

# Replace names
replacements:
- source:
    kind: ConfigMap
    name: source-name
  targets:
  - select:
      kind: Deployment
    fieldPaths:
    - spec.template.spec.volumes[0].configMap.name


2. Label Transformers

# Add labels to all resources
commonLabels:
  environment: dev
  app: my-application

# Add annotations to all resources
commonAnnotations:
  note: &quot;This is a dev environment&quot;
  version: &quot;v1.0.0&quot;


3. Patches

Strategic Merge Patches

Strategic merge patches use the Kubernetes resource structure to intelligently merge changes:

# kustomization.yaml
patches:
- path: patch-deployment.yaml
  target:
    kind: Deployment


# patch-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-deployment
spec:
  replicas: 3  # Will override the replicas in base
  template:
    spec:
      containers:
      - name: nginx
        resources:  # Will be merged with existing resources
          limits:
            memory: &quot;512Mi&quot;


JSON 6902 Patches

For more precise changes, JSON 6902 patches can be used:

# kustomization.yaml
patchesJson6902:
- target:
    group: apps
    version: v1
    kind: Deployment
    name: my-deployment
  path: deployment-patch.yaml


# deployment-patch.yaml
- op: replace
  path: /spec/replicas
  value: 5

- op: add
  path: /metadata/annotations/monitoring
  value: &quot;true&quot;


4. ConfigMap and Secret Generators

# Generate ConfigMaps from files and literals
configMapGenerator:
- name: app-config
  files:
  - application.properties
  - settings.json
  literals:
  - ENVIRONMENT=dev
  - DEBUG=true

# Generate Secrets from files and literals
secretGenerator:
- name: app-secrets
  files:
  - secret.properties
  literals:
  - API_KEY=secret-value
  type: Opaque




Practical Implementation Guide

Let’s build a complete example of a microservice deployment with Kustomize.

Step 1: Create Base Structure

Create basic directory structure and files:

mkdir -p kustomize-demo/{base,overlays/{dev,staging,production}}


Step 2: Define Base Resources

Deployment

# base/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  selector:
    matchLabels:
      app: web-app
  replicas: 1
  template:
    metadata:
      labels:
        app: web-app
    spec:
      containers:
      - name: web-app
        image: nginx:1.19
        ports:
        - containerPort: 80
        resources:
          requests:
            memory: &quot;64Mi&quot;
            cpu: &quot;100m&quot;
          limits:
            memory: &quot;128Mi&quot;
            cpu: &quot;200m&quot;
        volumeMounts:
        - name: config-volume
          mountPath: /etc/nginx/conf.d
      volumes:
      - name: config-volume
        configMap:
          name: web-app-config


Service

# base/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: web-app
spec:
  selector:
    app: web-app
  ports:
  - port: 80
    targetPort: 80
  type: ClusterIP


ConfigMap

# base/nginx-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: web-app-config
data:
  default.conf: |
    server {
      listen 80;
      location / {
        root /usr/share/nginx/html;
        index index.html;
      }
    }


Base Kustomization

# base/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- deployment.yaml
- service.yaml
- nginx-config.yaml
commonLabels:
  app: web-app


Step 3: Create Overlays

Dev Environment

# overlays/dev/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base
namePrefix: dev-
namespace: dev
commonLabels:
  environment: dev
  variant: development
patches:
- path: deployment-patch.yaml


# overlays/dev/deployment-patch.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  replicas: 2


Staging Environment

# overlays/staging/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base
namePrefix: staging-
namespace: staging
commonLabels:
  environment: staging
  variant: pre-production
patches:
- path: deployment-patch.yaml


# overlays/staging/deployment-patch.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  replicas: 3
  template:
    spec:
      containers:
      - name: web-app
        resources:
          limits:
            memory: &quot;256Mi&quot;
            cpu: &quot;300m&quot;


Production Environment

# overlays/production/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base
namePrefix: prod-
namespace: production
commonLabels:
  environment: production
  variant: stable
patches:
- path: deployment-patch.yaml
- path: service-patch.yaml


# overlays/production/deployment-patch.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  replicas: 5
  template:
    spec:
      containers:
      - name: web-app
        image: nginx:1.19-alpine
        resources:
          requests:
            memory: &quot;128Mi&quot;
            cpu: &quot;200m&quot;
          limits:
            memory: &quot;512Mi&quot;
            cpu: &quot;500m&quot;


# overlays/production/service-patch.yaml
apiVersion: v1
kind: Service
metadata:
  name: web-app
spec:
  type: LoadBalancer


Step 4: Building and Applying

Build Manifests

# Generate manifests for different environments
kustomize build overlays/dev &amp;gt; dev-manifests.yaml
kustomize build overlays/staging &amp;gt; staging-manifests.yaml
kustomize build overlays/production &amp;gt; production-manifests.yaml


Apply to Cluster

# Using kustomize directly
kustomize build overlays/dev | kubectl apply -f -

# Using kubectl&apos;s built-in support
kubectl apply -k overlays/dev/




Advanced Features and Techniques

Component Reuse

Components are reusable pieces of kustomization that can be included in different bases or overlays:

# components/monitoring/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- prometheus.yaml
- grafana.yaml

# To use the component:
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base
components:
- ../../components/monitoring


Composition and Inheritance

Kustomize supports multiple levels of composition:


  
    graph TD
      A[Platform Base] --&amp;gt; B[Service Base]
      B --&amp;gt; C[Dev Overlay]
      B --&amp;gt; D[Staging Overlay]
      B --&amp;gt; E[Production Overlay]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#64b5f6,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#ffcc80,stroke:#333,stroke-width:1px
      style E fill:#ffcc80,stroke:#333,stroke-width:1px
  


# platform-base/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- namespace.yaml
- network-policy.yaml

# service-base/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../platform-base
- deployment.yaml
- service.yaml


Custom Resource Transformers

Advanced transformations can be achieved with custom transformers:

transformers:
- mytransformer.yaml

# mytransformer.yaml
apiVersion: builtin
kind: PatchTransformer
metadata:
  name: custom-transformer
patch: |
  - op: add
    path: /spec/template/spec/containers/0/env/-
    value: 
      name: CUSTOM_ENV
      value: custom-value
target:
  kind: Deployment




Integrating Kustomize with CI/CD

GitOps Workflow

A GitOps approach to Kustomize typically involves:


  Source Control: Maintain base and overlays in Git
  Automated Builds: CI pipeline generates environment-specific manifests
  Deployment: CD system applies manifests to clusters



  
    graph LR
      A[Git Repository] --&amp;gt; B[CI Pipeline]
      B --&amp;gt; C[Generated Manifests]
      C --&amp;gt; D[CD System]
      D --&amp;gt; E[Dev Cluster]
      D --&amp;gt; F[Staging Cluster]
      D --&amp;gt; G[Production Cluster]
      
      style A fill:#a5d6a7,stroke:#333,stroke-width:1px
      style B fill:#64b5f6,stroke:#333,stroke-width:1px
      style C fill:#ffcc80,stroke:#333,stroke-width:1px
      style D fill:#e6ee9c,stroke:#333,stroke-width:1px
      style E fill:#ce93d8,stroke:#333,stroke-width:1px
      style F fill:#ce93d8,stroke:#333,stroke-width:1px
      style G fill:#ce93d8,stroke:#333,stroke-width:1px
  


Example: GitLab CI Pipeline

# .gitlab-ci.yml
stages:
  - validate
  - build
  - deploy

validate:
  stage: validate
  script:
    - kustomize build overlays/dev | kubeval --strict
    - kustomize build overlays/staging | kubeval --strict
    - kustomize build overlays/production | kubeval --strict

build-manifests:
  stage: build
  script:
    - kustomize build overlays/dev &amp;gt; build/dev-manifests.yaml
    - kustomize build overlays/staging &amp;gt; build/staging-manifests.yaml
    - kustomize build overlays/production &amp;gt; build/production-manifests.yaml
  artifacts:
    paths:
      - build/

deploy-dev:
  stage: deploy
  environment: dev
  script:
    - kubectl apply -f build/dev-manifests.yaml
  only:
    - develop

deploy-staging:
  stage: deploy
  environment: staging
  script:
    - kubectl apply -f build/staging-manifests.yaml
  only:
    - main

deploy-production:
  stage: deploy
  environment: production
  script:
    - kubectl apply -f build/production-manifests.yaml
  only:
    - tags
  when: manual


Example: ArgoCD Integration

ArgoCD can directly use Kustomize to deploy applications:

# Application CRD for ArgoCD
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: my-application-dev
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/myorg/my-kustomize-repo.git
    targetRevision: HEAD
    path: overlays/dev
  destination:
    server: https://kubernetes.default.svc
    namespace: dev
  syncPolicy:
    automated:
      prune: true
      selfHeal: true




Common Patterns and Best Practices


  ⚙️ Best Practices
  
    Directory Structure
      
        Keep base configurations minimal and environment-agnostic
        Use meaningful names for overlay directories
        Group related components together
        Consider using components for cross-cutting concerns
      
    
    Version Control
      
        Commit base configurations and overlays together
        Document environment-specific requirements
        Use tags for stable versions
        Consider feature branches for major changes
      
    
    Resource Management
      
        Use namePrefix or nameSuffix to avoid naming conflicts
        Implement proper namespace management
        Use commonLabels for resource tracking
        Generate configmaps and secrets instead of hardcoding
      
    
    Security Considerations
      
        Never commit sensitive data in base configurations
        Use secretGenerator for sensitive information
        Consider using Sealed Secrets or external secret management
        Implement proper RBAC configurations
      
    
  


Real-World Example: Multi-Environment Microservice Deployment


  Case Study: E-commerce Platform
  An e-commerce company uses Kustomize to manage their 20+ microservices across development, staging, and production environments.
  
  Implementation:
  
    Platform base with common policies, RBAC, and network rules
    Service-specific bases with standard configurations
    Environment overlays customizing resources and replica counts
    Region-specific overlays for global deployment
    ArgoCD integration for GitOps-based continuous delivery
  
  
  Benefits:
  
    90% reduction in duplicate configuration
    Consistent environments with environment-specific tuning
    Faster onboarding of new developers
    Audit trail of all configuration changes
    Reliable continuous deployment
  




Troubleshooting

Common Issues and Solutions

1. Resource Not Found

# Verify the resource exists in base
kubectl kustomize base

# Check overlay configuration
kubectl kustomize overlays/dev


Solution: Ensure file paths in resources sections are correct and verify file existence.

2. Patch Not Applied

# Debug patch application
kustomize build --load-restrictor LoadRestrictionsNone overlays/dev

# Verify patch syntax
kustomize build overlays/dev --enable-alpha-plugins


Solution: Check that target selectors match resource names exactly, including any name prefixes/suffixes.

3. Namespace Issues

# Verify namespace configuration
kubectl config get-contexts
kubectl config set-context --current --namespace=target-namespace


Solution: Ensure namespace is defined in kustomization.yaml if needed.

4. Version Compatibility

# Check Kustomize version
kustomize version

# Check kubectl version
kubectl version


Solution: Update Kustomize or kubectl to compatible versions.



Advanced Features

1. Strategic Merge Patches vs JSON Patches

# Strategic Merge Patch (understands Kubernetes semantics)
patchesStrategicMerge:
- |-
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: my-deployment
  spec:
    template:
      spec:
        containers:
        - name: nginx
          resources:
            limits:
              memory: 512Mi

# JSON 6902 Patch (more precise control)
patchesJson6902:
- target:
    version: v1
    kind: Deployment
    name: my-deployment
  path: patch.yaml


2. Cross-Cutting Fields with Transformers

# Transformer to add fields to all resources
apiVersion: builtin
kind: PatchTransformer
metadata:
  name: global-settings
patch: |-
  - op: add
    path: /metadata/labels/release-id
    value: v2023-01
target:
  labelSelector: app


3. Composition with Components

# Component for monitoring
components:
- ../../components/monitoring
- ../../components/logging




Conclusion and Takeaways

Key Benefits of Kustomize


  Simplicity: Uses native Kubernetes YAML without templating language
  Reusability: Promotes sharing common configurations
  Modularity: Enables compositional, layer-based approach
  GitOps-Friendly: Works well with Git workflows and CI/CD systems
  Kubernetes-Native: Integrated directly into kubectl


When to Choose Kustomize


  Managing multiple environments with similar configurations
  Need to maintain original manifests in readable form
  GitOps-based workflows
  Environments with predictable variations
  Teams already familiar with Kubernetes YAML






References

  Kustomize Documentation
  GitHub Repository Examples
  Kustomize Best Practices
  Kubernetes SIG Kustomize
  ArgoCD with Kustomize
  GitOps with Kustomize

",
            "wordcount": "3524",
            "inLanguage": "en",
            "dateCreated": "2025-03-28/",
            "datePublished": "2025-03-28/",
            "dateModified": "2025-03-28/",
            "author": {
                "@type": "Person",
                "name": "Somaz",
                
                "image": "/assets/img/uploads/profile.png",
                
                "jobTitle": "DevOps Engineer",
                "url": "https://somaz.blog/authors/somaz/",
                "sameAs": [
                    "https://github.com/somaz94","https://www.linkedin.com/in/somaz"
                ]
            },
            "publisher": {
                "@type": "Organization",
                "name": "somaz",
                "url": "https://somaz.blog/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://somaz.blog/assets/img/blog-image.png",
                    "width": "600",
                    "height": "315"
                }
            },
            "mainEntityOfPage": "True",
            "genre": "KUBERNETES",
            "articleSection": "KUBERNETES",
            "keywords": ["kubernetes","kustomize","devops","configuration","gitops"]
        }
        </script>
    </body>
</html>
