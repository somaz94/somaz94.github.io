<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    
    

    
    

    
    

    <!-- ✅ Google Tag Manager 추가 -->
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MBP83N4Q');
    </script>
      <!-- ✅ End Google Tag Manager -->

    <!-- Mermaid.js 직접 로드 -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>

    <title>GitLab CI/CD Template Guide | somaz</title>
    <meta name="description" content="Learn how to use and create GitLab CI/CD templates for efficient pipeline management">
    
        <meta name="keywords" content="gitlab, cicd, template, automation">
    

    <!-- Social: Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="GitLab CI/CD Template Guide | somaz">
    <meta name="twitter:description" content="Learn how to use and create GitLab CI/CD templates for efficient pipeline management">

    
        <meta property="twitter:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1737534845/gitlab-ci-template_qh2zvi.png">
    
    
    
        <meta name="twitter:site" content="@twitter_username">
    

    <!-- Social: Facebook / Open Graph -->
    <meta property="og:url" content="https://somaz.blog/category/cicd/gitlab-cicd-template-new/">
    <meta property="og:title" content="GitLab CI/CD Template Guide | somaz">
    <meta property="og:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1737534845/gitlab-ci-template_qh2zvi.png">
    <meta property="og:description" content="Learn how to use and create GitLab CI/CD templates for efficient pipeline management">
    <meta property="og:site_name" content="Somaz Tech Blog">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/img/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png" />

    <!-- Windows 8 Tile Icons -->
    <meta name="application-name" content="somaz">
    <meta name="msapplication-TileColor" content="#141414">
    <meta name="msapplication-square70x70logo" content="smalltile.png" />
    <meta name="msapplication-square150x150logo" content="mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="widetile.png" />
    <meta name="msapplication-square310x310logo" content="largetile.png" />
    
    <!-- Android Lolipop Theme Color -->
    <meta name="theme-color" content="#141414">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="canonical" href="https://somaz.blog/category/cicd/gitlab-cicd-template-new/">
    <link rel="alternate" type="application/rss+xml" title="Somaz Tech Blog" href="https://somaz.blog/feed.xml" />

    <!-- Include extra styles -->
    

    <!-- JavaScript enabled/disabled -->
    <script>
        document.querySelector('html').classList.remove('no-js');
    </script>

    <!-- Google Adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8725590811736154"
        crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"> -->
    <!-- <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/variable/woff2/SUIT-Variable.css" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;700&display=swap" rel="stylesheet"> -->

    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />

</head>
<!-- ✅ Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBP83N4Q"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- ✅ End Google Tag Manager (noscript) -->
    <body class="has-push-menu">
        





        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-close" viewBox="0 0 1000 1000"><path d="M969.8,870.3c27,27.7,27,71.8,0,99.1C955.7,983,937.9,990,920,990c-17.9,0-35.7-7-49.7-20.7L500,599L129.6,969.4C115.6,983,97.8,990,79.9,990s-35.7-7-49.7-20.7c-27-27.3-27-71.4,0-99.1L400.9,500L30.3,129.3c-27-27.3-27-71.4,0-99.1c27.3-27,71.8-27,99.4,0L500,400.9L870.4,30.2c27.7-27,71.8-27,99.4,0c27,27.7,27,71.8,0,99.1L599.1,500L969.8,870.3z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-clock" viewBox="0 0 1000 1000"><path d="M500,10C229.8,10,10,229.8,10,500c0,270.2,219.8,490,490,490c270.2,0,490-219.8,490-490C990,229.8,770.2,10,500,10z M500,910.2c-226.2,0-410.2-184-410.2-410.2c0-226.2,184-410.2,410.2-410.2c226.2,0,410.2,184,410.2,410.2C910.2,726.1,726.2,910.2,500,910.2z M753.1,374c8.2,11.9,5.2,28.1-6.6,36.3L509.9,573.7c-4.4,3.1-9.6,4.6-14.8,4.6c-4.1,0-8.3-1-12.1-3c-8.6-4.5-14-13.4-14-23.1V202.5c0-14.4,11.7-26.1,26.1-26.1c14.4,0,26.1,11.7,26.1,26.1v300l195.6-135.1C728.7,359.2,744.9,362.1,753.1,374z"/></symbol><symbol id="icon-calendar" viewBox="0 0 1000 1000"><path d="M920,500v420H80V500H920 M990,430H10v490c0,38.7,31.3,70,70,70h840c38.7,0,70-31.3,70-70V430L990,430z"/><path d="M850,80v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80H360v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80C72.8,80,10,142.7,10,220v140h980V220C990,142.7,927.2,80,850,80z"/><path d="M255,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C290,25.8,274.3,10,255,10z"/><path d="M745,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C780,25.8,764.3,10,745,10z"/></symbol><symbol id="icon-github" viewBox="0 0 12 14"><path d="M6 1q1.633 0 3.012 0.805t2.184 2.184 0.805 3.012q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.312-0.055t-0.102-0.234q0-0.023 0.004-0.598t0.004-1.051q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.93-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.664-0.105q-0.352 0.883-0.062 1.594-0.617 0.68-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.305 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.691t0.004 0.426q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805zM2.273 9.617q0.023-0.055-0.055-0.094-0.078-0.023-0.102 0.016-0.023 0.055 0.055 0.094 0.070 0.047 0.102-0.016zM2.516 9.883q0.055-0.039-0.016-0.125-0.078-0.070-0.125-0.023-0.055 0.039 0.016 0.125 0.078 0.078 0.125 0.023zM2.75 10.234q0.070-0.055 0-0.148-0.062-0.102-0.133-0.047-0.070 0.039 0 0.141t0.133 0.055zM3.078 10.562q0.062-0.062-0.031-0.148-0.094-0.094-0.156-0.023-0.070 0.062 0.031 0.148 0.094 0.094 0.156 0.023zM3.523 10.758q0.023-0.086-0.102-0.125-0.117-0.031-0.148 0.055t0.102 0.117q0.117 0.047 0.148-0.047zM4.016 10.797q0-0.102-0.133-0.086-0.125 0-0.125 0.086 0 0.102 0.133 0.086 0.125 0 0.125-0.086zM4.469 10.719q-0.016-0.086-0.141-0.070-0.125 0.023-0.109 0.117t0.141 0.062 0.109-0.109z"></path></symbol><symbol id="icon-medium" viewBox="0 0 1000 1000"><path d="M336.5,240.2v641.5c0,9.1-2.3,16.9-6.8,23.2s-11.2,9.6-20,9.6c-6.2,0-12.2-1.5-18-4.4L37.3,782.7c-7.7-3.6-14.1-9.8-19.4-18.3S10,747.4,10,739V115.5c0-7.3,1.8-13.5,5.5-18.6c3.6-5.1,8.9-7.7,15.9-7.7c5.1,0,13.1,2.7,24.1,8.2l279.5,140C335.9,238.6,336.5,239.5,336.5,240.2L336.5,240.2z M371.5,295.5l292,473.6l-292-145.5V295.5z M990,305.3v576.4c0,9.1-2.6,16.5-7.7,22.1c-5.1,5.7-12,8.5-20.8,8.5s-17.3-2.4-25.7-7.1L694.7,784.9L990,305.3z M988.4,239.7c0,1.1-46.8,77.6-140.3,229.4C754.6,621,699.8,709.8,683.8,735.7L470.5,389l177.2-288.2c6.2-10.2,15.7-15.3,28.4-15.3c5.1,0,9.8,1.1,14.2,3.3l295.9,147.7C987.6,237.1,988.4,238.2,988.4,239.7L988.4,239.7z"/></symbol><symbol id="icon-instagram" viewBox="0 0 489.84 489.84"><path d="M249.62,50.46c65.4,0,73.14.25,99,1.43C372.47,53,385.44,57,394.07,60.32a75.88,75.88,0,0,1,28.16,18.32,75.88,75.88,0,0,1,18.32,28.16c3.35,8.63,7.34,21.6,8.43,45.48,1.18,25.83,1.43,33.57,1.43,99s-0.25,73.14-1.43,99c-1.09,23.88-5.08,36.85-8.43,45.48a81.11,81.11,0,0,1-46.48,46.48c-8.63,3.35-21.6,7.34-45.48,8.43-25.82,1.18-33.57,1.43-99,1.43s-73.15-.25-99-1.43c-23.88-1.09-36.85-5.08-45.48-8.43A75.88,75.88,0,0,1,77,423.86,75.88,75.88,0,0,1,58.69,395.7c-3.35-8.63-7.34-21.6-8.43-45.48-1.18-25.83-1.43-33.57-1.43-99s0.25-73.14,1.43-99c1.09-23.88,5.08-36.85,8.43-45.48A75.88,75.88,0,0,1,77,78.64a75.88,75.88,0,0,1,28.16-18.32c8.63-3.35,21.6-7.34,45.48-8.43,25.83-1.18,33.57-1.43,99-1.43m0-44.13c-66.52,0-74.86.28-101,1.47s-43.87,5.33-59.45,11.38A120.06,120.06,0,0,0,45.81,47.44,120.06,120.06,0,0,0,17.56,90.82C11.5,106.4,7.36,124.2,6.17,150.27s-1.47,34.46-1.47,101,0.28,74.86,1.47,101,5.33,43.87,11.38,59.45a120.06,120.06,0,0,0,28.25,43.38,120.06,120.06,0,0,0,43.38,28.25c15.58,6.05,33.38,10.19,59.45,11.38s34.46,1.47,101,1.47,74.86-.28,101-1.47,43.87-5.33,59.45-11.38a125.24,125.24,0,0,0,71.63-71.63c6.05-15.58,10.19-33.38,11.38-59.45s1.47-34.46,1.47-101-0.28-74.86-1.47-101-5.33-43.87-11.38-59.45a120.06,120.06,0,0,0-28.25-43.38,120.06,120.06,0,0,0-43.38-28.25C394.47,13.13,376.67,9,350.6,7.8s-34.46-1.47-101-1.47h0Z" transform="translate(-4.7 -6.33)" /><path d="M249.62,125.48A125.77,125.77,0,1,0,375.39,251.25,125.77,125.77,0,0,0,249.62,125.48Zm0,207.41a81.64,81.64,0,1,1,81.64-81.64A81.64,81.64,0,0,1,249.62,332.89Z" transform="translate(-4.7 -6.33)"/><circle cx="375.66" cy="114.18" r="29.39" /></symbol><symbol id="icon-linkedin" viewBox="0 0 12 14"><path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"></path></symbol><symbol id="icon-heart" viewBox="0 0 34 30"><path d="M17,29.7 L16.4,29.2 C3.5,18.7 0,15 0,9 C0,4 4,0 9,0 C13.1,0 15.4,2.3 17,4.1 C18.6,2.3 20.9,0 25,0 C30,0 34,4 34,9 C34,15 30.5,18.7 17.6,29.2 L17,29.7 Z M9,2 C5.1,2 2,5.1 2,9 C2,14.1 5.2,17.5 17,27.1 C28.8,17.5 32,14.1 32,9 C32,5.1 28.9,2 25,2 C21.5,2 19.6,4.1 18.1,5.8 L17,7.1 L15.9,5.8 C14.4,4.1 12.5,2 9,2 Z" id="Shape"></path></symbol><symbol id="icon-arrow-right" viewBox="0 0 25.452 25.452"><path d="M4.471,24.929v-2.004l12.409-9.788c0.122-0.101,0.195-0.251,0.195-0.411c0-0.156-0.073-0.31-0.195-0.409L4.471,2.526V0.522c0-0.2,0.115-0.384,0.293-0.469c0.18-0.087,0.396-0.066,0.552,0.061l15.47,12.202c0.123,0.1,0.195,0.253,0.195,0.409c0,0.16-0.072,0.311-0.195,0.411L5.316,25.34c-0.155,0.125-0.372,0.147-0.552,0.061C4.586,25.315,4.471,25.13,4.471,24.929z"/></symbol><symbol id="icon-star" viewBox="0 0 48 48"><path fill="currentColor" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"/><path fill="#ffffff" d="M24,11l3.898,7.898l8.703,1.301l-6.301,6.102l1.5,8.699L24,30.898L16.199,35l1.5-8.699l-6.301-6.102  l8.703-1.301L24,11z"/></symbol><symbol id="icon-read" viewBox="0 0 32 32"><path fill="currentColor" d="M29,4H3C1.343,4,0,5.343,0,7v18c0,1.657,1.343,3,3,3h10c0,0.552,0.448,1,1,1h4c0.552,0,1-0.448,1-1h10  c1.657,0,3-1.343,3-3V7C32,5.343,30.657,4,29,4z M29,5v20H18.708c-0.618,0-1.236,0.146-1.789,0.422l-0.419,0.21V5H29z M15.5,5  v20.632l-0.419-0.21C14.528,25.146,13.91,25,13.292,25H3V5H15.5z M31,25c0,1.103-0.897,2-2,2H18v1h-4v-1H3c-1.103,0-2-0.897-2-2V7  c0-0.737,0.405-1.375,1-1.722V25c0,0.552,0.448,1,1,1h10.292c0.466,0,0.925,0.108,1.342,0.317l0.919,0.46  c0.141,0.07,0.294,0.106,0.447,0.106c0.153,0,0.306-0.035,0.447-0.106l0.919-0.46C17.783,26.108,18.242,26,18.708,26H29  c0.552,0,1-0.448,1-1V5.278C30.595,5.625,31,6.263,31,7V25z M6,12.5C6,12.224,6.224,12,6.5,12h5c0.276,0,0.5,0.224,0.5,0.5  S11.776,13,11.5,13h-5C6.224,13,6,12.776,6,12.5z M6,14.5C6,14.224,6.224,14,6.5,14h5c0.276,0,0.5,0.224,0.5,0.5S11.776,15,11.5,15  h-5C6.224,15,6,14.776,6,14.5z M6,16.5C6,16.224,6.224,16,6.5,16h5c0.276,0,0.5,0.224,0.5,0.5S11.776,17,11.5,17h-5  C6.224,17,6,16.776,6,16.5z M20,12.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,13,25.5,13h-5  C20.224,13,20,12.776,20,12.5z M20,14.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,15,25.5,15h-5  C20.224,15,20,14.776,20,14.5z M20,16.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,17,25.5,17h-5  C20.224,17,20,16.776,20,16.5z"></path></symbol><symbol id="icon-tistory" viewBox="0 0 24 24"><path d="M4 4h16v3h-6v13h-4V7H4V4z"/></symbol></defs></svg>

        <header class="bar-header">
    <a id="menu" role="button">
        <svg id="open" class="icon-menu"><use xlink:href="#icon-menu"></use></svg>
    </a>
    <h1 class="logo">
        <a href="/">
            
                somaz <span class="version">v3.1.2</span>
            
        </a>
    </h1>
    <a id="search" class="dosearch" role="button">
        <svg class="icon-search"><use xlink:href="#icon-search"></use></svg>
    </a>
    
        <a href="https://github.com/thiagorossener/jekflix-template" class="get-theme" role="button">
            Get this theme!
        </a>
    
</header>

<div id="mask" class="overlay"></div>

<aside class="sidebar" id="sidebar">
    <nav id="navigation">
      <h2>Menu</h2>
      <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>

    </nav>
</aside>

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search">
        <svg class="icon-remove-sign"><use xlink:href="#icon-close"></use></svg>
        <ul class="search-results search-list"></ul>
    </div>
</div>



        <section class="post two-columns">
            <article role="article" class="post-content">
                <p class="post-info">
                    
                        <svg class="icon-calendar" id="date"><use xlink:href="#icon-calendar"></use></svg>
                        <time class="date" datetime="2025-01-21T16:00:00+00:00">
                            


January 21, 2025

                        </time>
                    
                    <svg id="clock" class="icon-clock"><use xlink:href="#icon-clock"></use></svg>
                    <span>12 min to read</span>
                </p>
                <h1 class="post-title">GitLab CI/CD Template Guide</h1>
                <p class="post-subtitle">Optimizing Pipeline Implementation Using GitLab CI Templates</p>

                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1737534845/gitlab-ci-template_qh2zvi.png" alt="Featured image" class="post-cover">
                

                <!-- Pagination links -->



                <!-- Add your table of contents here -->


                <p><a href="https://medium.com/globant/optimize-pipeline-implementation-using-gitlab-ci-templates-6eef54046231">Image Reference link</a></p>

<p><br /></p>

<hr />

<h2 id="overview">Overview</h2>
<p>Learn how to optimize your GitLab CI implementation using templates. Templates help reduce code duplication and maintain consistent pipeline configurations across projects.</p>

<h3 id="using-gitlab-ci-templates">Using GitLab CI Templates</h3>

<h4 id="built-in-templates">Built-in Templates</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reference GitLab's built-in templates</span>
<span class="na">include</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">Terraform/Base.gitlab-ci.yml</span>
  <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">Jobs/SAST-IaC.gitlab-ci.yml</span>
</code></pre></div></div>

<h4 id="project-templates">Project Templates</h4>
<p>If the template is defined in your gitlab’s project, you can write it as follows.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reference templates from your project</span>
<span class="na">include</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">project</span><span class="pi">:</span> <span class="s1">'</span><span class="s">somaz94/server'</span>
    <span class="na">ref</span><span class="pi">:</span> <span class="s">master</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/template/my_template_file.yml'</span>
</code></pre></div></div>

<ul>
  <li>It is irrelevant to define it in <code class="language-plaintext highlighter-rouge">.gitlab-ci.yml</code> without reference.</li>
</ul>

<p><br /></p>

<hr />

<h3 id="-creating-custom-templates">🔧 Creating Custom Templates</h3>

<h4 id="build-template-example">Build Template Example</h4>

<p><br /></p>

<script src="https://gist.github.com/somaz94/c060ea29a0a16bc2adf8c7a16f9b59e8.js"></script>

<p><br /></p>

<h4 id="using-build-template">Using Build Template</h4>

<p>And it can be used as below.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">build_manual_image</span><span class="pi">:</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*common_job_config</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">build</span>
  <span class="na">image</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">gcr.io/kaniko-project/executor:v1.22.0-debug</span>
  <span class="na">before_script</span><span class="pi">:</span> <span class="nv">*common_build_before_script</span>
  <span class="na">script</span><span class="pi">:</span> <span class="nv">*common_build_script</span>
  <span class="na">artifacts</span><span class="pi">:</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">build_status.txt</span>
      <span class="pi">-</span> <span class="s">service_status.txt</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s1">'</span><span class="s">($CI_PIPELINE_SOURCE</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">"web")'</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">build-image</span>
</code></pre></div></div>

<p>And it can be used for other jobs.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">.change_files_game</span><span class="pi">:</span> <span class="nl">&amp;change_files_game</span>
  <span class="na">changes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">apps/game/src/**/*</span>

<span class="na">build_auto_image_game</span><span class="pi">:</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*common_job_config</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">build</span>
  <span class="na">image</span><span class="pi">:</span> 
    <span class="na">name</span><span class="pi">:</span> <span class="s">gcr.io/kaniko-project/executor:v1.22.0-debug</span>
  <span class="na">before_script</span><span class="pi">:</span> <span class="nv">*common_build_before_script</span>
  <span class="na">script</span><span class="pi">:</span> <span class="nv">*common_build_script</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">SERVICE</span><span class="pi">:</span> <span class="s">$GAME_SERVICE</span>
    <span class="na">IMAGE_URL</span><span class="pi">:</span> <span class="s">$IMAGE_URL_GAME</span>
    <span class="na">IMAGE_URL_LATEST</span><span class="pi">:</span> <span class="s">$IMAGE_URL_LATEST_GAME</span>
  <span class="na">artifacts</span><span class="pi">:</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">build_status.txt</span>
      <span class="pi">-</span> <span class="s">service_status.txt</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$CI_PIPELINE_SOURCE</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">"push"'</span>
      <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*change_files_game</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">build-image</span>
</code></pre></div></div>

<h3 id="slack-notification-template">Slack Notification Template</h3>

<p>The template for sending a message to SLACK can also be written as follows. You can receive the result as an artifact for each job and send a message.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">.common_update_after_script</span><span class="pi">:</span> <span class="nl">&amp;common_update_after_script</span>
    <span class="pi">-</span> <span class="pi">&gt;</span>
      <span class="s">if [ "$CI_JOB_STATUS" = "success" ]; then</span>
        <span class="s">echo "✅ success" &gt; /builds/somaz94/server/update_status.txt</span>
      <span class="s">elif [ "$CI_JOB_STATUS" = "failed" ]; then</span>
        <span class="s">echo "❌ failed" &gt; /builds/somaz94/server/update_status.txt</span>
      <span class="s">elif [ "$CI_JOB_STATUS" = "canceled" ]; then</span>
        <span class="s">echo "⚠️ canceled" &gt; /builds/somaz94/server/update_status.txt</span>
      <span class="s">else</span>
        <span class="s">echo "🔍 unknown" &gt; /builds/somaz94/server/update_status.txt</span>
 <span class="s">...</span>
 
 <span class="s">update_manual_image</span><span class="err">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">update</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">alpine:latest</span>
  <span class="na">interruptible</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">retry</span><span class="pi">:</span>
    <span class="na">max</span><span class="pi">:</span> <span class="m">2</span>  <span class="c1"># Maximum of 2 retries</span>
    <span class="na">when</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">runner_system_failure</span>
      <span class="pi">-</span> <span class="s">unknown_failure</span>
  <span class="na">before_script</span><span class="pi">:</span> <span class="nv">*common_update_before_script</span>
  <span class="na">script</span><span class="pi">:</span> <span class="nv">*common_update_script</span> 
  <span class="na">after_script</span><span class="pi">:</span> <span class="nv">*common_update_after_script</span>
  <span class="na">artifacts</span><span class="pi">:</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">update_status.txt</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s">$CI_PIPELINE_SOURCE == "web"</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">deploy-image</span>
  <span class="na">dependencies</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">build_manual_image</span>
</code></pre></div></div>

<p>I used the SLACK webhook, and I used the workflow builder to write so that I could only get the result value.
<img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1737527571/slack-workflow_ntq6bk.png" alt="HTTPS" width="600" /></p>

<h4 id="notification-script-template">Notification Script Template</h4>

<p>Create a Slack notify template.</p>

<p><br /></p>

<script src="https://gist.github.com/somaz94/fb0637156611b70025903ba721e0098b.js"></script>

<p><br /></p>

<h4 id="using-notification-template">Using Notification Template</h4>

<p>And write the yml file as below.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">notify_slack</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">notify</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">curlimages/curl:latest</span>
  <span class="na">script</span><span class="pi">:</span> <span class="nv">*common_notify_slack_script</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s">$CI_PIPELINE_SOURCE == "web"</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s">$CI_PIPELINE_SOURCE == "trigger"</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">deploy-image</span>
  <span class="na">when</span><span class="pi">:</span> <span class="s">always</span>

<span class="nn">...</span>
<span class="na">notify_slack_auto_game</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">notify</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">curlimages/curl:latest</span>
  <span class="na">script</span><span class="pi">:</span> <span class="nv">*common_notify_slack_script</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$CI_PIPELINE_SOURCE</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">"push"'</span>
      <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*change_files_game</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">deploy-image</span>
  <span class="na">when</span><span class="pi">:</span> <span class="s">always</span>
  <span class="na">dependencies</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">build_auto_image_game</span>
    <span class="pi">-</span> <span class="s">update_auto_image_game</span>
</code></pre></div></div>

<p>If used in this way, a template can be created and applied to various jobs as follows.
<img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1737528065/slack-notify_gbpr9o.png" alt="HTTPS" width="600" /></p>

<p><br /></p>

<hr />

<h3 id="more-template-examples">More Template Examples</h3>

<h4 id="docker-build-template-with-multiple-stages">Docker Build Template with Multiple Stages</h4>

<p>This template handles Docker builds with dedicated stages for building, testing, and pushing:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">.docker_build_template</span><span class="pi">:</span> <span class="nl">&amp;docker_build_template</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">docker:20.10.16</span>
  <span class="na">services</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">docker:20.10.16-dind</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">DOCKER_TLS_CERTDIR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/certs"</span>
    <span class="na">DOCKER_BUILDKIT</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">before_script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY</span>
    <span class="pi">-</span> <span class="s">export IMAGE_TAG=${CI_COMMIT_REF_SLUG}-${CI_COMMIT_SHORT_SHA}</span>
    <span class="pi">-</span> <span class="s">export FULL_IMAGE_NAME=$CI_REGISTRY_IMAGE:$IMAGE_TAG</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">echo "Building image $FULL_IMAGE_NAME"</span>
    <span class="pi">-</span> <span class="pi">&gt;</span>
      <span class="s">docker build </span>
      <span class="s">--build-arg BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ') </span>
      <span class="s">--build-arg VCS_REF=$CI_COMMIT_SHORT_SHA</span>
      <span class="s">--build-arg VERSION=$CI_COMMIT_REF_NAME</span>
      <span class="s">-t $FULL_IMAGE_NAME</span>
      <span class="s">-t $CI_REGISTRY_IMAGE:latest</span>
      <span class="s">.</span>
    <span class="pi">-</span> <span class="s">docker push $FULL_IMAGE_NAME</span>
    <span class="pi">-</span> <span class="s">docker push $CI_REGISTRY_IMAGE:latest</span>
</code></pre></div></div>

<h4 id="multi-environment-deployment-template">Multi-Environment Deployment Template</h4>

<p>Template for deploying to different environments based on conditions:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">.deploy_template</span><span class="pi">:</span> <span class="nl">&amp;deploy_template</span>
  <span class="na">image</span><span class="pi">:</span> 
    <span class="na">name</span><span class="pi">:</span> <span class="s">bitnami/kubectl:latest</span>
    <span class="na">entrypoint</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">]</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">GIT_STRATEGY</span><span class="pi">:</span> <span class="s">none</span>
  <span class="na">before_script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kubectl config use-context $KUBE_CONTEXT</span>
    <span class="pi">-</span> <span class="pi">|</span>
      <span class="s">if [[ -n "$NAMESPACE" ]]; then</span>
        <span class="s"># Ensure namespace exists</span>
        <span class="s">kubectl get namespace $NAMESPACE || kubectl create namespace $NAMESPACE</span>
      <span class="s">fi</span>

<span class="c1"># Development deployment</span>
<span class="na">.deploy_dev</span><span class="pi">:</span> <span class="nl">&amp;deploy_dev</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*deploy_template</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">NAMESPACE</span><span class="pi">:</span> <span class="s">development</span>
    <span class="na">REPLICAS</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">RESOURCES_REQUESTS_CPU</span><span class="pi">:</span> <span class="s">100m</span>
    <span class="na">RESOURCES_REQUESTS_MEMORY</span><span class="pi">:</span> <span class="s">128Mi</span>
    <span class="na">RESOURCES_LIMITS_CPU</span><span class="pi">:</span> <span class="s">200m</span>
    <span class="na">RESOURCES_LIMITS_MEMORY</span><span class="pi">:</span> <span class="s">256Mi</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">echo "Deploying to development environment"</span>
    <span class="pi">-</span> <span class="s">envsubst &lt; k8s/dev/deployment.yml | kubectl apply -f -</span>
    <span class="pi">-</span> <span class="s">kubectl rollout status deployment/$CI_PROJECT_NAME -n $NAMESPACE</span>
  <span class="na">environment</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">development</span>
    <span class="na">url</span><span class="pi">:</span> <span class="s">https://dev.example.com</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">develop</span>

<span class="c1"># Production deployment</span>
<span class="na">.deploy_prod</span><span class="pi">:</span> <span class="nl">&amp;deploy_prod</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*deploy_template</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">NAMESPACE</span><span class="pi">:</span> <span class="s">production</span>
    <span class="na">REPLICAS</span><span class="pi">:</span> <span class="m">3</span>
    <span class="na">RESOURCES_REQUESTS_CPU</span><span class="pi">:</span> <span class="s">200m</span>
    <span class="na">RESOURCES_REQUESTS_MEMORY</span><span class="pi">:</span> <span class="s">256Mi</span>
    <span class="na">RESOURCES_LIMITS_CPU</span><span class="pi">:</span> <span class="s">400m</span>
    <span class="na">RESOURCES_LIMITS_MEMORY</span><span class="pi">:</span> <span class="s">512Mi</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">echo "Deploying to production environment"</span>
    <span class="pi">-</span> <span class="s">envsubst &lt; k8s/prod/deployment.yml | kubectl apply -f -</span>
    <span class="pi">-</span> <span class="s">kubectl rollout status deployment/$CI_PROJECT_NAME -n $NAMESPACE</span>
  <span class="na">environment</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">production</span>
    <span class="na">url</span><span class="pi">:</span> <span class="s">https://example.com</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">main</span>
  <span class="na">when</span><span class="pi">:</span> <span class="s">manual</span>
</code></pre></div></div>

<h4 id="test-templates-for-different-languages">Test Templates for Different Languages</h4>

<p>Templates for running tests in different languages:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Node.js testing template</span>
<span class="na">.node_test_template</span><span class="pi">:</span> <span class="nl">&amp;node_test_template</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">node:16-alpine</span>
  <span class="na">cache</span><span class="pi">:</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">${CI_COMMIT_REF_SLUG}-node</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">node_modules/</span>
  <span class="na">before_script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">npm ci</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">npm run lint</span>
    <span class="pi">-</span> <span class="s">npm run test:ci</span>
  <span class="na">artifacts</span><span class="pi">:</span>
    <span class="na">reports</span><span class="pi">:</span>
      <span class="na">junit</span><span class="pi">:</span> <span class="s">junit-reports/*.xml</span>
      <span class="na">coverage_report</span><span class="pi">:</span>
        <span class="na">coverage_format</span><span class="pi">:</span> <span class="s">cobertura</span>
        <span class="na">path</span><span class="pi">:</span> <span class="s">coverage/cobertura-coverage.xml</span>

<span class="c1"># Python testing template</span>
<span class="na">.python_test_template</span><span class="pi">:</span> <span class="nl">&amp;python_test_template</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">python:3.9-slim</span>
  <span class="na">cache</span><span class="pi">:</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">${CI_COMMIT_REF_SLUG}-python</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">.pip-cache/</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">PIP_CACHE_DIR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">$CI_PROJECT_DIR/.pip-cache"</span>
    <span class="na">PYTHONPATH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">$CI_PROJECT_DIR"</span>
  <span class="na">before_script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">python -m pip install --upgrade pip</span>
    <span class="pi">-</span> <span class="s">pip install -r requirements.txt</span>
    <span class="pi">-</span> <span class="s">pip install pytest pytest-cov</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">python -m pytest --cov=./ --cov-report=xml --junitxml=junit.xml</span>
  <span class="na">artifacts</span><span class="pi">:</span>
    <span class="na">reports</span><span class="pi">:</span>
      <span class="na">junit</span><span class="pi">:</span> <span class="s">junit.xml</span>
      <span class="na">coverage_report</span><span class="pi">:</span>
        <span class="na">coverage_format</span><span class="pi">:</span> <span class="s">cobertura</span>
        <span class="na">path</span><span class="pi">:</span> <span class="s">coverage.xml</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="advanced-template-organization">Advanced Template Organization</h3>

<h4 id="splitting-templates-into-files">Splitting Templates into Files</h4>

<p>For larger projects, you can organize templates in separate files:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>project-root/
├── .gitlab-ci.yml
└── .gitlab/
    ├── ci/
    │   ├── templates/
    │   │   ├── build.yml
    │   │   ├── test.yml
    │   │   ├── deploy.yml
    │   │   └── notify.yml
    │   └── jobs/
    │       ├── frontend.yml
    │       └── backend.yml
</code></pre></div></div>

<p>Main <code class="language-plaintext highlighter-rouge">.gitlab-ci.yml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">include</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">.gitlab/ci/templates/build.yml'</span>
  <span class="pi">-</span> <span class="na">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">.gitlab/ci/templates/test.yml'</span>
  <span class="pi">-</span> <span class="na">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">.gitlab/ci/templates/deploy.yml'</span>
  <span class="pi">-</span> <span class="na">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">.gitlab/ci/templates/notify.yml'</span>
  <span class="pi">-</span> <span class="na">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">.gitlab/ci/jobs/frontend.yml'</span>
  <span class="pi">-</span> <span class="na">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">.gitlab/ci/jobs/backend.yml'</span>

<span class="na">stages</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">build</span>
  <span class="pi">-</span> <span class="s">test</span>
  <span class="pi">-</span> <span class="s">deploy</span>
  <span class="pi">-</span> <span class="s">notify</span>

<span class="na">variables</span><span class="pi">:</span>
  <span class="na">GLOBAL_VAR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">value"</span>
</code></pre></div></div>

<h4 id="creating-pipeline-template-library">Creating Pipeline Template Library</h4>

<p>For shared templates across multiple projects, create a dedicated template repository:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># In your template repository</span>
<span class="c1"># templates/docker-build.yml</span>
<span class="na">.docker_build</span><span class="pi">:</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">docker:latest</span>
  <span class="na">services</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">docker:dind</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">DOCKER_TLS_CERTDIR</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/certs"</span>
  <span class="na">before_script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG .</span>
    <span class="pi">-</span> <span class="s">docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG</span>
</code></pre></div></div>

<p>Usage in your project:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">include</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">project</span><span class="pi">:</span> <span class="s1">'</span><span class="s">your-group/gitlab-ci-templates'</span>
    <span class="na">ref</span><span class="pi">:</span> <span class="s">main</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/templates/docker-build.yml'</span>

<span class="na">build_image</span><span class="pi">:</span>
  <span class="na">extends</span><span class="pi">:</span> <span class="s">.docker_build</span>
  <span class="c1"># Add custom configuration here</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="generating-dynamic-templates">Generating Dynamic Templates</h3>

<h4 id="template-with-environment-variables">Template with Environment Variables</h4>

<p>Create templates with variables that can be substituted:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">.deploy_template</span><span class="pi">:</span> <span class="nl">&amp;deploy_template</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">echo "Deploying to ${ENVIRONMENT} environment"</span>
    <span class="pi">-</span> <span class="pi">|</span>
      <span class="s">cat &gt; kubernetes/${ENVIRONMENT}/kustomization.yaml &lt;&lt; EOF</span>
      <span class="s">apiVersion: kustomize.config.k8s.io/v1beta1</span>
      <span class="s">kind: Kustomization</span>
      <span class="s">namespace: ${NAMESPACE}</span>
      <span class="s">resources:</span>
        <span class="s">- deployment.yaml</span>
        <span class="s">- service.yaml</span>
      <span class="s">images:</span>
        <span class="s">- name: app-image</span>
          <span class="s">newName: ${CI_REGISTRY_IMAGE}</span>
          <span class="s">newTag: ${CI_COMMIT_SHORT_SHA}</span>
      <span class="s">EOF</span>
    <span class="pi">-</span> <span class="s">kubectl apply -k kubernetes/${ENVIRONMENT}/</span>
</code></pre></div></div>

<h4 id="matrix-jobs-with-templates">Matrix Jobs with Templates</h4>

<p>Use GitLab’s matrix feature to generate multiple jobs from a template:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">.test_template</span><span class="pi">:</span> <span class="nl">&amp;test_template</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">test</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">echo "Running tests for ${PYTHON_VERSION} on ${OS}"</span>
    <span class="pi">-</span> <span class="s">pip install -r requirements.txt</span>
    <span class="pi">-</span> <span class="s">pytest</span>

<span class="na">python-tests</span><span class="pi">:</span>
  <span class="na">parallel</span><span class="pi">:</span>
    <span class="na">matrix</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">PYTHON_VERSION</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">3.8"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">3.9"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">3.10"</span><span class="pi">]</span>
        <span class="na">OS</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">linux"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">windows"</span><span class="pi">]</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">python:${PYTHON_VERSION}-${OS}</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*test_template</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="template-best-practices">Template Best Practices</h2>

<div class="info-box info-box-success">
<br />
<strong>Template Design Principles:</strong><br /><br />

<strong>1. Reusability:</strong>
   - Make templates generic enough to be used in different contexts<br />
   - Use variables for customizable parts<br />
   - Document required variables and their formats<br />
   - Avoid hardcoding project-specific values<br /><br />

<strong>2. Maintainability:</strong>
   - Keep templates focused on specific responsibilities<br />
   - Add comments to explain complex logic<br />
   - Version templates with semantic versioning<br />
   - Use descriptive names for templates and anchors<br /><br />

<strong>3. Performance:</strong>
   - Keep templates lightweight<br />
   - Use caching where appropriate<br />
   - Consider pipeline execution time when designing templates<br />
   - Avoid unnecessary logic or commands<br /><br />

<strong>4. Fault Tolerance:</strong>
   - Include proper error handling<br />
   - Add retry mechanisms for network-dependent operations<br />
   - Provide informative error messages<br />
   - Validate inputs and prerequisites<br /><br />
</div>

<p><br /></p>

<h3 id="troubleshooting-templates">Troubleshooting Templates</h3>

<div class="info-box info-box-warning">
<br />
<strong>Common Template Issues:</strong><br /><br />

<strong>1. Reference Errors:</strong>
   - Verify anchor names match their references<br />
   - Check for typos in variable names<br />
   - Ensure templates are included before they're referenced<br />
   - Look for YAML indentation issues<br /><br />

<strong>2. Variable Scope Problems:</strong>
   - Remember that job-level variables override global ones<br />
   - Use YAML anchors to share variable definitions<br />
   - Consider how variables interact with included templates<br />
   - Watch for CI_* variable name collisions<br /><br />

<strong>3. Include Issues:</strong>
   - Verify project paths and file names in includes<br />
   - Check access permissions for included projects<br />
   - Ensure referenced branches or tags exist<br />
   - Look for circular includes<br /><br />
</div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Debug job for CI variables</span>
<span class="na">debug_variables</span><span class="pi">:</span>
  <span class="na">stage</span><span class="pi">:</span> <span class="s">.pre</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">alpine:latest</span>
  <span class="na">script</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">echo "== CI Variables =="</span>
    <span class="pi">-</span> <span class="s">env | grep "^CI_" | sort</span>
    <span class="pi">-</span> <span class="s">echo "== Custom Variables =="</span>
    <span class="pi">-</span> <span class="s">env | grep -v "^CI_" | sort</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">if</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$CI_PIPELINE_SOURCE</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">"web"'</span>
      <span class="na">when</span><span class="pi">:</span> <span class="s">manual</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">linux</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="reference">Reference</h2>
<ul>
  <li><a href="https://icinga.com/blog/2022/10/05/gitlab-ci-cd-job-templates/">GitLab CI/CD Job Templates</a></li>
  <li><a href="https://about.gitlab.com/blog/2020/09/23/get-started-ci-pipeline-templates/">Getting Started with CI Pipeline Templates</a></li>
</ul>


                <!-- Pagination links -->


            </article>

            
                <aside class="see-also">
                    <h2>See also</h2>
                    <ul>
                        
                        
                        
                            <li>
                                <a href="/category/openstack/openstack-mistral/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1742267532/openstack_t2tmoc.png">
                                    
                                    <h3>Deep Dive into OpenStack Mistral</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/cicd/argocd-notifications-slack/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1737365011/argocd_x79gn0.png">
                                    
                                    <h3>Setting up ArgoCD Notifications with Slack</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/openstack/openstack-ceilometer/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1742267532/openstack_t2tmoc.png">
                                    
                                    <h3>Deep Dive into OpenStack Ceilometer</h3>
                                </a>
                            </li>
                        
                    </ul>
                </aside>
            

        </section>

        <!-- Add time bar only for pages without pagination -->
        
            <div class="time-bar" data-minutes="12">
    <span class="time-completed"></span>
    <span class="time-remaining"></span>
    <div class="bar">
        <span class="completed" style="width:0%;"></span>
        <span class="remaining" style="width:100%;"></span>
    </div>
</div>

            <button class="toggle-preview" onclick="togglePreview()">
    <span>Hide Preview ▼</span>
</button>

<div id="recommendationSection" class="recommendation">
    <div class="message">
        <strong>Why don't you read something next?</strong>
        <div>
            <button>
                <svg><use xlink:href="#icon-arrow-right"></use></svg>
                <span>Go back to top</span>
            </button>
        </div>
    </div>
    <div id="previewSection" class="preview-section">
        
        <a href="/category/cicd/gitlab-cicd-template/" class="post-preview">
            <div class="image">
                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1737534845/gitlab-ci-template_qh2zvi.png">
                
            </div>
            <h3 class="title">GitLab CI/CD Template Guide</h3>
        </a>
    </div>
</div>

<style>
.toggle-preview {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #333;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.toggle-preview:hover {
    background: #444;
}

.toggle-preview.visible {
    opacity: 1;
}

.recommendation {
    margin-top: 1000px;
    display: block;
    transition: all 0.3s ease;
}

.recommendation.hidden {
    display: none;
}

.hide-preview {
    margin-left: 10px;
    background: none;
    border: 1px solid #666;
    color: #666;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}

.hide-preview:hover {
    background: #f0f0f0;
}

.preview-section {
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.preview-section.hidden {
    max-height: 0;
}
</style>

<script>
function togglePreview() {
    const recommendation = document.getElementById('recommendationSection');
    const button = document.querySelector('.toggle-preview span');
    
    if (recommendation.classList.contains('hidden')) {
        recommendation.classList.remove('hidden');
        button.textContent = 'Hide Preview ▼';
    } else {
        recommendation.classList.add('hidden');
        button.textContent = 'Show Preview ▲';
    }
}

window.addEventListener('scroll', function() {
    const toggleButton = document.querySelector('.toggle-preview');
    const recommendation = document.getElementById('recommendationSection');
    const rect = recommendation.getBoundingClientRect();
    
    if (rect.top <= window.innerHeight) {
        toggleButton.classList.add('visible');
    } else {
        toggleButton.classList.remove('visible');
    }
});
</script>

        

        <!-- Show modal if the post is the last one -->
        

        <!-- Show modal before user leaves the page -->
        

        <!-- Add your newsletter subscription form here -->

        <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;Learn how to use and create GitLab CI/CD templates for efficient pipeline management&quot;%20https://somaz.blog/category/cicd/gitlab-cicd-template-new/%20via%20&#64;twitter_username&hashtags=gitlab,cicd,template,automation"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://somaz.blog/category/cicd/gitlab-cicd-template-new/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
</section>

        

  <section class="author">
    <div class="details">
      
        <img class="img-rounded" src="/assets/img/uploads/profile.png" alt="Somaz">
      
      <p class="def">Author</p>
      <h3 class="name">
        <a href="/authors/somaz/">Somaz</a>
      </h3>
      <p class="desc">DevOps engineer focused on cloud infrastructure and automation</p>
      <p>
        
          <a href="https://github.com/somaz94" title="Github">
            <svg><use xlink:href="#icon-github"></use></svg>
          </a>
        
        
        
        
        
        
          <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
            <svg><use xlink:href="#icon-linkedin"></use></svg>
          </a>
        
        
          <a href="https://somaz.tistory.com" title="Tistory">
            <svg><use xlink:href="#icon-tistory"></use></svg>
          </a>
        
      </p>
    </div>
  </section>

  
  
  
  
  
  
  
  

  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Somaz",
      
      "image": "/assets/img/uploads/profile.png",
      
      "jobTitle": "DevOps Engineer",
      "url": "https://somaz.blog/authors/somaz/",
      "sameAs": [
        "https://github.com/somaz94","https://www.linkedin.com/in/somaz","https://{{ author.tistory_username }}.tistory.com"
      ]
  }
  </script>


        

<section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = 'https-somaz94-github-io';
        var disqus_title = '';
        var disqus_url = '/category/cicd/gitlab-cicd-template-new/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>



        <footer>
    <p>
      
        <a href="https://github.com/somaz94" title="Github">
          <svg><use xlink:href="#icon-github"></use></svg>
        </a>
      
      
        <a href="https://www.facebook.com/facebook_username" title="Facebook">
          <svg><use xlink:href="#icon-facebook"></use></svg>
        </a>
      
      
        <a href="https://twitter.com/twitter_username" title="Twitter">
          <svg><use xlink:href="#icon-twitter"></use></svg>
        </a>
      
      
        <a href="https://medium.com/@medium_username" title="Medium">
          <svg><use xlink:href="#icon-medium"></use></svg>
        </a>
      
      
        <a href="https://www.instagram.com/instagram_username" title="Instagram">
          <svg><use xlink:href="#icon-instagram"></use></svg>
        </a>
      
      
        <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
          <svg><use xlink:href="#icon-linkedin"></use></svg>
        </a>
      
      
        <a href="https://somaz.tistory.com" title="Tistory">
          <svg><use xlink:href="#icon-tistory"></use></svg>
        </a>
      
    </p>

    <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>


    <p>
      <a href="https://somaz.blog/sitemap.xml" title="sitemap">Sitemap</a> |
      <a href="https://somaz.blog/privacy-policy.html" title="Privacy Policy">Privacy Policy</a>
    </p>

    <p>
      <span>Somaz Tech Blog</span> <svg class="love"><use xlink:href="#icon-heart"></use></svg>
    </p>
</footer>










<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "somaz",
  "description": "DevOps engineer's tech blog.",
  "url": "https://somaz.blog/",
  "logo": {
      "@type": "ImageObject",
      "url": "https://somaz.blog/assets/img/icons/mediumtile.png",
      "width": "600",
      "height": "315"
  },
  "sameAs": [
    "https://github.com/somaz94","https://www.facebook.com/facebook_username","https://twitter.com/twitter_username","https://medium.com/@medium_username","https://www.instagram.com/instagram_username","https://www.linkedin.com/in/somaz","https://{{ site.tistory_username }}.tistory.com"
  ]
}
</script>

<!-- Include the script that allows Netlify CMS login -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<!-- Include the website scripts -->
<script src="/assets/js/scripts.min.js"></script>

<!-- Include Google Analytics script -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
<script>
  var host = window.location.hostname;
  if (host != 'localhost') {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXX-X');
  }
</script>
  


<!-- Include extra scripts -->



        

        
        
        
        
        
        
        
        
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "name": "GitLab CI/CD Template Guide",
            "headline": "Optimizing Pipeline Implementation Using GitLab CI Templates",
            "description": "Learn how to use and create GitLab CI/CD templates for efficient pipeline management",
            "image": "https://res.cloudinary.com/dkcm26aem/image/upload/v1737534845/gitlab-ci-template_qh2zvi.png",
            "url": "https://somaz.blog/category/cicd/gitlab-cicd-template-new/",
            "articleBody": "Image Reference link





Overview
Learn how to optimize your GitLab CI implementation using templates. Templates help reduce code duplication and maintain consistent pipeline configurations across projects.

Using GitLab CI Templates

Built-in Templates

# Reference GitLab&apos;s built-in templates
include:
  - template: Terraform/Base.gitlab-ci.yml
  - template: Jobs/SAST-IaC.gitlab-ci.yml


Project Templates
If the template is defined in your gitlab’s project, you can write it as follows.

# Reference templates from your project
include:
  - project: &apos;somaz94/server&apos;
    ref: master
    file: &apos;/template/my_template_file.yml&apos;



  It is irrelevant to define it in .gitlab-ci.yml without reference.






🔧 Creating Custom Templates

Build Template Example







Using Build Template

And it can be used as below.

build_manual_image:
  &amp;lt;&amp;lt;: *common_job_config
  stage: build
  image:
    name: gcr.io/kaniko-project/executor:v1.22.0-debug
  before_script: *common_build_before_script
  script: *common_build_script
  artifacts:
    paths:
      - build_status.txt
      - service_status.txt
  rules:
    - if: &apos;($CI_PIPELINE_SOURCE == &quot;web&quot;)&apos;
  tags:
    - build-image


And it can be used for other jobs.

.change_files_game: &amp;amp;change_files_game
  changes:
    - apps/game/src/**/*

build_auto_image_game:
  &amp;lt;&amp;lt;: *common_job_config
  stage: build
  image: 
    name: gcr.io/kaniko-project/executor:v1.22.0-debug
  before_script: *common_build_before_script
  script: *common_build_script
  variables:
    SERVICE: $GAME_SERVICE
    IMAGE_URL: $IMAGE_URL_GAME
    IMAGE_URL_LATEST: $IMAGE_URL_LATEST_GAME
  artifacts:
    paths:
      - build_status.txt
      - service_status.txt
  rules:
    - if: &apos;$CI_PIPELINE_SOURCE == &quot;push&quot;&apos;
      &amp;lt;&amp;lt;: *change_files_game
  tags:
    - build-image


Slack Notification Template

The template for sending a message to SLACK can also be written as follows. You can receive the result as an artifact for each job and send a message.

  .common_update_after_script: &amp;amp;common_update_after_script
    - &amp;gt;
      if [ &quot;$CI_JOB_STATUS&quot; = &quot;success&quot; ]; then
        echo &quot;✅ success&quot; &amp;gt; /builds/somaz94/server/update_status.txt
      elif [ &quot;$CI_JOB_STATUS&quot; = &quot;failed&quot; ]; then
        echo &quot;❌ failed&quot; &amp;gt; /builds/somaz94/server/update_status.txt
      elif [ &quot;$CI_JOB_STATUS&quot; = &quot;canceled&quot; ]; then
        echo &quot;⚠️ canceled&quot; &amp;gt; /builds/somaz94/server/update_status.txt
      else
        echo &quot;🔍 unknown&quot; &amp;gt; /builds/somaz94/server/update_status.txt
 ...
 
 update_manual_image:
  stage: update
  image: alpine:latest
  interruptible: true
  retry:
    max: 2  # Maximum of 2 retries
    when:
      - runner_system_failure
      - unknown_failure
  before_script: *common_update_before_script
  script: *common_update_script 
  after_script: *common_update_after_script
  artifacts:
    paths:
      - update_status.txt
  rules:
    - if: $CI_PIPELINE_SOURCE == &quot;web&quot;
  tags:
    - deploy-image
  dependencies:
    - build_manual_image


I used the SLACK webhook, and I used the workflow builder to write so that I could only get the result value.


Notification Script Template

Create a Slack notify template.







Using Notification Template

And write the yml file as below.

notify_slack:
  stage: notify
  image: curlimages/curl:latest
  script: *common_notify_slack_script
  rules:
    - if: $CI_PIPELINE_SOURCE == &quot;web&quot;
    - if: $CI_PIPELINE_SOURCE == &quot;trigger&quot;
  tags:
    - deploy-image
  when: always

...
notify_slack_auto_game:
  stage: notify
  image: curlimages/curl:latest
  script: *common_notify_slack_script
  rules:
    - if: &apos;$CI_PIPELINE_SOURCE == &quot;push&quot;&apos;
      &amp;lt;&amp;lt;: *change_files_game
  tags:
    - deploy-image
  when: always
  dependencies:
    - build_auto_image_game
    - update_auto_image_game


If used in this way, a template can be created and applied to various jobs as follows.






More Template Examples

Docker Build Template with Multiple Stages

This template handles Docker builds with dedicated stages for building, testing, and pushing:

.docker_build_template: &amp;amp;docker_build_template
  image: docker:20.10.16
  services:
    - docker:20.10.16-dind
  variables:
    DOCKER_TLS_CERTDIR: &quot;/certs&quot;
    DOCKER_BUILDKIT: 1
  before_script:
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
    - export IMAGE_TAG=${CI_COMMIT_REF_SLUG}-${CI_COMMIT_SHORT_SHA}
    - export FULL_IMAGE_NAME=$CI_REGISTRY_IMAGE:$IMAGE_TAG
  script:
    - echo &quot;Building image $FULL_IMAGE_NAME&quot;
    - &amp;gt;
      docker build 
      --build-arg BUILD_DATE=$(date -u +&apos;%Y-%m-%dT%H:%M:%SZ&apos;) 
      --build-arg VCS_REF=$CI_COMMIT_SHORT_SHA
      --build-arg VERSION=$CI_COMMIT_REF_NAME
      -t $FULL_IMAGE_NAME
      -t $CI_REGISTRY_IMAGE:latest
      .
    - docker push $FULL_IMAGE_NAME
    - docker push $CI_REGISTRY_IMAGE:latest


Multi-Environment Deployment Template

Template for deploying to different environments based on conditions:

.deploy_template: &amp;amp;deploy_template
  image: 
    name: bitnami/kubectl:latest
    entrypoint: [&quot;&quot;]
  variables:
    GIT_STRATEGY: none
  before_script:
    - kubectl config use-context $KUBE_CONTEXT
    - |
      if [[ -n &quot;$NAMESPACE&quot; ]]; then
        # Ensure namespace exists
        kubectl get namespace $NAMESPACE || kubectl create namespace $NAMESPACE
      fi

# Development deployment
.deploy_dev: &amp;amp;deploy_dev
  &amp;lt;&amp;lt;: *deploy_template
  variables:
    NAMESPACE: development
    REPLICAS: 1
    RESOURCES_REQUESTS_CPU: 100m
    RESOURCES_REQUESTS_MEMORY: 128Mi
    RESOURCES_LIMITS_CPU: 200m
    RESOURCES_LIMITS_MEMORY: 256Mi
  script:
    - echo &quot;Deploying to development environment&quot;
    - envsubst &amp;lt; k8s/dev/deployment.yml | kubectl apply -f -
    - kubectl rollout status deployment/$CI_PROJECT_NAME -n $NAMESPACE
  environment:
    name: development
    url: https://dev.example.com
  only:
    - develop

# Production deployment
.deploy_prod: &amp;amp;deploy_prod
  &amp;lt;&amp;lt;: *deploy_template
  variables:
    NAMESPACE: production
    REPLICAS: 3
    RESOURCES_REQUESTS_CPU: 200m
    RESOURCES_REQUESTS_MEMORY: 256Mi
    RESOURCES_LIMITS_CPU: 400m
    RESOURCES_LIMITS_MEMORY: 512Mi
  script:
    - echo &quot;Deploying to production environment&quot;
    - envsubst &amp;lt; k8s/prod/deployment.yml | kubectl apply -f -
    - kubectl rollout status deployment/$CI_PROJECT_NAME -n $NAMESPACE
  environment:
    name: production
    url: https://example.com
  only:
    - main
  when: manual


Test Templates for Different Languages

Templates for running tests in different languages:

# Node.js testing template
.node_test_template: &amp;amp;node_test_template
  image: node:16-alpine
  cache:
    key: ${CI_COMMIT_REF_SLUG}-node
    paths:
      - node_modules/
  before_script:
    - npm ci
  script:
    - npm run lint
    - npm run test:ci
  artifacts:
    reports:
      junit: junit-reports/*.xml
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml

# Python testing template
.python_test_template: &amp;amp;python_test_template
  image: python:3.9-slim
  cache:
    key: ${CI_COMMIT_REF_SLUG}-python
    paths:
      - .pip-cache/
  variables:
    PIP_CACHE_DIR: &quot;$CI_PROJECT_DIR/.pip-cache&quot;
    PYTHONPATH: &quot;$CI_PROJECT_DIR&quot;
  before_script:
    - python -m pip install --upgrade pip
    - pip install -r requirements.txt
    - pip install pytest pytest-cov
  script:
    - python -m pytest --cov=./ --cov-report=xml --junitxml=junit.xml
  artifacts:
    reports:
      junit: junit.xml
      coverage_report:
        coverage_format: cobertura
        path: coverage.xml




Advanced Template Organization

Splitting Templates into Files

For larger projects, you can organize templates in separate files:

project-root/
├── .gitlab-ci.yml
└── .gitlab/
    ├── ci/
    │   ├── templates/
    │   │   ├── build.yml
    │   │   ├── test.yml
    │   │   ├── deploy.yml
    │   │   └── notify.yml
    │   └── jobs/
    │       ├── frontend.yml
    │       └── backend.yml


Main .gitlab-ci.yml:

include:
  - local: &apos;.gitlab/ci/templates/build.yml&apos;
  - local: &apos;.gitlab/ci/templates/test.yml&apos;
  - local: &apos;.gitlab/ci/templates/deploy.yml&apos;
  - local: &apos;.gitlab/ci/templates/notify.yml&apos;
  - local: &apos;.gitlab/ci/jobs/frontend.yml&apos;
  - local: &apos;.gitlab/ci/jobs/backend.yml&apos;

stages:
  - build
  - test
  - deploy
  - notify

variables:
  GLOBAL_VAR: &quot;value&quot;


Creating Pipeline Template Library

For shared templates across multiple projects, create a dedicated template repository:

# In your template repository
# templates/docker-build.yml
.docker_build:
  image: docker:latest
  services:
    - docker:dind
  variables:
    DOCKER_TLS_CERTDIR: &quot;/certs&quot;
  before_script:
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
  script:
    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG .
    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG


Usage in your project:

include:
  - project: &apos;your-group/gitlab-ci-templates&apos;
    ref: main
    file: &apos;/templates/docker-build.yml&apos;

build_image:
  extends: .docker_build
  # Add custom configuration here




Generating Dynamic Templates

Template with Environment Variables

Create templates with variables that can be substituted:

.deploy_template: &amp;amp;deploy_template
  script:
    - echo &quot;Deploying to ${ENVIRONMENT} environment&quot;
    - |
      cat &amp;gt; kubernetes/${ENVIRONMENT}/kustomization.yaml &amp;lt;&amp;lt; EOF
      apiVersion: kustomize.config.k8s.io/v1beta1
      kind: Kustomization
      namespace: ${NAMESPACE}
      resources:
        - deployment.yaml
        - service.yaml
      images:
        - name: app-image
          newName: ${CI_REGISTRY_IMAGE}
          newTag: ${CI_COMMIT_SHORT_SHA}
      EOF
    - kubectl apply -k kubernetes/${ENVIRONMENT}/


Matrix Jobs with Templates

Use GitLab’s matrix feature to generate multiple jobs from a template:

.test_template: &amp;amp;test_template
  stage: test
  script:
    - echo &quot;Running tests for ${PYTHON_VERSION} on ${OS}&quot;
    - pip install -r requirements.txt
    - pytest

python-tests:
  parallel:
    matrix:
      - PYTHON_VERSION: [&quot;3.8&quot;, &quot;3.9&quot;, &quot;3.10&quot;]
        OS: [&quot;linux&quot;, &quot;windows&quot;]
  image: python:${PYTHON_VERSION}-${OS}
  &amp;lt;&amp;lt;: *test_template




Template Best Practices



Template Design Principles:

1. Reusability:
   - Make templates generic enough to be used in different contexts
   - Use variables for customizable parts
   - Document required variables and their formats
   - Avoid hardcoding project-specific values

2. Maintainability:
   - Keep templates focused on specific responsibilities
   - Add comments to explain complex logic
   - Version templates with semantic versioning
   - Use descriptive names for templates and anchors

3. Performance:
   - Keep templates lightweight
   - Use caching where appropriate
   - Consider pipeline execution time when designing templates
   - Avoid unnecessary logic or commands

4. Fault Tolerance:
   - Include proper error handling
   - Add retry mechanisms for network-dependent operations
   - Provide informative error messages
   - Validate inputs and prerequisites




Troubleshooting Templates



Common Template Issues:

1. Reference Errors:
   - Verify anchor names match their references
   - Check for typos in variable names
   - Ensure templates are included before they&apos;re referenced
   - Look for YAML indentation issues

2. Variable Scope Problems:
   - Remember that job-level variables override global ones
   - Use YAML anchors to share variable definitions
   - Consider how variables interact with included templates
   - Watch for CI_* variable name collisions

3. Include Issues:
   - Verify project paths and file names in includes
   - Check access permissions for included projects
   - Ensure referenced branches or tags exist
   - Look for circular includes


# Debug job for CI variables
debug_variables:
  stage: .pre
  image: alpine:latest
  script:
    - echo &quot;== CI Variables ==&quot;
    - env | grep &quot;^CI_&quot; | sort
    - echo &quot;== Custom Variables ==&quot;
    - env | grep -v &quot;^CI_&quot; | sort
  rules:
    - if: &apos;$CI_PIPELINE_SOURCE == &quot;web&quot;&apos;
      when: manual
  tags:
    - linux






Reference

  GitLab CI/CD Job Templates
  Getting Started with CI Pipeline Templates

",
            "wordcount": "2228",
            "inLanguage": "en",
            "dateCreated": "2025-01-21/",
            "datePublished": "2025-01-21/",
            "dateModified": "2025-01-21/",
            "author": {
                "@type": "Person",
                "name": "Somaz",
                
                "image": "/assets/img/uploads/profile.png",
                
                "jobTitle": "DevOps Engineer",
                "url": "https://somaz.blog/authors/somaz/",
                "sameAs": [
                    "https://github.com/somaz94","https://www.linkedin.com/in/somaz"
                ]
            },
            "publisher": {
                "@type": "Organization",
                "name": "somaz",
                "url": "https://somaz.blog/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://somaz.blog/assets/img/blog-image.png",
                    "width": "600",
                    "height": "315"
                }
            },
            "mainEntityOfPage": "True",
            "genre": "CICD",
            "articleSection": "CICD",
            "keywords": ["gitlab","cicd","template","automation"]
        }
        </script>
    </body>
</html>
