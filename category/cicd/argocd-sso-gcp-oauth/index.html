<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    
    

    
    

    
    

    <!-- ✅ Google Tag Manager 추가 -->
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MBP83N4Q');
    </script>
      <!-- ✅ End Google Tag Manager -->

    <!-- Mermaid.js 직접 로드 -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>

    <title>Setting up ArgoCD SSO with GCP OAuth | somaz</title>
    <meta name="description" content="Learn how to set up and manage ArgoCD SSO with GCP OAuth">
    
        <meta name="keywords" content="github, kubernetes, helm, cicd">
    

    <!-- Social: Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Setting up ArgoCD SSO with GCP OAuth | somaz">
    <meta name="twitter:description" content="Learn how to set up and manage ArgoCD SSO with GCP OAuth">

    
        <meta property="twitter:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1739942456/argocd-sso-google-oauth_ssoqyf.png">
    
    
    
        <meta name="twitter:site" content="@twitter_username">
    

    <!-- Social: Facebook / Open Graph -->
    <meta property="og:url" content="https://somaz.blog/category/cicd/argocd-sso-gcp-oauth/">
    <meta property="og:title" content="Setting up ArgoCD SSO with GCP OAuth | somaz">
    <meta property="og:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1739942456/argocd-sso-google-oauth_ssoqyf.png">
    <meta property="og:description" content="Learn how to set up and manage ArgoCD SSO with GCP OAuth">
    <meta property="og:site_name" content="Somaz Tech Blog">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/img/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png" />

    <!-- Windows 8 Tile Icons -->
    <meta name="application-name" content="somaz">
    <meta name="msapplication-TileColor" content="#141414">
    <meta name="msapplication-square70x70logo" content="smalltile.png" />
    <meta name="msapplication-square150x150logo" content="mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="widetile.png" />
    <meta name="msapplication-square310x310logo" content="largetile.png" />
    
    <!-- Android Lolipop Theme Color -->
    <meta name="theme-color" content="#141414">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="canonical" href="https://somaz.blog/category/cicd/argocd-sso-gcp-oauth/">
    <link rel="alternate" type="application/rss+xml" title="Somaz Tech Blog" href="https://somaz.blog/feed.xml" />

    <!-- Include extra styles -->
    

    <!-- JavaScript enabled/disabled -->
    <script>
        document.querySelector('html').classList.remove('no-js');
    </script>

    <!-- Google Adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8725590811736154"
        crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"> -->
    <!-- <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/variable/woff2/SUIT-Variable.css" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;700&display=swap" rel="stylesheet"> -->

    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />

</head>
<!-- ✅ Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBP83N4Q"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- ✅ End Google Tag Manager (noscript) -->
    <body class="has-push-menu">
        





        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-close" viewBox="0 0 1000 1000"><path d="M969.8,870.3c27,27.7,27,71.8,0,99.1C955.7,983,937.9,990,920,990c-17.9,0-35.7-7-49.7-20.7L500,599L129.6,969.4C115.6,983,97.8,990,79.9,990s-35.7-7-49.7-20.7c-27-27.3-27-71.4,0-99.1L400.9,500L30.3,129.3c-27-27.3-27-71.4,0-99.1c27.3-27,71.8-27,99.4,0L500,400.9L870.4,30.2c27.7-27,71.8-27,99.4,0c27,27.7,27,71.8,0,99.1L599.1,500L969.8,870.3z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-clock" viewBox="0 0 1000 1000"><path d="M500,10C229.8,10,10,229.8,10,500c0,270.2,219.8,490,490,490c270.2,0,490-219.8,490-490C990,229.8,770.2,10,500,10z M500,910.2c-226.2,0-410.2-184-410.2-410.2c0-226.2,184-410.2,410.2-410.2c226.2,0,410.2,184,410.2,410.2C910.2,726.1,726.2,910.2,500,910.2z M753.1,374c8.2,11.9,5.2,28.1-6.6,36.3L509.9,573.7c-4.4,3.1-9.6,4.6-14.8,4.6c-4.1,0-8.3-1-12.1-3c-8.6-4.5-14-13.4-14-23.1V202.5c0-14.4,11.7-26.1,26.1-26.1c14.4,0,26.1,11.7,26.1,26.1v300l195.6-135.1C728.7,359.2,744.9,362.1,753.1,374z"/></symbol><symbol id="icon-calendar" viewBox="0 0 1000 1000"><path d="M920,500v420H80V500H920 M990,430H10v490c0,38.7,31.3,70,70,70h840c38.7,0,70-31.3,70-70V430L990,430z"/><path d="M850,80v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80H360v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80C72.8,80,10,142.7,10,220v140h980V220C990,142.7,927.2,80,850,80z"/><path d="M255,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C290,25.8,274.3,10,255,10z"/><path d="M745,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C780,25.8,764.3,10,745,10z"/></symbol><symbol id="icon-github" viewBox="0 0 12 14"><path d="M6 1q1.633 0 3.012 0.805t2.184 2.184 0.805 3.012q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.312-0.055t-0.102-0.234q0-0.023 0.004-0.598t0.004-1.051q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.93-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.664-0.105q-0.352 0.883-0.062 1.594-0.617 0.68-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.305 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.691t0.004 0.426q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805zM2.273 9.617q0.023-0.055-0.055-0.094-0.078-0.023-0.102 0.016-0.023 0.055 0.055 0.094 0.070 0.047 0.102-0.016zM2.516 9.883q0.055-0.039-0.016-0.125-0.078-0.070-0.125-0.023-0.055 0.039 0.016 0.125 0.078 0.078 0.125 0.023zM2.75 10.234q0.070-0.055 0-0.148-0.062-0.102-0.133-0.047-0.070 0.039 0 0.141t0.133 0.055zM3.078 10.562q0.062-0.062-0.031-0.148-0.094-0.094-0.156-0.023-0.070 0.062 0.031 0.148 0.094 0.094 0.156 0.023zM3.523 10.758q0.023-0.086-0.102-0.125-0.117-0.031-0.148 0.055t0.102 0.117q0.117 0.047 0.148-0.047zM4.016 10.797q0-0.102-0.133-0.086-0.125 0-0.125 0.086 0 0.102 0.133 0.086 0.125 0 0.125-0.086zM4.469 10.719q-0.016-0.086-0.141-0.070-0.125 0.023-0.109 0.117t0.141 0.062 0.109-0.109z"></path></symbol><symbol id="icon-medium" viewBox="0 0 1000 1000"><path d="M336.5,240.2v641.5c0,9.1-2.3,16.9-6.8,23.2s-11.2,9.6-20,9.6c-6.2,0-12.2-1.5-18-4.4L37.3,782.7c-7.7-3.6-14.1-9.8-19.4-18.3S10,747.4,10,739V115.5c0-7.3,1.8-13.5,5.5-18.6c3.6-5.1,8.9-7.7,15.9-7.7c5.1,0,13.1,2.7,24.1,8.2l279.5,140C335.9,238.6,336.5,239.5,336.5,240.2L336.5,240.2z M371.5,295.5l292,473.6l-292-145.5V295.5z M990,305.3v576.4c0,9.1-2.6,16.5-7.7,22.1c-5.1,5.7-12,8.5-20.8,8.5s-17.3-2.4-25.7-7.1L694.7,784.9L990,305.3z M988.4,239.7c0,1.1-46.8,77.6-140.3,229.4C754.6,621,699.8,709.8,683.8,735.7L470.5,389l177.2-288.2c6.2-10.2,15.7-15.3,28.4-15.3c5.1,0,9.8,1.1,14.2,3.3l295.9,147.7C987.6,237.1,988.4,238.2,988.4,239.7L988.4,239.7z"/></symbol><symbol id="icon-instagram" viewBox="0 0 489.84 489.84"><path d="M249.62,50.46c65.4,0,73.14.25,99,1.43C372.47,53,385.44,57,394.07,60.32a75.88,75.88,0,0,1,28.16,18.32,75.88,75.88,0,0,1,18.32,28.16c3.35,8.63,7.34,21.6,8.43,45.48,1.18,25.83,1.43,33.57,1.43,99s-0.25,73.14-1.43,99c-1.09,23.88-5.08,36.85-8.43,45.48a81.11,81.11,0,0,1-46.48,46.48c-8.63,3.35-21.6,7.34-45.48,8.43-25.82,1.18-33.57,1.43-99,1.43s-73.15-.25-99-1.43c-23.88-1.09-36.85-5.08-45.48-8.43A75.88,75.88,0,0,1,77,423.86,75.88,75.88,0,0,1,58.69,395.7c-3.35-8.63-7.34-21.6-8.43-45.48-1.18-25.83-1.43-33.57-1.43-99s0.25-73.14,1.43-99c1.09-23.88,5.08-36.85,8.43-45.48A75.88,75.88,0,0,1,77,78.64a75.88,75.88,0,0,1,28.16-18.32c8.63-3.35,21.6-7.34,45.48-8.43,25.83-1.18,33.57-1.43,99-1.43m0-44.13c-66.52,0-74.86.28-101,1.47s-43.87,5.33-59.45,11.38A120.06,120.06,0,0,0,45.81,47.44,120.06,120.06,0,0,0,17.56,90.82C11.5,106.4,7.36,124.2,6.17,150.27s-1.47,34.46-1.47,101,0.28,74.86,1.47,101,5.33,43.87,11.38,59.45a120.06,120.06,0,0,0,28.25,43.38,120.06,120.06,0,0,0,43.38,28.25c15.58,6.05,33.38,10.19,59.45,11.38s34.46,1.47,101,1.47,74.86-.28,101-1.47,43.87-5.33,59.45-11.38a125.24,125.24,0,0,0,71.63-71.63c6.05-15.58,10.19-33.38,11.38-59.45s1.47-34.46,1.47-101-0.28-74.86-1.47-101-5.33-43.87-11.38-59.45a120.06,120.06,0,0,0-28.25-43.38,120.06,120.06,0,0,0-43.38-28.25C394.47,13.13,376.67,9,350.6,7.8s-34.46-1.47-101-1.47h0Z" transform="translate(-4.7 -6.33)" /><path d="M249.62,125.48A125.77,125.77,0,1,0,375.39,251.25,125.77,125.77,0,0,0,249.62,125.48Zm0,207.41a81.64,81.64,0,1,1,81.64-81.64A81.64,81.64,0,0,1,249.62,332.89Z" transform="translate(-4.7 -6.33)"/><circle cx="375.66" cy="114.18" r="29.39" /></symbol><symbol id="icon-linkedin" viewBox="0 0 12 14"><path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"></path></symbol><symbol id="icon-heart" viewBox="0 0 34 30"><path d="M17,29.7 L16.4,29.2 C3.5,18.7 0,15 0,9 C0,4 4,0 9,0 C13.1,0 15.4,2.3 17,4.1 C18.6,2.3 20.9,0 25,0 C30,0 34,4 34,9 C34,15 30.5,18.7 17.6,29.2 L17,29.7 Z M9,2 C5.1,2 2,5.1 2,9 C2,14.1 5.2,17.5 17,27.1 C28.8,17.5 32,14.1 32,9 C32,5.1 28.9,2 25,2 C21.5,2 19.6,4.1 18.1,5.8 L17,7.1 L15.9,5.8 C14.4,4.1 12.5,2 9,2 Z" id="Shape"></path></symbol><symbol id="icon-arrow-right" viewBox="0 0 25.452 25.452"><path d="M4.471,24.929v-2.004l12.409-9.788c0.122-0.101,0.195-0.251,0.195-0.411c0-0.156-0.073-0.31-0.195-0.409L4.471,2.526V0.522c0-0.2,0.115-0.384,0.293-0.469c0.18-0.087,0.396-0.066,0.552,0.061l15.47,12.202c0.123,0.1,0.195,0.253,0.195,0.409c0,0.16-0.072,0.311-0.195,0.411L5.316,25.34c-0.155,0.125-0.372,0.147-0.552,0.061C4.586,25.315,4.471,25.13,4.471,24.929z"/></symbol><symbol id="icon-star" viewBox="0 0 48 48"><path fill="currentColor" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"/><path fill="#ffffff" d="M24,11l3.898,7.898l8.703,1.301l-6.301,6.102l1.5,8.699L24,30.898L16.199,35l1.5-8.699l-6.301-6.102  l8.703-1.301L24,11z"/></symbol><symbol id="icon-read" viewBox="0 0 32 32"><path fill="currentColor" d="M29,4H3C1.343,4,0,5.343,0,7v18c0,1.657,1.343,3,3,3h10c0,0.552,0.448,1,1,1h4c0.552,0,1-0.448,1-1h10  c1.657,0,3-1.343,3-3V7C32,5.343,30.657,4,29,4z M29,5v20H18.708c-0.618,0-1.236,0.146-1.789,0.422l-0.419,0.21V5H29z M15.5,5  v20.632l-0.419-0.21C14.528,25.146,13.91,25,13.292,25H3V5H15.5z M31,25c0,1.103-0.897,2-2,2H18v1h-4v-1H3c-1.103,0-2-0.897-2-2V7  c0-0.737,0.405-1.375,1-1.722V25c0,0.552,0.448,1,1,1h10.292c0.466,0,0.925,0.108,1.342,0.317l0.919,0.46  c0.141,0.07,0.294,0.106,0.447,0.106c0.153,0,0.306-0.035,0.447-0.106l0.919-0.46C17.783,26.108,18.242,26,18.708,26H29  c0.552,0,1-0.448,1-1V5.278C30.595,5.625,31,6.263,31,7V25z M6,12.5C6,12.224,6.224,12,6.5,12h5c0.276,0,0.5,0.224,0.5,0.5  S11.776,13,11.5,13h-5C6.224,13,6,12.776,6,12.5z M6,14.5C6,14.224,6.224,14,6.5,14h5c0.276,0,0.5,0.224,0.5,0.5S11.776,15,11.5,15  h-5C6.224,15,6,14.776,6,14.5z M6,16.5C6,16.224,6.224,16,6.5,16h5c0.276,0,0.5,0.224,0.5,0.5S11.776,17,11.5,17h-5  C6.224,17,6,16.776,6,16.5z M20,12.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,13,25.5,13h-5  C20.224,13,20,12.776,20,12.5z M20,14.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,15,25.5,15h-5  C20.224,15,20,14.776,20,14.5z M20,16.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,17,25.5,17h-5  C20.224,17,20,16.776,20,16.5z"></path></symbol><symbol id="icon-tistory" viewBox="0 0 24 24"><path d="M4 4h16v3h-6v13h-4V7H4V4z"/></symbol></defs></svg>

        <header class="bar-header">
    <a id="menu" role="button">
        <svg id="open" class="icon-menu"><use xlink:href="#icon-menu"></use></svg>
    </a>
    <h1 class="logo">
        <a href="/">
            
                somaz <span class="version">v3.1.2</span>
            
        </a>
    </h1>
    <a id="search" class="dosearch" role="button">
        <svg class="icon-search"><use xlink:href="#icon-search"></use></svg>
    </a>
    
        <a href="https://github.com/thiagorossener/jekflix-template" class="get-theme" role="button">
            Get this theme!
        </a>
    
</header>

<div id="mask" class="overlay"></div>

<aside class="sidebar" id="sidebar">
    <nav id="navigation">
      <h2>Menu</h2>
      <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>

    </nav>
</aside>

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search">
        <svg class="icon-remove-sign"><use xlink:href="#icon-close"></use></svg>
        <ul class="search-results search-list"></ul>
    </div>
</div>



        <section class="post two-columns">
            <article role="article" class="post-content">
                <p class="post-info">
                    
                        <svg class="icon-calendar" id="date"><use xlink:href="#icon-calendar"></use></svg>
                        <time class="date" datetime="2025-03-07T05:00:00+00:00">
                            


March 7, 2025

                        </time>
                    
                    <svg id="clock" class="icon-clock"><use xlink:href="#icon-clock"></use></svg>
                    <span>11 min to read</span>
                </p>
                <h1 class="post-title">Setting up ArgoCD SSO with GCP OAuth</h1>
                <p class="post-subtitle">A comprehensive guide to implementing ArgoCD SSO with GCP OAuth</p>

                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1739942456/argocd-sso-google-oauth_ssoqyf.png" alt="Featured image" class="post-cover">
                

                <!-- Pagination links -->



                <!-- Add your table of contents here -->


                <p><br /></p>

<hr />

<h2 id="overview">Overview</h2>
<p>This post explains how to configure Single Sign-On (SSO) for ArgoCD using Google Cloud Platform (GCP) OAuth.</p>

<p><br /></p>

<h3 id="benefits-of-using-sso-with-argocd">Benefits of Using SSO with ArgoCD</h3>

<div class="info-box info-box-default-not-check">
  <ul>
    <li>
      <strong>Centralized Authentication</strong><br />
      Streamlines access management by integrating with your organization's existing identity provider.
    </li>
    <li>
      <strong>Enhanced Security</strong><br />
      Leverages Google's security features including MFA, suspicious login detection, and centralized user management.
    </li>
    <li>
      <strong>Simplified User Experience</strong><br />
      Provides seamless login experience without requiring separate ArgoCD credentials.
    </li>
    <li>
      <strong>Improved Compliance</strong><br />
      Facilitates audit logging and access controls through centralized identity management.
    </li>
  </ul>
</div>

<p><br /></p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>A GCP project with OAuth 2.0 configured</li>
  <li>ArgoCD installed on a Kubernetes cluster</li>
  <li>Administrative access to both GCP and ArgoCD</li>
  <li>Domain with proper DNS configuration for ArgoCD</li>
</ul>

<p><br /></p>

<h2 id="steps">Steps</h2>

<p><br /></p>

<h3 id="1-create-oauth-20-client-id-in-gcp">1. Create OAuth 2.0 Client ID in GCP</h3>

<h4 id="console-method">Console Method</h4>

<h5 id="1-log-in-to-google-cloud-console-and-select-your-project">1. Log in to Google Cloud Console and select your project</h5>

<h5 id="2-navigate-to-apis--services--credentials">2. Navigate to “APIs &amp; Services” &gt; “Credentials”</h5>

<h5 id="3-click-create-credentials-and-select-oauth-client-id">3. Click “Create Credentials” and select “OAuth client ID”</h5>

<h5 id="4-configure-oauth-consent-screen">4. Configure OAuth consent screen:</h5>
<ul>
  <li>Choose Internal (for organization users) or External (for all Google accounts)</li>
  <li>Complete app registration: OAuth consent screen, scopes, test users, summary</li>
</ul>

<h5 id="5-create-oauth-client">5. Create OAuth client:</h5>
<ul>
  <li>Select “Web application” as application type</li>
  <li>Add authorized redirect URI: <code class="language-plaintext highlighter-rouge">https://argocd-server-url/api/dex/callback</code></li>
</ul>

<h5 id="6-save-the-generated-credentials">6. Save the generated credentials</h5>

<p><br /></p>

<h4 id="client-id">Client ID</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7xxxxxx-fxxxxxxxxxxxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com
</code></pre></div></div>

<h4 id="client-secret">Client Secret</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Gxxxx-oxxxxxxxxxxxxxxxxxxxxxxxx
</code></pre></div></div>

<h4 id="cli-method">CLI Method</h4>

<p><br /></p>

<script src="https://gist.github.com/somaz94/c677a076dc0f3cd275f2bdef6a5fac74.js"></script>

<p><br /></p>

<h3 id="2-update-argocd-configuration">2. Update ArgoCD Configuration</h3>

<p>First, backup existing configurations:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>k get cm <span class="nt">-n</span> argocd argocd-cm <span class="nt">-o</span> yaml | k neat <span class="o">&gt;&gt;</span> argocd-cm.yaml
k get secrets <span class="nt">-n</span> argocd argocd-secret <span class="nt">-o</span> yaml | k neat <span class="o">&gt;&gt;</span> argocd-secret.yaml
</code></pre></div></div>

<h4 id="update-configmaps-yaml">Update ConfigMaps (Yaml)</h4>

<h5 id="argocd-cm">argocd-cm</h5>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-cm</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">https://&lt;argocd-server-url&gt;</span>
  <span class="na">dex.config</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">connectors:</span>
      <span class="s">- type: oidc</span>
        <span class="s">id: google</span>
        <span class="s">name: Google</span>
        <span class="s">config:</span>
          <span class="s">issuer: https://accounts.google.com</span>
          <span class="s">clientID: &lt;YOUR-CLIENT-ID&gt;</span>
          <span class="s">clientSecret: $google-client-secret</span>
          <span class="s">redirectURI: https://argocd.somaz.link/api/dex/callback </span>
          <span class="s">hostedDomains:</span>
            <span class="s">- &lt;your-domain.com&gt;</span>
</code></pre></div></div>

<h5 id="argocd-rbac-cm">argocd-rbac-cm</h5>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-rbac-cm</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app.kubernetes.io/name</span><span class="pi">:</span> <span class="s">argocd-rbac-cm</span>
    <span class="na">app.kubernetes.io/part-of</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">policy.csv</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">p, role:org-admin, applications, *, */*, allow</span>
    <span class="s">p, role:org-admin, clusters, get, *, allow</span>
    <span class="s">p, role:org-admin, repositories, get, *, allow</span>
    <span class="s">p, role:org-admin, repositories, create, *, allow</span>
    <span class="s">p, role:org-admin, repositories, update, *, allow</span>
    <span class="s">p, role:org-admin, repositories, delete, *, allow</span>
    <span class="s">p, role:org-admin, projects, get, *, allow</span>
    <span class="s">p, role:org-admin, projects, create, *, allow</span>
    <span class="s">p, role:org-admin, projects, update, *, allow</span>
    <span class="s">p, role:org-admin, projects, delete, *, allow</span>
    <span class="s">p, role:org-admin, logs, get, *, allow</span>
    <span class="s">p, role:org-admin, exec, create, */*, allow</span>
    <span class="s">g, somaz@example.com, role:org-admin</span>
  <span class="na">policy.default</span><span class="pi">:</span> <span class="s">role:readonly</span>
  <span class="na">scopes</span><span class="pi">:</span> <span class="s1">'</span><span class="s">[groups,</span><span class="nv"> </span><span class="s">email]'</span>
</code></pre></div></div>

<h4 id="update-configmaps-helm">Update ConfigMaps (Helm)</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="na">global</span><span class="pi">:</span>
  <span class="c1"># -- Default domain used by all components</span>
  <span class="c1">## Used for ingresses, certificates, SSO, notifications, etc.</span>
  <span class="na">domain</span><span class="pi">:</span> <span class="s">argocd.somaz.link</span>
  <span class="c1"># SSH known hosts for Git repositories</span>
  <span class="c1">## Ref: https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#ssh-known-host-public-keys</span>

<span class="na">configs</span><span class="pi">:</span>
  <span class="na">cm</span><span class="pi">:</span>
    <span class="na">timeout.reconciliation</span><span class="pi">:</span> <span class="s">180s</span> <span class="c1"># default is 180s</span>
    <span class="c1"># Add account settings</span>
    <span class="na">dex.config</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="s">connectors:</span>
        <span class="s">- type: oidc</span>
          <span class="s">id: google</span>
          <span class="s">name: Google</span>
          <span class="s">config:</span>
            <span class="s">baseURL: https://accounts.google.com # TODO: change to your Google domain</span>
            <span class="s">clientID: cd5caac... # TODO: change to your Google client ID</span>
            <span class="s">clientSecret: gloas-a9... # TODO: change to your Google client secret</span>
            <span class="s">redirectURI: https://argocd.somaz.link/api/dex/callback # TODO: change to your Argo CD domain</span>

  <span class="na">params</span><span class="pi">:</span>
    <span class="na">create</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">server.insecure</span><span class="pi">:</span> <span class="no">false</span>  <span class="c1"># default: false</span>
  <span class="c1"># SSH known hosts for Git repositories</span>
  <span class="c1">## Ref: https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#ssh-known-host-public-keys</span>
  <span class="na">ssh</span><span class="pi">:</span>
    <span class="c1"># -- Additional known hosts for private repositories</span>
    <span class="c1"># extraHosts: |</span>
    <span class="c1">#   gitlab.somaz.link ssh-rsa AAAAB3...</span>
    <span class="c1">#   gitlab.somaz.link ecdsa-sha2-nistp256 AAAA...</span>
    <span class="c1">#   gitlab.somaz.link ssh-ed25519 AAAA...</span>

  <span class="na">rbac</span><span class="pi">:</span>
    <span class="na">create</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">policy.csv</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="s">p, role:org-admin, applications, *, */*, allow</span>
      <span class="s">p, role:org-admin, clusters, get, *, allow</span>
      <span class="s">p, role:org-admin, repositories, *, *, allow</span>
      <span class="s">p, role:org-admin, projects, get, *, allow</span>
      <span class="s">p, role:org-admin, logs, get, *, allow</span>
      <span class="s">p, role:org-admin, exec, create, */*, allow</span>
      
      <span class="s"># Google 그룹 멤버에게 admin 권한 부여</span>
      <span class="s">g, somaz@somaz.link, role:org-admin # TODO: change to your Google user email(somaz@somaz.link)</span>
  
  <span class="na">secrets</span><span class="pi">:</span>
    <span class="c1"># Google SSO Configuration</span>
    <span class="na">dex.google.clientId</span><span class="pi">:</span> <span class="s2">"</span><span class="s">cd5caac...</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">TODO:</span><span class="nv"> </span><span class="s">change</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">Google</span><span class="nv"> </span><span class="s">client</span><span class="nv"> </span><span class="s">ID"</span>
    <span class="na">dex.google.clientSecret</span><span class="pi">:</span> <span class="s2">"</span><span class="s">gloas-a9...</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">TODO:</span><span class="nv"> </span><span class="s">change</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">Google</span><span class="nv"> </span><span class="s">client</span><span class="nv"> </span><span class="s">secret"</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="3-create-argocd-secret-for-oauth">3. Create argocd-secret for OAuth</h3>

<p>If you’re using the Google OAuth connector, you need to store the client secret securely:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-secret</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app.kubernetes.io/name</span><span class="pi">:</span> <span class="s">argocd-secret</span>
    <span class="na">app.kubernetes.io/part-of</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="c1"># Base64 encoded client secret</span>
  <span class="na">dex.google.clientSecret</span><span class="pi">:</span> <span class="s">R3h4eHgtb3h4eHh4eHh4eHh4eHh4eHh4eHh4</span>
  <span class="c1"># Add other existing ArgoCD secrets here as well</span>
</code></pre></div></div>

<p>To create this secret manually:</p>

<p><br /></p>

<script src="https://gist.github.com/somaz94/1b7bbc9d6a31b0433c7db1ba26525902.js"></script>

<p><br /></p>

<h3 id="4-restart-argocd-components">4. Restart ArgoCD Components</h3>

<p>Check deployments:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>k get deployments.apps <span class="nt">-n</span> argocd
</code></pre></div></div>

<p>Restart required components:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>k rollout restart deploy <span class="nt">-n</span> argocd argocd-server
k rollout restart deploy <span class="nt">-n</span> argocd argocd-dex-server
</code></pre></div></div>

<p><br /></p>

<h3 id="5-test-login">5. Test Login</h3>
<p>Access your ArgoCD instance and verify that Google Workspace SSO login works correctly.</p>

<p><img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1739942455/argocd-sso-google-oauth-login_x9xd84.png" alt="ArgoCD SSO Google OAuth Login" /></p>

<p><br /></p>

<h2 id="advanced-configuration">Advanced Configuration</h2>

<p><br /></p>

<h3 id="group-based-access-control">Group-Based Access Control</h3>

<p>You can map Google Workspace groups to ArgoCD roles for more granular permissions management:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-rbac-cm</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">policy.csv</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s"># Allow members of 'platform-team@example.com' to be admins</span>
    <span class="s">g, platform-team@example.com, role:admin</span>

    <span class="s"># Allow members of 'developers@example.com' to only access certain projects</span>
    <span class="s">p, role:developers, applications, get, dev-team/*, allow</span>
    <span class="s">p, role:developers, applications, sync, dev-team/*, allow</span>
    <span class="s">g, developers@example.com, role:developers</span>

    <span class="s"># Default permissions for all users</span>
    <span class="s">p, role:readonly, applications, get, */*, allow</span>
    <span class="s">p, role:readonly, clusters, get, *, allow</span>
  
  <span class="na">scopes</span><span class="pi">:</span> <span class="s1">'</span><span class="s">[groups,</span><span class="nv"> </span><span class="s">email]'</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="configuring-google-groups-integration">Configuring Google Groups Integration</h3>

<p>To enable group membership checking, update the Dex connector configuration:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">dex.config</span><span class="pi">:</span> <span class="pi">|</span>
  <span class="s">connectors:</span>
    <span class="s">- type: oidc</span>
      <span class="s">id: google</span>
      <span class="s">name: Google</span>
      <span class="s">config:</span>
        <span class="s">issuer: https://accounts.google.com</span>
        <span class="s">clientID: &lt;YOUR-CLIENT-ID&gt;</span>
        <span class="s">clientSecret: $dex.google.clientSecret</span>
        <span class="s">redirectURI: https://argocd.somaz.link/api/dex/callback</span>
  <span class="no">      </span>
        <span class="s"># Enable Google Groups integration</span>
        <span class="s">groups:</span>
          <span class="s"># True to use Google Groups for group membership claims</span>
          <span class="s">useGroupsAsWhitelist: true</span>
          <span class="s"># Filtering to specific Google Groups</span>
          <span class="s">filterGroups: ["dev-team@example.com", "platform-team@example.com"]</span>
  <span class="no">      </span>
        <span class="s"># Restrict to specific domains</span>
        <span class="s">hostedDomains:</span>
          <span class="s">- example.com</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="hardening-your-sso-configuration">Hardening Your SSO Configuration</h2>

<div class="info-box info-box-warning">
<br />
<strong>Security Best Practices:</strong><br /><br />

<strong>1. Session Management:</strong>
   - Configure reasonable session timeouts<br />
   - Enable secure session storage<br />
   - Implement session revocation mechanisms<br /><br />

<strong>2. Access Control:</strong>
   - Apply the principle of least privilege<br />
   - Regularly audit user access and permissions<br />
   - Implement role-based access control<br /><br />

<strong>3. Network Security:</strong>
   - Use HTTPS with valid certificates<br />
   - Implement network policies to restrict access<br />
   - Consider adding IP-based restrictions<br /><br />

<strong>4. Monitoring and Logging:</strong>
   - Enable comprehensive audit logging<br />
   - Monitor for suspicious login attempts<br />
   - Set up alerts for permission changes<br /><br />
</div>

<p><br /></p>

<h3 id="session-configuration-example">Session Configuration Example</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-cm</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">https://argocd.somaz.link</span>
  
  <span class="c1"># Session settings</span>
  <span class="na">application.instanceLabelKey</span><span class="pi">:</span> <span class="s">argocd.argoproj.io/instance</span>
  <span class="na">admin.enabled</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
  <span class="na">timeout.reconciliation</span><span class="pi">:</span> <span class="s">180s</span>
  
  <span class="c1"># Session security settings</span>
  <span class="na">session.duration</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8h"</span>  <span class="c1"># Session valid for 8 hours</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="tls-configuration">TLS Configuration</h2>

<p>Ensure your ArgoCD instance is properly secured with TLS:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-cmd-params-cm</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="c1"># Disable insecure connections</span>
  <span class="na">server.insecure</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
  
  <span class="c1"># Enable strict TLS</span>
  <span class="na">server.strict-tls</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
</code></pre></div></div>

<p>For Ingress with TLS:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-server-ingress</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">argocd</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">kubernetes.io/ingress.class</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">cert-manager.io/cluster-issuer</span><span class="pi">:</span> <span class="s">letsencrypt-prod</span>
    <span class="na">nginx.ingress.kubernetes.io/backend-protocol</span><span class="pi">:</span> <span class="s">HTTPS</span>
    <span class="c1"># Required for OAuth redirects</span>
    <span class="na">nginx.ingress.kubernetes.io/ssl-passthrough</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">argocd.somaz.link</span>
    <span class="na">http</span><span class="pi">:</span>
      <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
        <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
        <span class="na">backend</span><span class="pi">:</span>
          <span class="na">service</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">argocd-server</span>
            <span class="na">port</span><span class="pi">:</span>
              <span class="na">name</span><span class="pi">:</span> <span class="s">https</span>
  <span class="na">tls</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">argocd.somaz.link</span>
    <span class="na">secretName</span><span class="pi">:</span> <span class="s">argocd-secret-tls</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p><br /></p>

<h3 id="common-issues">Common Issues</h3>

<div class="info-box info-box-warning">
<br />
<strong>Typical Problems and Solutions:</strong><br /><br />

<strong>1. Authentication Failed:</strong>
   - Check client ID and secret<br />
   - Verify redirect URI configuration<br />
   - Ensure domain settings match<br />
   - Check ArgoCD server URL configuration<br /><br />

<strong>2. User Cannot Login:</strong>
   - Verify the user's email domain matches hostedDomains<br />
   - Check RBAC configuration<br />
   - Inspect Dex logs for errors<br /><br />

<strong>3. Insufficient Permissions:</strong>
   - Review RBAC policy configuration<br />
   - Check user's group membership<br />
   - Verify scopes include 'groups' and 'email'<br /><br />

<strong>4. Certificate Issues:</strong>
   - Ensure SSL certificates are valid<br />
   - Check TLS configuration<br />
   - Verify proper URL redirection<br /><br />
</div>

<p><br /></p>

<h3 id="debug-commands">Debug Commands</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check ArgoCD server logs</span>
kubectl logs <span class="nt">-n</span> argocd <span class="nt">-l</span> app.kubernetes.io/name<span class="o">=</span>argocd-server

<span class="c"># Check Dex server logs</span>
kubectl logs <span class="nt">-n</span> argocd <span class="nt">-l</span> app.kubernetes.io/name<span class="o">=</span>argocd-dex-server

<span class="c"># View configuration</span>
kubectl get cm argocd-cm <span class="nt">-n</span> argocd <span class="nt">-o</span> yaml

<span class="c"># Check RBAC configuration</span>
kubectl get cm argocd-rbac-cm <span class="nt">-n</span> argocd <span class="nt">-o</span> yaml

<span class="c"># Test network connectivity</span>
kubectl run <span class="nt">-it</span> <span class="nt">--rm</span> debug <span class="nt">--image</span><span class="o">=</span>curlimages/curl:7.73.0 <span class="nt">--</span> curl <span class="nt">-vk</span> https://argocd-server.argocd.svc.cluster.local
</code></pre></div></div>

<p><br /></p>

<h3 id="checking-dex-status">Checking Dex Status</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Port forward to Dex metrics</span>
kubectl port-forward <span class="nt">-n</span> argocd svc/argocd-dex-server 5558

<span class="c"># In a new terminal</span>
curl localhost:5558/metrics | <span class="nb">grep </span>dex
</code></pre></div></div>

<p><br /></p>

<h2 id="automating-the-setup">Automating the Setup</h2>

<p><br /></p>

<h3 id="setup-script">Setup Script</h3>

<p>Here’s a script to automate the configuration:</p>

<p><br /></p>

<script src="https://gist.github.com/somaz94/085f618e570c7d84018eb50e0b229193.js"></script>

<p><br /></p>

<h3 id="authentication-processes">Authentication Processes</h3>
<ul>
  <li>OAuth Authentication</li>
  <li>SAML Authentication</li>
  <li>OpenID Connect Authentication</li>
</ul>

<p><br /></p>

<h3 id="important-notes">Important Notes</h3>
<ul>
  <li>Consider domain settings, security policies, and network configurations for production environments</li>
  <li>Keep up with the latest documentation as GCP Console and ArgoCD settings may change</li>
  <li>Ensure proper backup before making configuration changes</li>
  <li>Use separate test and production environments for SSO configuration testing</li>
</ul>

<p><br /></p>

<h2 id="security-considerations">Security Considerations</h2>

<p><br /></p>

<h3 id="argocd-sso-security-checklist">ArgoCD SSO Security Checklist</h3>

<div class="info-box info-box-success">
<br />
<strong>Security Checklist:</strong><br /><br />

✅ Use HTTPS with valid certificates<br />
✅ Implement least privilege RBAC policies<br />
✅ Restrict by hosted domains<br />
✅ Enable appropriate session timeouts<br />
✅ Regularly rotate client secrets<br />
✅ Audit SSO access regularly<br />
✅ Backup configurations before changes<br />
✅ Implement network policies<br />
✅ Monitor for suspicious login attempts<br />
✅ Enable multi-factor authentication in Google<br />
</div>

<p><br /></p>

<hr />

<h2 id="references">References</h2>
<ul>
  <li><a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/google/">ArgoCD SSO with GCP OAuth</a></li>
  <li><a href="https://dexidp.io/docs/connectors/oidc/">Dex Authentication Documentation</a></li>
  <li><a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/rbac/">ArgoCD RBAC Configuration</a></li>
  <li><a href="https://developers.google.com/identity/protocols/oauth2/web-server">Google OAuth 2.0 for Server Applications</a></li>
  <li><a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls">Kubernetes Ingress with TLS</a></li>
</ul>


                <!-- Pagination links -->


            </article>

            
                <aside class="see-also">
                    <h2>See also</h2>
                    <ul>
                        
                        
                        
                            <li>
                                <a href="/category/kubernetes/kubernetes-install-kubespray-new/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1737697968/kubespray_uyug5r.png">
                                    
                                    <h3>Installing Kubernetes with Kubespray and Adding Worker Nodes (2025V.)</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/openstack/openstack-kuryr/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1742267532/openstack_t2tmoc.png">
                                    
                                    <h3>Deep Dive into OpenStack Kuryr</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/troubleshooting/github-account-suspension/">
                                    
                                        <img src="https://blog.kakaocdn.net/dn/xOsBb/btsMqCFn1Vv/nwSrCKkeuEwkoZ5eEK6860/img.png">
                                    
                                    <h3>GitHub Account Suspension Recovery Guide</h3>
                                </a>
                            </li>
                        
                    </ul>
                </aside>
            

        </section>

        <!-- Add time bar only for pages without pagination -->
        
            <div class="time-bar" data-minutes="11">
    <span class="time-completed"></span>
    <span class="time-remaining"></span>
    <div class="bar">
        <span class="completed" style="width:0%;"></span>
        <span class="remaining" style="width:100%;"></span>
    </div>
</div>

            <button class="toggle-preview" onclick="togglePreview()">
    <span>Hide Preview ▼</span>
</button>

<div id="recommendationSection" class="recommendation">
    <div class="message">
        <strong>Why don't you read something next?</strong>
        <div>
            <button>
                <svg><use xlink:href="#icon-arrow-right"></use></svg>
                <span>Go back to top</span>
            </button>
        </div>
    </div>
    <div id="previewSection" class="preview-section">
        
        <a href="/category/cicd/argocd-sso-gitlab/" class="post-preview">
            <div class="image">
                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1739943377/argocd-sso-gitlab_jzuunn.png">
                
            </div>
            <h3 class="title">Setting up ArgoCD SSO with GitLab</h3>
        </a>
    </div>
</div>

<style>
.toggle-preview {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #333;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.toggle-preview:hover {
    background: #444;
}

.toggle-preview.visible {
    opacity: 1;
}

.recommendation {
    margin-top: 1000px;
    display: block;
    transition: all 0.3s ease;
}

.recommendation.hidden {
    display: none;
}

.hide-preview {
    margin-left: 10px;
    background: none;
    border: 1px solid #666;
    color: #666;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}

.hide-preview:hover {
    background: #f0f0f0;
}

.preview-section {
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.preview-section.hidden {
    max-height: 0;
}
</style>

<script>
function togglePreview() {
    const recommendation = document.getElementById('recommendationSection');
    const button = document.querySelector('.toggle-preview span');
    
    if (recommendation.classList.contains('hidden')) {
        recommendation.classList.remove('hidden');
        button.textContent = 'Hide Preview ▼';
    } else {
        recommendation.classList.add('hidden');
        button.textContent = 'Show Preview ▲';
    }
}

window.addEventListener('scroll', function() {
    const toggleButton = document.querySelector('.toggle-preview');
    const recommendation = document.getElementById('recommendationSection');
    const rect = recommendation.getBoundingClientRect();
    
    if (rect.top <= window.innerHeight) {
        toggleButton.classList.add('visible');
    } else {
        toggleButton.classList.remove('visible');
    }
});
</script>

        

        <!-- Show modal if the post is the last one -->
        

        <!-- Show modal before user leaves the page -->
        

        <!-- Add your newsletter subscription form here -->

        <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;Learn how to set up and manage ArgoCD SSO with GCP OAuth&quot;%20https://somaz.blog/category/cicd/argocd-sso-gcp-oauth/%20via%20&#64;twitter_username&hashtags=github,kubernetes,helm,cicd"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://somaz.blog/category/cicd/argocd-sso-gcp-oauth/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
</section>

        

  <section class="author">
    <div class="details">
      
        <img class="img-rounded" src="/assets/img/uploads/profile.png" alt="Somaz">
      
      <p class="def">Author</p>
      <h3 class="name">
        <a href="/authors/somaz/">Somaz</a>
      </h3>
      <p class="desc">DevOps engineer focused on cloud infrastructure and automation</p>
      <p>
        
          <a href="https://github.com/somaz94" title="Github">
            <svg><use xlink:href="#icon-github"></use></svg>
          </a>
        
        
        
        
        
        
          <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
            <svg><use xlink:href="#icon-linkedin"></use></svg>
          </a>
        
        
          <a href="https://somaz.tistory.com" title="Tistory">
            <svg><use xlink:href="#icon-tistory"></use></svg>
          </a>
        
      </p>
    </div>
  </section>

  
  
  
  
  
  
  
  

  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Somaz",
      
      "image": "/assets/img/uploads/profile.png",
      
      "jobTitle": "DevOps Engineer",
      "url": "https://somaz.blog/authors/somaz/",
      "sameAs": [
        "https://github.com/somaz94","https://www.linkedin.com/in/somaz","https://{{ author.tistory_username }}.tistory.com"
      ]
  }
  </script>


        

<section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = 'https-somaz94-github-io';
        var disqus_title = '';
        var disqus_url = '/category/cicd/argocd-sso-gcp-oauth/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>



        <footer>
    <p>
      
        <a href="https://github.com/somaz94" title="Github">
          <svg><use xlink:href="#icon-github"></use></svg>
        </a>
      
      
        <a href="https://www.facebook.com/facebook_username" title="Facebook">
          <svg><use xlink:href="#icon-facebook"></use></svg>
        </a>
      
      
        <a href="https://twitter.com/twitter_username" title="Twitter">
          <svg><use xlink:href="#icon-twitter"></use></svg>
        </a>
      
      
        <a href="https://medium.com/@medium_username" title="Medium">
          <svg><use xlink:href="#icon-medium"></use></svg>
        </a>
      
      
        <a href="https://www.instagram.com/instagram_username" title="Instagram">
          <svg><use xlink:href="#icon-instagram"></use></svg>
        </a>
      
      
        <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
          <svg><use xlink:href="#icon-linkedin"></use></svg>
        </a>
      
      
        <a href="https://somaz.tistory.com" title="Tistory">
          <svg><use xlink:href="#icon-tistory"></use></svg>
        </a>
      
    </p>

    <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>


    <p>
      <a href="https://somaz.blog/sitemap.xml" title="sitemap">Sitemap</a> |
      <a href="https://somaz.blog/privacy-policy.html" title="Privacy Policy">Privacy Policy</a>
    </p>

    <p>
      <span>Somaz Tech Blog</span> <svg class="love"><use xlink:href="#icon-heart"></use></svg>
    </p>
</footer>










<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "somaz",
  "description": "DevOps engineer's tech blog.",
  "url": "https://somaz.blog/",
  "logo": {
      "@type": "ImageObject",
      "url": "https://somaz.blog/assets/img/icons/mediumtile.png",
      "width": "600",
      "height": "315"
  },
  "sameAs": [
    "https://github.com/somaz94","https://www.facebook.com/facebook_username","https://twitter.com/twitter_username","https://medium.com/@medium_username","https://www.instagram.com/instagram_username","https://www.linkedin.com/in/somaz","https://{{ site.tistory_username }}.tistory.com"
  ]
}
</script>

<!-- Include the script that allows Netlify CMS login -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<!-- Include the website scripts -->
<script src="/assets/js/scripts.min.js"></script>

<!-- Include Google Analytics script -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
<script>
  var host = window.location.hostname;
  if (host != 'localhost') {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXX-X');
  }
</script>
  


<!-- Include extra scripts -->



        

        
        
        
        
        
        
        
        
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "name": "Setting up ArgoCD SSO with GCP OAuth",
            "headline": "A comprehensive guide to implementing ArgoCD SSO with GCP OAuth",
            "description": "Learn how to set up and manage ArgoCD SSO with GCP OAuth",
            "image": "https://res.cloudinary.com/dkcm26aem/image/upload/v1739942456/argocd-sso-google-oauth_ssoqyf.png",
            "url": "https://somaz.blog/category/cicd/argocd-sso-gcp-oauth/",
            "articleBody": "



Overview
This post explains how to configure Single Sign-On (SSO) for ArgoCD using Google Cloud Platform (GCP) OAuth.



Benefits of Using SSO with ArgoCD


  
    
      Centralized Authentication
      Streamlines access management by integrating with your organization&apos;s existing identity provider.
    
    
      Enhanced Security
      Leverages Google&apos;s security features including MFA, suspicious login detection, and centralized user management.
    
    
      Simplified User Experience
      Provides seamless login experience without requiring separate ArgoCD credentials.
    
    
      Improved Compliance
      Facilitates audit logging and access controls through centralized identity management.
    
  




Prerequisites

  A GCP project with OAuth 2.0 configured
  ArgoCD installed on a Kubernetes cluster
  Administrative access to both GCP and ArgoCD
  Domain with proper DNS configuration for ArgoCD




Steps



1. Create OAuth 2.0 Client ID in GCP

Console Method

1. Log in to Google Cloud Console and select your project

2. Navigate to “APIs &amp;amp; Services” &amp;gt; “Credentials”

3. Click “Create Credentials” and select “OAuth client ID”

4. Configure OAuth consent screen:

  Choose Internal (for organization users) or External (for all Google accounts)
  Complete app registration: OAuth consent screen, scopes, test users, summary


5. Create OAuth client:

  Select “Web application” as application type
  Add authorized redirect URI: https://argocd-server-url/api/dex/callback


6. Save the generated credentials



Client ID

7xxxxxx-fxxxxxxxxxxxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com


Client Secret

Gxxxx-oxxxxxxxxxxxxxxxxxxxxxxxx


CLI Method







2. Update ArgoCD Configuration

First, backup existing configurations:
k get cm -n argocd argocd-cm -o yaml | k neat &amp;gt;&amp;gt; argocd-cm.yaml
k get secrets -n argocd argocd-secret -o yaml | k neat &amp;gt;&amp;gt; argocd-secret.yaml


Update ConfigMaps (Yaml)

argocd-cm

apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
data:
  url: https://&amp;lt;argocd-server-url&amp;gt;
  dex.config: |
    connectors:
      - type: oidc
        id: google
        name: Google
        config:
          issuer: https://accounts.google.com
          clientID: &amp;lt;YOUR-CLIENT-ID&amp;gt;
          clientSecret: $google-client-secret
          redirectURI: https://argocd.somaz.link/api/dex/callback 
          hostedDomains:
            - &amp;lt;your-domain.com&amp;gt;


argocd-rbac-cm

apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-rbac-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-rbac-cm
    app.kubernetes.io/part-of: argocd
data:
  policy.csv: |
    p, role:org-admin, applications, *, */*, allow
    p, role:org-admin, clusters, get, *, allow
    p, role:org-admin, repositories, get, *, allow
    p, role:org-admin, repositories, create, *, allow
    p, role:org-admin, repositories, update, *, allow
    p, role:org-admin, repositories, delete, *, allow
    p, role:org-admin, projects, get, *, allow
    p, role:org-admin, projects, create, *, allow
    p, role:org-admin, projects, update, *, allow
    p, role:org-admin, projects, delete, *, allow
    p, role:org-admin, logs, get, *, allow
    p, role:org-admin, exec, create, */*, allow
    g, somaz@example.com, role:org-admin
  policy.default: role:readonly
  scopes: &apos;[groups, email]&apos;


Update ConfigMaps (Helm)


global:
  # -- Default domain used by all components
  ## Used for ingresses, certificates, SSO, notifications, etc.
  domain: argocd.somaz.link
  # SSH known hosts for Git repositories
  ## Ref: https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#ssh-known-host-public-keys

configs:
  cm:
    timeout.reconciliation: 180s # default is 180s
    # Add account settings
    dex.config: |
      connectors:
        - type: oidc
          id: google
          name: Google
          config:
            baseURL: https://accounts.google.com # TODO: change to your Google domain
            clientID: cd5caac... # TODO: change to your Google client ID
            clientSecret: gloas-a9... # TODO: change to your Google client secret
            redirectURI: https://argocd.somaz.link/api/dex/callback # TODO: change to your Argo CD domain

  params:
    create: true
    server.insecure: false  # default: false
  # SSH known hosts for Git repositories
  ## Ref: https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#ssh-known-host-public-keys
  ssh:
    # -- Additional known hosts for private repositories
    # extraHosts: |
    #   gitlab.somaz.link ssh-rsa AAAAB3...
    #   gitlab.somaz.link ecdsa-sha2-nistp256 AAAA...
    #   gitlab.somaz.link ssh-ed25519 AAAA...

  rbac:
    create: true
    policy.csv: |
      p, role:org-admin, applications, *, */*, allow
      p, role:org-admin, clusters, get, *, allow
      p, role:org-admin, repositories, *, *, allow
      p, role:org-admin, projects, get, *, allow
      p, role:org-admin, logs, get, *, allow
      p, role:org-admin, exec, create, */*, allow
      
      # Google 그룹 멤버에게 admin 권한 부여
      g, somaz@somaz.link, role:org-admin # TODO: change to your Google user email(somaz@somaz.link)
  
  secrets:
    # Google SSO Configuration
    dex.google.clientId: &quot;cd5caac... # TODO: change to your Google client ID&quot;
    dex.google.clientSecret: &quot;gloas-a9... # TODO: change to your Google client secret&quot;




3. Create argocd-secret for OAuth

If you’re using the Google OAuth connector, you need to store the client secret securely:

apiVersion: v1
kind: Secret
metadata:
  name: argocd-secret
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-secret
    app.kubernetes.io/part-of: argocd
type: Opaque
data:
  # Base64 encoded client secret
  dex.google.clientSecret: R3h4eHgtb3h4eHh4eHh4eHh4eHh4eHh4eHh4
  # Add other existing ArgoCD secrets here as well


To create this secret manually:







4. Restart ArgoCD Components

Check deployments:

k get deployments.apps -n argocd


Restart required components:

k rollout restart deploy -n argocd argocd-server
k rollout restart deploy -n argocd argocd-dex-server




5. Test Login
Access your ArgoCD instance and verify that Google Workspace SSO login works correctly.





Advanced Configuration



Group-Based Access Control

You can map Google Workspace groups to ArgoCD roles for more granular permissions management:

apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-rbac-cm
  namespace: argocd
data:
  policy.csv: |
    # Allow members of &apos;platform-team@example.com&apos; to be admins
    g, platform-team@example.com, role:admin

    # Allow members of &apos;developers@example.com&apos; to only access certain projects
    p, role:developers, applications, get, dev-team/*, allow
    p, role:developers, applications, sync, dev-team/*, allow
    g, developers@example.com, role:developers

    # Default permissions for all users
    p, role:readonly, applications, get, */*, allow
    p, role:readonly, clusters, get, *, allow
  
  scopes: &apos;[groups, email]&apos;




Configuring Google Groups Integration

To enable group membership checking, update the Dex connector configuration:

dex.config: |
  connectors:
    - type: oidc
      id: google
      name: Google
      config:
        issuer: https://accounts.google.com
        clientID: &amp;lt;YOUR-CLIENT-ID&amp;gt;
        clientSecret: $dex.google.clientSecret
        redirectURI: https://argocd.somaz.link/api/dex/callback
        
        # Enable Google Groups integration
        groups:
          # True to use Google Groups for group membership claims
          useGroupsAsWhitelist: true
          # Filtering to specific Google Groups
          filterGroups: [&quot;dev-team@example.com&quot;, &quot;platform-team@example.com&quot;]
        
        # Restrict to specific domains
        hostedDomains:
          - example.com




Hardening Your SSO Configuration



Security Best Practices:

1. Session Management:
   - Configure reasonable session timeouts
   - Enable secure session storage
   - Implement session revocation mechanisms

2. Access Control:
   - Apply the principle of least privilege
   - Regularly audit user access and permissions
   - Implement role-based access control

3. Network Security:
   - Use HTTPS with valid certificates
   - Implement network policies to restrict access
   - Consider adding IP-based restrictions

4. Monitoring and Logging:
   - Enable comprehensive audit logging
   - Monitor for suspicious login attempts
   - Set up alerts for permission changes




Session Configuration Example

apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
data:
  url: https://argocd.somaz.link
  
  # Session settings
  application.instanceLabelKey: argocd.argoproj.io/instance
  admin.enabled: &quot;false&quot;
  timeout.reconciliation: 180s
  
  # Session security settings
  session.duration: &quot;8h&quot;  # Session valid for 8 hours




TLS Configuration

Ensure your ArgoCD instance is properly secured with TLS:

apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cmd-params-cm
  namespace: argocd
data:
  # Disable insecure connections
  server.insecure: &quot;false&quot;
  
  # Enable strict TLS
  server.strict-tls: &quot;true&quot;


For Ingress with TLS:

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: argocd-server-ingress
  namespace: argocd
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/backend-protocol: HTTPS
    # Required for OAuth redirects
    nginx.ingress.kubernetes.io/ssl-passthrough: &quot;true&quot;
spec:
  rules:
  - host: argocd.somaz.link
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: argocd-server
            port:
              name: https
  tls:
  - hosts:
    - argocd.somaz.link
    secretName: argocd-secret-tls




Troubleshooting



Common Issues



Typical Problems and Solutions:

1. Authentication Failed:
   - Check client ID and secret
   - Verify redirect URI configuration
   - Ensure domain settings match
   - Check ArgoCD server URL configuration

2. User Cannot Login:
   - Verify the user&apos;s email domain matches hostedDomains
   - Check RBAC configuration
   - Inspect Dex logs for errors

3. Insufficient Permissions:
   - Review RBAC policy configuration
   - Check user&apos;s group membership
   - Verify scopes include &apos;groups&apos; and &apos;email&apos;

4. Certificate Issues:
   - Ensure SSL certificates are valid
   - Check TLS configuration
   - Verify proper URL redirection




Debug Commands

# Check ArgoCD server logs
kubectl logs -n argocd -l app.kubernetes.io/name=argocd-server

# Check Dex server logs
kubectl logs -n argocd -l app.kubernetes.io/name=argocd-dex-server

# View configuration
kubectl get cm argocd-cm -n argocd -o yaml

# Check RBAC configuration
kubectl get cm argocd-rbac-cm -n argocd -o yaml

# Test network connectivity
kubectl run -it --rm debug --image=curlimages/curl:7.73.0 -- curl -vk https://argocd-server.argocd.svc.cluster.local




Checking Dex Status

# Port forward to Dex metrics
kubectl port-forward -n argocd svc/argocd-dex-server 5558

# In a new terminal
curl localhost:5558/metrics | grep dex




Automating the Setup



Setup Script

Here’s a script to automate the configuration:







Authentication Processes

  OAuth Authentication
  SAML Authentication
  OpenID Connect Authentication




Important Notes

  Consider domain settings, security policies, and network configurations for production environments
  Keep up with the latest documentation as GCP Console and ArgoCD settings may change
  Ensure proper backup before making configuration changes
  Use separate test and production environments for SSO configuration testing




Security Considerations



ArgoCD SSO Security Checklist



Security Checklist:

✅ Use HTTPS with valid certificates
✅ Implement least privilege RBAC policies
✅ Restrict by hosted domains
✅ Enable appropriate session timeouts
✅ Regularly rotate client secrets
✅ Audit SSO access regularly
✅ Backup configurations before changes
✅ Implement network policies
✅ Monitor for suspicious login attempts
✅ Enable multi-factor authentication in Google






References

  ArgoCD SSO with GCP OAuth
  Dex Authentication Documentation
  ArgoCD RBAC Configuration
  Google OAuth 2.0 for Server Applications
  Kubernetes Ingress with TLS

",
            "wordcount": "2136",
            "inLanguage": "en",
            "dateCreated": "2025-03-07/",
            "datePublished": "2025-03-07/",
            "dateModified": "2025-03-07/",
            "author": {
                "@type": "Person",
                "name": "Somaz",
                
                "image": "/assets/img/uploads/profile.png",
                
                "jobTitle": "DevOps Engineer",
                "url": "https://somaz.blog/authors/somaz/",
                "sameAs": [
                    "https://github.com/somaz94","https://www.linkedin.com/in/somaz"
                ]
            },
            "publisher": {
                "@type": "Organization",
                "name": "somaz",
                "url": "https://somaz.blog/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://somaz.blog/assets/img/blog-image.png",
                    "width": "600",
                    "height": "315"
                }
            },
            "mainEntityOfPage": "True",
            "genre": "CICD",
            "articleSection": "CICD",
            "keywords": ["github","kubernetes","helm","cicd"]
        }
        </script>
    </body>
</html>
