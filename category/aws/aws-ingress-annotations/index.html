<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    
    

    
    

    
    

    <!-- ✅ Google Tag Manager 추가 -->
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MBP83N4Q');
    </script>
      <!-- ✅ End Google Tag Manager -->

    <!-- Mermaid.js 직접 로드 -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>

    <title>What is AWS Ingress Annotations? | somaz</title>
    <meta name="description" content="A comprehensive guide to AWS Load Balancer Controller Ingress Annotations">
    
        <meta name="keywords" content="aws, kubernetes, ingress, alb, eks">
    

    <!-- Social: Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="What is AWS Ingress Annotations? | somaz">
    <meta name="twitter:description" content="A comprehensive guide to AWS Load Balancer Controller Ingress Annotations">

    
        <meta property="twitter:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1737362570/ingress-nginx-aws_hxoiqe.png">
    
    
    
        <meta name="twitter:site" content="@twitter_username">
    

    <!-- Social: Facebook / Open Graph -->
    <meta property="og:url" content="https://somaz.blog/category/aws/aws-ingress-annotations/">
    <meta property="og:title" content="What is AWS Ingress Annotations? | somaz">
    <meta property="og:image" content="https://res.cloudinary.com/dkcm26aem/image/upload/v1737362570/ingress-nginx-aws_hxoiqe.png">
    <meta property="og:description" content="A comprehensive guide to AWS Load Balancer Controller Ingress Annotations">
    <meta property="og:site_name" content="Somaz Tech Blog">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/img/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png" />

    <!-- Windows 8 Tile Icons -->
    <meta name="application-name" content="somaz">
    <meta name="msapplication-TileColor" content="#141414">
    <meta name="msapplication-square70x70logo" content="smalltile.png" />
    <meta name="msapplication-square150x150logo" content="mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="widetile.png" />
    <meta name="msapplication-square310x310logo" content="largetile.png" />
    
    <!-- Android Lolipop Theme Color -->
    <meta name="theme-color" content="#141414">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="canonical" href="https://somaz.blog/category/aws/aws-ingress-annotations/">
    <link rel="alternate" type="application/rss+xml" title="Somaz Tech Blog" href="https://somaz.blog/feed.xml" />

    <!-- Include extra styles -->
    

    <!-- JavaScript enabled/disabled -->
    <script>
        document.querySelector('html').classList.remove('no-js');
    </script>

    <!-- Google Adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8725590811736154"
        crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"> -->
    <!-- <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/variable/woff2/SUIT-Variable.css" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;700&display=swap" rel="stylesheet"> -->

    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />

</head>
<!-- ✅ Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBP83N4Q"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- ✅ End Google Tag Manager (noscript) -->
    <body class="has-push-menu">
        





        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-close" viewBox="0 0 1000 1000"><path d="M969.8,870.3c27,27.7,27,71.8,0,99.1C955.7,983,937.9,990,920,990c-17.9,0-35.7-7-49.7-20.7L500,599L129.6,969.4C115.6,983,97.8,990,79.9,990s-35.7-7-49.7-20.7c-27-27.3-27-71.4,0-99.1L400.9,500L30.3,129.3c-27-27.3-27-71.4,0-99.1c27.3-27,71.8-27,99.4,0L500,400.9L870.4,30.2c27.7-27,71.8-27,99.4,0c27,27.7,27,71.8,0,99.1L599.1,500L969.8,870.3z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-clock" viewBox="0 0 1000 1000"><path d="M500,10C229.8,10,10,229.8,10,500c0,270.2,219.8,490,490,490c270.2,0,490-219.8,490-490C990,229.8,770.2,10,500,10z M500,910.2c-226.2,0-410.2-184-410.2-410.2c0-226.2,184-410.2,410.2-410.2c226.2,0,410.2,184,410.2,410.2C910.2,726.1,726.2,910.2,500,910.2z M753.1,374c8.2,11.9,5.2,28.1-6.6,36.3L509.9,573.7c-4.4,3.1-9.6,4.6-14.8,4.6c-4.1,0-8.3-1-12.1-3c-8.6-4.5-14-13.4-14-23.1V202.5c0-14.4,11.7-26.1,26.1-26.1c14.4,0,26.1,11.7,26.1,26.1v300l195.6-135.1C728.7,359.2,744.9,362.1,753.1,374z"/></symbol><symbol id="icon-calendar" viewBox="0 0 1000 1000"><path d="M920,500v420H80V500H920 M990,430H10v490c0,38.7,31.3,70,70,70h840c38.7,0,70-31.3,70-70V430L990,430z"/><path d="M850,80v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80H360v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80C72.8,80,10,142.7,10,220v140h980V220C990,142.7,927.2,80,850,80z"/><path d="M255,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C290,25.8,274.3,10,255,10z"/><path d="M745,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C780,25.8,764.3,10,745,10z"/></symbol><symbol id="icon-github" viewBox="0 0 12 14"><path d="M6 1q1.633 0 3.012 0.805t2.184 2.184 0.805 3.012q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.312-0.055t-0.102-0.234q0-0.023 0.004-0.598t0.004-1.051q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.93-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.664-0.105q-0.352 0.883-0.062 1.594-0.617 0.68-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.305 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.691t0.004 0.426q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805zM2.273 9.617q0.023-0.055-0.055-0.094-0.078-0.023-0.102 0.016-0.023 0.055 0.055 0.094 0.070 0.047 0.102-0.016zM2.516 9.883q0.055-0.039-0.016-0.125-0.078-0.070-0.125-0.023-0.055 0.039 0.016 0.125 0.078 0.078 0.125 0.023zM2.75 10.234q0.070-0.055 0-0.148-0.062-0.102-0.133-0.047-0.070 0.039 0 0.141t0.133 0.055zM3.078 10.562q0.062-0.062-0.031-0.148-0.094-0.094-0.156-0.023-0.070 0.062 0.031 0.148 0.094 0.094 0.156 0.023zM3.523 10.758q0.023-0.086-0.102-0.125-0.117-0.031-0.148 0.055t0.102 0.117q0.117 0.047 0.148-0.047zM4.016 10.797q0-0.102-0.133-0.086-0.125 0-0.125 0.086 0 0.102 0.133 0.086 0.125 0 0.125-0.086zM4.469 10.719q-0.016-0.086-0.141-0.070-0.125 0.023-0.109 0.117t0.141 0.062 0.109-0.109z"></path></symbol><symbol id="icon-medium" viewBox="0 0 1000 1000"><path d="M336.5,240.2v641.5c0,9.1-2.3,16.9-6.8,23.2s-11.2,9.6-20,9.6c-6.2,0-12.2-1.5-18-4.4L37.3,782.7c-7.7-3.6-14.1-9.8-19.4-18.3S10,747.4,10,739V115.5c0-7.3,1.8-13.5,5.5-18.6c3.6-5.1,8.9-7.7,15.9-7.7c5.1,0,13.1,2.7,24.1,8.2l279.5,140C335.9,238.6,336.5,239.5,336.5,240.2L336.5,240.2z M371.5,295.5l292,473.6l-292-145.5V295.5z M990,305.3v576.4c0,9.1-2.6,16.5-7.7,22.1c-5.1,5.7-12,8.5-20.8,8.5s-17.3-2.4-25.7-7.1L694.7,784.9L990,305.3z M988.4,239.7c0,1.1-46.8,77.6-140.3,229.4C754.6,621,699.8,709.8,683.8,735.7L470.5,389l177.2-288.2c6.2-10.2,15.7-15.3,28.4-15.3c5.1,0,9.8,1.1,14.2,3.3l295.9,147.7C987.6,237.1,988.4,238.2,988.4,239.7L988.4,239.7z"/></symbol><symbol id="icon-instagram" viewBox="0 0 489.84 489.84"><path d="M249.62,50.46c65.4,0,73.14.25,99,1.43C372.47,53,385.44,57,394.07,60.32a75.88,75.88,0,0,1,28.16,18.32,75.88,75.88,0,0,1,18.32,28.16c3.35,8.63,7.34,21.6,8.43,45.48,1.18,25.83,1.43,33.57,1.43,99s-0.25,73.14-1.43,99c-1.09,23.88-5.08,36.85-8.43,45.48a81.11,81.11,0,0,1-46.48,46.48c-8.63,3.35-21.6,7.34-45.48,8.43-25.82,1.18-33.57,1.43-99,1.43s-73.15-.25-99-1.43c-23.88-1.09-36.85-5.08-45.48-8.43A75.88,75.88,0,0,1,77,423.86,75.88,75.88,0,0,1,58.69,395.7c-3.35-8.63-7.34-21.6-8.43-45.48-1.18-25.83-1.43-33.57-1.43-99s0.25-73.14,1.43-99c1.09-23.88,5.08-36.85,8.43-45.48A75.88,75.88,0,0,1,77,78.64a75.88,75.88,0,0,1,28.16-18.32c8.63-3.35,21.6-7.34,45.48-8.43,25.83-1.18,33.57-1.43,99-1.43m0-44.13c-66.52,0-74.86.28-101,1.47s-43.87,5.33-59.45,11.38A120.06,120.06,0,0,0,45.81,47.44,120.06,120.06,0,0,0,17.56,90.82C11.5,106.4,7.36,124.2,6.17,150.27s-1.47,34.46-1.47,101,0.28,74.86,1.47,101,5.33,43.87,11.38,59.45a120.06,120.06,0,0,0,28.25,43.38,120.06,120.06,0,0,0,43.38,28.25c15.58,6.05,33.38,10.19,59.45,11.38s34.46,1.47,101,1.47,74.86-.28,101-1.47,43.87-5.33,59.45-11.38a125.24,125.24,0,0,0,71.63-71.63c6.05-15.58,10.19-33.38,11.38-59.45s1.47-34.46,1.47-101-0.28-74.86-1.47-101-5.33-43.87-11.38-59.45a120.06,120.06,0,0,0-28.25-43.38,120.06,120.06,0,0,0-43.38-28.25C394.47,13.13,376.67,9,350.6,7.8s-34.46-1.47-101-1.47h0Z" transform="translate(-4.7 -6.33)" /><path d="M249.62,125.48A125.77,125.77,0,1,0,375.39,251.25,125.77,125.77,0,0,0,249.62,125.48Zm0,207.41a81.64,81.64,0,1,1,81.64-81.64A81.64,81.64,0,0,1,249.62,332.89Z" transform="translate(-4.7 -6.33)"/><circle cx="375.66" cy="114.18" r="29.39" /></symbol><symbol id="icon-linkedin" viewBox="0 0 12 14"><path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"></path></symbol><symbol id="icon-heart" viewBox="0 0 34 30"><path d="M17,29.7 L16.4,29.2 C3.5,18.7 0,15 0,9 C0,4 4,0 9,0 C13.1,0 15.4,2.3 17,4.1 C18.6,2.3 20.9,0 25,0 C30,0 34,4 34,9 C34,15 30.5,18.7 17.6,29.2 L17,29.7 Z M9,2 C5.1,2 2,5.1 2,9 C2,14.1 5.2,17.5 17,27.1 C28.8,17.5 32,14.1 32,9 C32,5.1 28.9,2 25,2 C21.5,2 19.6,4.1 18.1,5.8 L17,7.1 L15.9,5.8 C14.4,4.1 12.5,2 9,2 Z" id="Shape"></path></symbol><symbol id="icon-arrow-right" viewBox="0 0 25.452 25.452"><path d="M4.471,24.929v-2.004l12.409-9.788c0.122-0.101,0.195-0.251,0.195-0.411c0-0.156-0.073-0.31-0.195-0.409L4.471,2.526V0.522c0-0.2,0.115-0.384,0.293-0.469c0.18-0.087,0.396-0.066,0.552,0.061l15.47,12.202c0.123,0.1,0.195,0.253,0.195,0.409c0,0.16-0.072,0.311-0.195,0.411L5.316,25.34c-0.155,0.125-0.372,0.147-0.552,0.061C4.586,25.315,4.471,25.13,4.471,24.929z"/></symbol><symbol id="icon-star" viewBox="0 0 48 48"><path fill="currentColor" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"/><path fill="#ffffff" d="M24,11l3.898,7.898l8.703,1.301l-6.301,6.102l1.5,8.699L24,30.898L16.199,35l1.5-8.699l-6.301-6.102  l8.703-1.301L24,11z"/></symbol><symbol id="icon-read" viewBox="0 0 32 32"><path fill="currentColor" d="M29,4H3C1.343,4,0,5.343,0,7v18c0,1.657,1.343,3,3,3h10c0,0.552,0.448,1,1,1h4c0.552,0,1-0.448,1-1h10  c1.657,0,3-1.343,3-3V7C32,5.343,30.657,4,29,4z M29,5v20H18.708c-0.618,0-1.236,0.146-1.789,0.422l-0.419,0.21V5H29z M15.5,5  v20.632l-0.419-0.21C14.528,25.146,13.91,25,13.292,25H3V5H15.5z M31,25c0,1.103-0.897,2-2,2H18v1h-4v-1H3c-1.103,0-2-0.897-2-2V7  c0-0.737,0.405-1.375,1-1.722V25c0,0.552,0.448,1,1,1h10.292c0.466,0,0.925,0.108,1.342,0.317l0.919,0.46  c0.141,0.07,0.294,0.106,0.447,0.106c0.153,0,0.306-0.035,0.447-0.106l0.919-0.46C17.783,26.108,18.242,26,18.708,26H29  c0.552,0,1-0.448,1-1V5.278C30.595,5.625,31,6.263,31,7V25z M6,12.5C6,12.224,6.224,12,6.5,12h5c0.276,0,0.5,0.224,0.5,0.5  S11.776,13,11.5,13h-5C6.224,13,6,12.776,6,12.5z M6,14.5C6,14.224,6.224,14,6.5,14h5c0.276,0,0.5,0.224,0.5,0.5S11.776,15,11.5,15  h-5C6.224,15,6,14.776,6,14.5z M6,16.5C6,16.224,6.224,16,6.5,16h5c0.276,0,0.5,0.224,0.5,0.5S11.776,17,11.5,17h-5  C6.224,17,6,16.776,6,16.5z M20,12.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,13,25.5,13h-5  C20.224,13,20,12.776,20,12.5z M20,14.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,15,25.5,15h-5  C20.224,15,20,14.776,20,14.5z M20,16.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,17,25.5,17h-5  C20.224,17,20,16.776,20,16.5z"></path></symbol><symbol id="icon-tistory" viewBox="0 0 24 24"><path d="M4 4h16v3h-6v13h-4V7H4V4z"/></symbol></defs></svg>

        <header class="bar-header">
    <a id="menu" role="button">
        <svg id="open" class="icon-menu"><use xlink:href="#icon-menu"></use></svg>
    </a>
    <h1 class="logo">
        <a href="/">
            
                somaz <span class="version">v3.1.2</span>
            
        </a>
    </h1>
    <a id="search" class="dosearch" role="button">
        <svg class="icon-search"><use xlink:href="#icon-search"></use></svg>
    </a>
    
        <a href="https://github.com/thiagorossener/jekflix-template" class="get-theme" role="button">
            Get this theme!
        </a>
    
</header>

<div id="mask" class="overlay"></div>

<aside class="sidebar" id="sidebar">
    <nav id="navigation">
      <h2>Menu</h2>
      <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>

    </nav>
</aside>

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search">
        <svg class="icon-remove-sign"><use xlink:href="#icon-close"></use></svg>
        <ul class="search-results search-list"></ul>
    </div>
</div>



        <section class="post two-columns">
            <article role="article" class="post-content">
                <p class="post-info">
                    
                        <svg class="icon-calendar" id="date"><use xlink:href="#icon-calendar"></use></svg>
                        <time class="date" datetime="2025-03-31T00:00:00+00:00">
                            


March 31, 2025

                        </time>
                    
                    <svg id="clock" class="icon-clock"><use xlink:href="#icon-clock"></use></svg>
                    <span>22 min to read</span>
                </p>
                <h1 class="post-title">What is AWS Ingress Annotations?</h1>
                <p class="post-subtitle"></p>

                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/v1737362570/ingress-nginx-aws_hxoiqe.png" alt="Featured image" class="post-cover">
                

                <!-- Pagination links -->



                <!-- Add your table of contents here -->


                <p><a href="https://aws.amazon.com/ko/blogs/containers/exposing-kubernetes-applications-part-3-nginx-ingress-controller/">image reference link</a></p>

<p><br /></p>

<hr />

<h2 id="overview">Overview</h2>
<p>Learn about AWS Load Balancer Controller Ingress Annotations and how they manage traffic routing to Kubernetes services using Application Load Balancers (ALB).</p>

<p>These annotations provide a powerful way to customize and configure how external traffic is routed to your applications running on EKS or other Kubernetes deployments on AWS.</p>

<p><br /></p>

<h3 id="what-is-ingress-annotations">What is Ingress Annotations?</h3>
<p>In AWS, the AWS load balancer controller configures and manages the behavior of the Application Load Balancer (ALB) that routes traffic to the Kubernetes service using annotations for incoming resources.</p>

<p>Annotations allow you to specify settings such as SSL, routing behavior, and security groups directly within the Kubernetes Ingress resource.</p>

<p><br /></p>

<h3 id="how-load-balancer-controller-works">How Load Balancer Controller Works</h3>

<ul>
  <li><strong>Resource Creation</strong>: Create or update ALBs, their listeners, and target groups based on the specified annotations.</li>
  <li><strong>Management</strong>: Manage status checks, security settings, routing rules, SSL certificates, and other defined configurations.</li>
  <li><strong>Dynamic Updates</strong>: When annotations change, the controller updates ALB with new settings without manual intervention, allowing Kubernetes native resources to manage complex configurations.</li>
  <li><strong>Integration with AWS</strong>: The controller integrates directly with AWS services, automatically provisioning AWS resources and connecting them to your Kubernetes resources.</li>
</ul>

<p><br /></p>

<h3 id="ingress-groups">Ingress Groups</h3>

<ul>
  <li>In AWS, ingress group is a feature that allows multiple ingress resources to be integrated into a single load balancer (ALB) for more efficient management.</li>
  <li>This allows applications from different Kubernetes namespaces or different teams to share the same ALB while setting different Ingress rules.</li>
  <li>Ingress groups can significantly reduce costs and increase management efficiency by consolidating multiple ALBs into a single one.</li>
  <li>By default, ingress does not belong to an ingress group (it exists as an “implicit ingress group”), functioning as an independent entity with its own ALB.</li>
</ul>

<h4 id="ingress-group-name-settings">Ingress Group Name Settings</h4>

<ul>
  <li>Use the <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/group.name</code> annotation to define the group name.</li>
  <li>Ingress resources with the same group name will share one ALB, consolidating resources.</li>
  <li>The ALB assigned to an ingress group is tagged with <code class="language-plaintext highlighter-rouge">ingress.k8s.aws/stack</code> and the group name as the value.</li>
  <li>For resources that do not use ingress groups, the tag value is set in the format of <code class="language-plaintext highlighter-rouge">namespace/ingressname</code>.</li>
  <li>If you change the groupName assigned to an ingress resource, the ingress moves from the existing group to a new ingress Group, managed by the ALB of the new group.</li>
  <li>If there is no ALB in the new IngressGroup, a new ALB is automatically created.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/group.name: my-team.awesome-group</code></li>
</ul>

<h4 id="ingress-group-ranking">Ingress Group Ranking</h4>

<ul>
  <li>You can specify the order using the <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/group.order</code> annotation.</li>
  <li>The ingress rule with a lower order value is applied first, allowing you to prioritize specific rules when multiple ingresses share the same path or host.</li>
  <li>This is particularly useful when you have overlapping rule definitions and need to ensure specific traffic patterns are handled correctly.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/group.order: 10</code></li>
</ul>

<h4 id="ingress-group-example">Ingress Group Example</h4>

<p>In the example below, two ingress resources share a group called my-shared-group, so one ALB processes the request.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Ingress for Service A</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">service-a-ingress</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">alb.ingress.kubernetes.io/group.name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-shared-group"</span>
    <span class="na">alb.ingress.kubernetes.io/group.order</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10"</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s2">"</span><span class="s">service-a.example.com"</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">service-a</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>

<span class="c1"># Ingress for Service B</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">service-b-ingress</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">alb.ingress.kubernetes.io/group.name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-shared-group"</span>
    <span class="na">alb.ingress.kubernetes.io/group.order</span><span class="pi">:</span> <span class="s2">"</span><span class="s">20"</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s2">"</span><span class="s">service-b.example.com"</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">service-b</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div>
<ul>
  <li>In this example, <code class="language-plaintext highlighter-rouge">service-a</code> and <code class="language-plaintext highlighter-rouge">service-b</code> both belong to the ingress group <code class="language-plaintext highlighter-rouge">my-shared-group</code>, with <code class="language-plaintext highlighter-rouge">service-a</code> having priority (order 10) over <code class="language-plaintext highlighter-rouge">service-b</code> (order 20).</li>
  <li>This means both services will be exposed through the same ALB, reducing costs and simplifying management.</li>
</ul>

<p><br /></p>

<hr />

<h3 id="ingress-traffic-listening">Ingress Traffic Listening</h3>

<h4 id="listen-ports-specify-ports-for-alb">listen-ports: Specify ports for ALB</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[{</span><span class="s2">"HTTP"</span>: 80<span class="o">}</span>, <span class="o">{</span><span class="s2">"HTTPS"</span>: 443<span class="o">}]</span>
</code></pre></div></div>

<h4 id="ssl-redirect-enable-ssl-redirection">ssl-redirect: Enable SSL redirection</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'443'</span>
</code></pre></div></div>

<h4 id="ip-address-type-ipv4-or-dualstack-support">ip-address-type: IPv4 or dualstack support</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ipv4 or dualstack
</code></pre></div></div>

<h4 id="waf-acl-id-associate-aws-waf-webacl">waf-acl-id: Associate AWS WAF WebACL</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arn:aws:wafv2:region:account:webacl/my-web-acl/id
</code></pre></div></div>

<p><br /></p>

<h4 id="listen-ports">listen-ports</h4>

<ul>
  <li>Specifies the port(s) that the ALB listens on for incoming traffic.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}, {"HTTP": 8080}, {"HTTPS": 8443}]'</code></li>
  <li>Since it applies to all Ingress within IngressGroup, each Ingress can define its own port, and the rule applies only to the ports specified in each Ingress.</li>
  <li>If the same receiving port is defined by multiple ingress within the IngressGroup, it is applied in the order of the IngressGroup.</li>
  <li>Default behavior:
    <ul>
      <li>If listen-ports is not specified and no certificate is configured, the default is <code class="language-plaintext highlighter-rouge">{"HTTP": 80}</code></li>
      <li>If a certificate is provided, the default becomes <code class="language-plaintext highlighter-rouge">{"HTTPS": 443}</code></li>
    </ul>
  </li>
  <li>Warning: You cannot have duplicate load balancer ports in the same group (Exception: when <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/group.order</code> is specified)</li>
  <li>Since ALB integrates these settings for all Ingress in the group, defining listen-ports in one Ingress in the IngressGroup is sufficient.</li>
</ul>

<h4 id="ssl-redirect">ssl-redirect</h4>

<ul>
  <li>Enables SSL redirection by specifying the port to which HTTP traffic is redirected, typically HTTPS port 443.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/ssl-redirect: '443'</code></li>
  <li>SSL redirection affects all ingress in the group if defined in the ingressGroup.</li>
  <li>When SSL redirection is enabled, all HTTP listeners are configured by default to redirect to HTTPS, ignoring other HTTP rules.</li>
  <li>This is recommended for production environments to ensure secure communication.</li>
</ul>

<h4 id="ip-address-type">ip-address-type</h4>

<ul>
  <li>Specifies whether ALB should use ipv4 or dualstack for IPv4 and IPv6 traffic support.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/ip-address-type: ipv4</code> or <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/ip-address-type: dualstack</code></li>
  <li><code class="language-plaintext highlighter-rouge">ipv4</code>: Configure ALB to use only IPv4 addresses, i.e., handle IPv4 traffic exclusively.</li>
  <li><code class="language-plaintext highlighter-rouge">dualstack</code>: ALB supports both IPv4 and IPv6 traffic. When set to dualstack, ALB has both IPv4 and IPv6 addresses, allowing traffic to be routed in both address types.</li>
  <li>Note: For dualstack to work properly, your VPC and subnets must be configured to support IPv6.</li>
</ul>

<h4 id="waf-acl-id">waf-acl-id</h4>

<ul>
  <li>Associates a AWS WAF WebACL with your ALB for additional security protections.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/waf-acl-id: arn:aws:wafv2:region:account:webacl/my-web-acl/id</code></li>
  <li>The WebACL provides protection against common web exploits like SQL injection, cross-site scripting, and more.</li>
  <li>For this to work, the appropriate IAM permissions must be granted to the load balancer controller.</li>
</ul>

<h4 id="customer-owned-ipv4-pool">customer-owned-ipv4-pool</h4>

<ul>
  <li>Specifies the customer-owned IPv4 address pool for ALB when using the Outpost environment.</li>
  <li>Warning: This annotation cannot be changed after creation, and you will need to recreate the Ingress to change it.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/customer-owned-ipv4-pool: ipv4pool-coip-xxxxxxx</code></li>
  <li>This is specifically useful for AWS Outposts deployments where you might want to use your on-premises IP addresses.</li>
</ul>

<h4 id="full-example">Full Example</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">secure-app-ingress</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">alb.ingress.kubernetes.io/listen-ports</span><span class="pi">:</span> <span class="s1">'</span><span class="s">[{"HTTP":</span><span class="nv"> </span><span class="s">80},</span><span class="nv"> </span><span class="s">{"HTTPS":</span><span class="nv"> </span><span class="s">443}]'</span>
    <span class="na">alb.ingress.kubernetes.io/ssl-redirect</span><span class="pi">:</span> <span class="s1">'</span><span class="s">443'</span>
    <span class="na">alb.ingress.kubernetes.io/certificate-arn</span><span class="pi">:</span> <span class="s1">'</span><span class="s">arn:aws:acm:region:account:certificate/cert-id'</span>
    <span class="na">alb.ingress.kubernetes.io/ip-address-type</span><span class="pi">:</span> <span class="s1">'</span><span class="s">dualstack'</span>
    <span class="na">alb.ingress.kubernetes.io/waf-acl-id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">arn:aws:wafv2:region:account:webacl/my-web-acl/id'</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">ingressClassName</span><span class="pi">:</span> <span class="s">alb</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">secure-app.example.com</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">secure-app-service</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h3 id="ingress-traffic-routing">Ingress Traffic Routing</h3>

<h5 id="load-balancer-name-specify-custom-alb-name">load-balancer-name: Specify custom ALB name</h5>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>my-awesome-alb
</code></pre></div></div>

<h4 id="target-type-routing-to-instances-or-ip-addresses">target-type: Routing to instances or IP addresses</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>instance or ip
</code></pre></div></div>

<h4 id="backend-protocol-protocol-for-backend-traffic">backend-protocol: Protocol for backend traffic</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP, HTTPS
</code></pre></div></div>

<h4 id="target-group-attributes-target-group-configuration">target-group-attributes: Target group configuration</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stickiness.enabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="load-balancer-name">load-balancer-name</h4>

<ul>
  <li>Allows you to specify a custom name for the ALB created by the controller.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/load-balancer-name: my-app-alb</code></li>
  <li>All Ingress resources within an IngressGroup must use the same load balancer name.</li>
  <li>The name cannot exceed 32 characters, and an error occurs when this limit is exceeded.</li>
  <li>This is useful for easier identification and management of resources in the AWS console.</li>
</ul>

<h4 id="target-type">target-type</h4>

<ul>
  <li>Defines how traffic from the load balancer should be routed to your application.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/target-type: instance</code> or <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/target-type: ip</code></li>
  <li><strong>instance mode</strong>:
    <ul>
      <li>Routes traffic to all EC2 instances in the cluster via NodePort that is open for the service.</li>
      <li>When using instance mode, the service must use NodePort or LoadBalancer type.</li>
      <li>This is the default and works well for most standard deployments.</li>
    </ul>
  </li>
  <li><strong>ip mode</strong>:
    <ul>
      <li>Routes traffic directly to the pod IPs.</li>
      <li>The network plugin must use the secondary IP address of the ENI for pod IPs to use ip mode (e.g., amazon-vpc-cni-k8s).</li>
      <li>IP mode is required for sticky sessions to work with application load balancer.</li>
      <li>Service type is not important when using ip mode.</li>
      <li>This mode offers more direct routing but has specific network requirements.</li>
    </ul>
  </li>
</ul>

<h4 id="target-node-labels">target-node-labels</h4>

<ul>
  <li>Specifies which nodes should be included in the target group registration when using the instance target type.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/target-node-labels: label1=value1, label2=value2</code></li>
  <li>This is useful for directing traffic to specific node groups (e.g., sending certain traffic only to GPU nodes).</li>
  <li>Only nodes with matching labels will be registered as targets in the ALB’s target group.</li>
</ul>

<h4 id="backend-protocol">backend-protocol</h4>

<ul>
  <li>Specifies the protocol used to route traffic to your service backends.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/backend-protocol: HTTPS</code></li>
  <li>Supported values: HTTP, HTTPS, TCP, TLS, UDP, TCP_UDP</li>
  <li>Default is HTTP if not specified.</li>
  <li>Should match the protocol your application is listening on.</li>
  <li>Using HTTPS or TLS requires proper SSL configuration on your application.</li>
</ul>

<h4 id="backend-protocol-version">backend-protocol-version</h4>

<ul>
  <li>Specifies the application protocol version used to route traffic to the pods.</li>
  <li>Example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/backend-protocol-version: HTTP2</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/backend-protocol-version: GRPC</code></li>
    </ul>
  </li>
  <li>Only valid when HTTP or HTTPS is used as a backend protocol.</li>
  <li>Useful for modern applications that leverage HTTP/2 or gRPC for more efficient communication.</li>
</ul>

<h4 id="target-group-attributes">target-group-attributes</h4>

<ul>
  <li>Allows you to set attributes for the target groups created by the controller.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/target-group-attributes: stickiness.enabled=true</code></li>
  <li>Common use cases include:
    <ul>
      <li>Setting up sticky sessions</li>
      <li>Configuring deregistration delay</li>
      <li>Adjusting health check settings</li>
      <li>Load balancing algorithm tuning</li>
    </ul>
  </li>
</ul>

<h4 id="health-check--annotations">health-check-* annotations</h4>

<ul>
  <li>A set of annotations to configure the health check behavior for your service.</li>
  <li>Examples:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/healthcheck-protocol: HTTP</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/healthcheck-port: traffic-port</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/healthcheck-path: /health</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/healthcheck-interval-seconds: '15'</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/healthcheck-timeout-seconds: '5'</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/success-codes: '200'</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/healthy-threshold-count: '2'</code></li>
      <li><code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/unhealthy-threshold-count: '2'</code></li>
    </ul>
  </li>
  <li>These settings determine how the ALB checks if your application is healthy and ready to receive traffic.</li>
</ul>

<h4 id="actionsaction-name-and-conditionsconditions-name">actions.${action-name} and conditions.${conditions-name}</h4>

<ul>
  <li>Provides a method for configuring advanced load balancer listener rules beyond what is possible with standard Ingress specifications.</li>
  <li><code class="language-plaintext highlighter-rouge">actions.${action-name}</code>: Defines what should happen for a specific rule, like redirects or fixed responses.</li>
  <li><code class="language-plaintext highlighter-rouge">conditions.${conditions-name}</code>: Defines additional matching conditions beyond host/path.</li>
  <li>The serviceName in these annotations should match the serviceName in the Ingress rule, and the servicePort should be set to “use-annotation”.</li>
</ul>

<p>Here’s an example showing how to use advanced actions and conditions:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ingress</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">alb.ingress.kubernetes.io/scheme</span><span class="pi">:</span> <span class="s">internet-facing</span>
    <span class="na">alb.ingress.kubernetes.io/actions.rule-path1</span><span class="pi">:</span> <span class="pi">&gt;</span>
      <span class="s">{"type":"fixed-response","fixedResponseConfig":{"contentType":"text/plain","statusCode":"200","messageBody":"Host is www.example.com OR anno.example.com"}}</span>
    <span class="na">alb.ingress.kubernetes.io/conditions.rule-path1</span><span class="pi">:</span> <span class="pi">&gt;</span>
      <span class="s">[{"field":"host-header","hostHeaderConfig":{"values":["anno.example.com"]}}]</span>
    <span class="c1"># More actions and conditions...</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">ingressClassName</span><span class="pi">:</span> <span class="s">alb</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">www.example.com</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/path1</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Exact</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">rule-path1</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">name</span><span class="pi">:</span> <span class="s">use-annotation</span>
          <span class="c1"># More paths...</span>
</code></pre></div></div>

<p>These advanced rules allow for complex traffic routing scenarios including:</p>
<ul>
  <li>Multiple host conditions</li>
  <li>Path pattern matching</li>
  <li>HTTP header-based routing</li>
  <li>HTTP method-based routing</li>
  <li>Query string parameter routing</li>
  <li>Source IP filtering</li>
  <li>Combinations of multiple conditions</li>
</ul>

<p><br /></p>

<hr />

<h3 id="ingress-access-control">Ingress Access Control</h3>

<p><br /></p>

<p><strong>Scheme</strong>: Define ALB as internal or internet-facing</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alb.ingress.kubernetes.io/scheme
</code></pre></div></div>

<p><br /></p>

<p><strong>CIDR</strong>: Restrict IP ranges</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alb.ingress.kubernetes.io/inbound-cidrs
</code></pre></div></div>

<p><br /></p>

<p><strong>Security Groups</strong>: Specify security groups</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alb.ingress.kubernetes.io/security-groups
</code></pre></div></div>

<p><br /></p>

<p><strong>Subnet Discovery</strong>: Specify subnets for ALB</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alb.ingress.kubernetes.io/subnets
</code></pre></div></div>

<p><br /></p>

<p><strong>Auth</strong>: Configure authentication</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alb.ingress.kubernetes.io/auth-<span class="k">*</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="scheme">scheme</h4>

<ul>
  <li>Used to define whether the ALB should be accessible from the internet or only within your VPC.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/scheme: internal</code> or <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/scheme: internet-facing</code></li>
  <li><code class="language-plaintext highlighter-rouge">internet-facing</code>: Makes ALB accessible publicly via the internet. The ALB will have a public IP and DNS name.</li>
  <li><code class="language-plaintext highlighter-rouge">internal</code>: Makes ALB private by restricting it to be accessible only within a VPC or connected networks.</li>
  <li>Use <code class="language-plaintext highlighter-rouge">internal</code> for services that should only be accessible within your private network, and <code class="language-plaintext highlighter-rouge">internet-facing</code> for public-facing applications.</li>
  <li>This setting affects all Ingress resources within an IngressGroup.</li>
</ul>

<h4 id="inbound-cidrs">inbound-cidrs</h4>

<ul>
  <li>Restricts access to the ALB by allowing only the specified IP ranges (CIDRs) to connect.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/inbound-cidrs: 10.0.0.0/24, 192.168.1.0/24</code></li>
  <li>Particularly useful for controlling access to private applications or internal resources by limiting the range of IPs that can access the ALB.</li>
  <li>If Ingress is part of an IngressGroup, the inbound-cidrs annotation applies to all Ingress resources in the group.</li>
  <li>However, inbound-cidrs applies only to ports defined in that specific Ingress.</li>
  <li>If multiple ingresses share the same ingress port, you must define inbound-cidrs on only one of those ingresses to prevent collisions.</li>
  <li>Specifying <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/security-groups</code> in Ingress will cause inbound-cidrs annotations to be ignored.</li>
  <li>Default behavior if not specified:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">0.0.0.0/0</code> (all IPv4 addresses) will be allowed if the ALB’s IPAddressType is set to ipv4.</li>
      <li><code class="language-plaintext highlighter-rouge">0.0.0.0/0</code> and <code class="language-plaintext highlighter-rouge">::/0</code> (all IPv4 and IPv6 addresses) will be allowed if the ALB’s IPAddressType is set to dualstack.</li>
    </ul>
  </li>
</ul>

<h4 id="security-groups">security-groups</h4>

<ul>
  <li>Specifies the security groups to attach to the load balancer.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/security-groups: sg-xxxx, nameOfSg1, nameOfSg2</code></li>
  <li>You can specify security groups by ID or by name.</li>
  <li>Without this annotation, the controller automatically creates a security group, attaches it to the load balancer, and configures it to allow traffic on the listen-ports from the inbound-cidrs.</li>
  <li>The controller also modifies this security group to allow inbound traffic to the Node/Pod security groups.</li>
  <li>Use this annotation when you want to apply your own custom security group policies.</li>
</ul>

<h4 id="manage-backend-security-group-rules">manage-backend-security-group-rules</h4>

<ul>
  <li>Controls whether the controller should manage security group rules for traffic from the ALB to backend targets.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/manage-backend-security-group-rules: "true"</code></li>
  <li>This only applies when you specify custom security groups using the <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/security-groups</code> annotation.</li>
  <li>Setting this to <code class="language-plaintext highlighter-rouge">"false"</code> means you’ll need to manually configure the rules to allow traffic from the ALB to your backend pods/nodes.</li>
</ul>

<h4 id="subnets">subnets</h4>

<ul>
  <li>Specifies which subnets the ALB should be created in.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/subnets: subnet-xxxx, subnet-yyyy, subnet-zzzz</code></li>
  <li>You can specify subnets by ID or by tags.</li>
  <li>By default, the controller automatically discovers subnets with the appropriate tags.</li>
  <li>For internet-facing ALBs, the controller looks for subnets tagged with <code class="language-plaintext highlighter-rouge">kubernetes.io/role/elb: 1</code>.</li>
  <li>For internal ALBs, it looks for subnets tagged with <code class="language-plaintext highlighter-rouge">kubernetes.io/role/internal-elb: 1</code>.</li>
  <li>This annotation is useful when you need to override the automatic subnet discovery.</li>
</ul>

<h4 id="auth-type-and-related-annotations">auth-type and related annotations</h4>

<p>The AWS Load Balancer Controller supports various authentication mechanisms through annotations:</p>

<h5 id="oidc-authentication">OIDC Authentication</h5>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">alb.ingress.kubernetes.io/auth-type</span><span class="pi">:</span> <span class="s">oidc</span>
<span class="na">alb.ingress.kubernetes.io/auth-idp-oidc-config</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{"issuer":"https://example.com","secretName":"oidc-secret"}'</span>
<span class="na">alb.ingress.kubernetes.io/auth-on-unauthenticated-request</span><span class="pi">:</span> <span class="s">authenticate</span>
<span class="na">alb.ingress.kubernetes.io/auth-scope</span><span class="pi">:</span> <span class="s">openid</span>
</code></pre></div></div>

<h5 id="cognito-authentication">Cognito Authentication</h5>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">alb.ingress.kubernetes.io/auth-type</span><span class="pi">:</span> <span class="s">cognito</span>
<span class="na">alb.ingress.kubernetes.io/auth-idp-cognito</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{"userPoolARN":"arn:aws:cognito-idp:region:account:userpool/id","userPoolClientID":"client-id"}'</span>
<span class="na">alb.ingress.kubernetes.io/auth-on-unauthenticated-request</span><span class="pi">:</span> <span class="s">authenticate</span>
<span class="na">alb.ingress.kubernetes.io/auth-scope</span><span class="pi">:</span> <span class="s">openid</span>
</code></pre></div></div>

<p>These authentication mechanisms allow you to secure your applications by ensuring users are authenticated before accessing them.</p>

<h4 id="example-securing-an-internal-application">Example: Securing an Internal Application</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">secure-internal-app</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">alb.ingress.kubernetes.io/scheme</span><span class="pi">:</span> <span class="s">internal</span>
    <span class="na">alb.ingress.kubernetes.io/inbound-cidrs</span><span class="pi">:</span> <span class="s">10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16</span>
    <span class="na">alb.ingress.kubernetes.io/security-groups</span><span class="pi">:</span> <span class="s">sg-private-apps</span>
    <span class="na">alb.ingress.kubernetes.io/auth-type</span><span class="pi">:</span> <span class="s">cognito</span>
    <span class="na">alb.ingress.kubernetes.io/auth-idp-cognito</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{"userPoolARN":"arn:aws:cognito-idp:region:account:userpool/id","userPoolClientID":"client-id"}'</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">ingressClassName</span><span class="pi">:</span> <span class="s">alb</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">internal-app.company.local</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">internal-app</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div>

<p>This example creates an internal ALB that:</p>
<ul>
  <li>Is only accessible from private IP ranges</li>
  <li>Uses a specific security group</li>
  <li>Requires Cognito authentication</li>
  <li>Routes traffic to an internal application</li>
</ul>

<p><br /></p>

<hr />

<h3 id="ssltls-configuration">SSL/TLS Configuration</h3>

<h4 id="certificate-arn-arn-of-acm-certificate">certificate-arn: ARN of ACM certificate</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arn:aws:acm:region:account:certificate/cert-id
</code></pre></div></div>

<h4 id="ssl-policy-security-policy-for-tls">ssl-policy: Security policy for TLS</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ELBSecurityPolicy-TLS-1-2-2017-01
</code></pre></div></div>

<h4 id="ssl-redirect-redirect-http-to-https">ssl-redirect: Redirect HTTP to HTTPS</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'443'</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="certificate-arn">certificate-arn</h4>

<ul>
  <li>Specifies the ARN of an AWS Certificate Manager (ACM) certificate to use for TLS termination.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:region:account:certificate/cert-id</code></li>
  <li>You can specify multiple certificate ARNs by separating them with commas.</li>
  <li>The first certificate in the list will be the default certificate.</li>
  <li>When multiple certificates are provided, the ALB will use Server Name Indication (SNI) to select the appropriate certificate based on the client’s requested hostname.</li>
  <li>If you’re using IngressGroups, all ingresses in the group should use the same certificates to avoid conflicts.</li>
</ul>

<h4 id="ssl-policy">ssl-policy</h4>

<ul>
  <li>Defines the security policy that determines which ciphers and protocols are supported by the ALB.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/ssl-policy: ELBSecurityPolicy-TLS-1-2-2017-01</code></li>
  <li>AWS provides several predefined policies:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ELBSecurityPolicy-2016-08</code>: Recommended for general use</li>
      <li><code class="language-plaintext highlighter-rouge">ELBSecurityPolicy-TLS-1-2-2017-01</code>: Supports TLS 1.2 only</li>
      <li><code class="language-plaintext highlighter-rouge">ELBSecurityPolicy-TLS-1-1-2017-01</code>: Supports TLS 1.1 and later</li>
      <li><code class="language-plaintext highlighter-rouge">ELBSecurityPolicy-2015-05</code>: Older policy with broader compatibility</li>
      <li><code class="language-plaintext highlighter-rouge">ELBSecurityPolicy-FS-2018-06</code>: Forward secrecy policy</li>
    </ul>
  </li>
  <li>Choose a policy that balances security and compatibility with your users’ browsers/clients.</li>
  <li>For maximum security, use <code class="language-plaintext highlighter-rouge">ELBSecurityPolicy-FS-1-2-Res-2020-10</code> which supports only secure ciphers and TLS 1.2+.</li>
</ul>

<h4 id="example-configuring-https-with-multiple-certificates">Example: Configuring HTTPS with Multiple Certificates</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multi-domain-app</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">alb.ingress.kubernetes.io/scheme</span><span class="pi">:</span> <span class="s">internet-facing</span>
    <span class="na">alb.ingress.kubernetes.io/listen-ports</span><span class="pi">:</span> <span class="s1">'</span><span class="s">[{"HTTP":</span><span class="nv"> </span><span class="s">80},</span><span class="nv"> </span><span class="s">{"HTTPS":</span><span class="nv"> </span><span class="s">443}]'</span>
    <span class="na">alb.ingress.kubernetes.io/certificate-arn</span><span class="pi">:</span> <span class="pi">&gt;-</span>
      <span class="s">arn:aws:acm:region:account:certificate/cert1,</span>
      <span class="s">arn:aws:acm:region:account:certificate/cert2</span>
    <span class="na">alb.ingress.kubernetes.io/ssl-policy</span><span class="pi">:</span> <span class="s">ELBSecurityPolicy-FS-2018-06</span>
    <span class="na">alb.ingress.kubernetes.io/ssl-redirect</span><span class="pi">:</span> <span class="s1">'</span><span class="s">443'</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">ingressClassName</span><span class="pi">:</span> <span class="s">alb</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">app.example.com</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">app-service</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>
    <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">app.another-domain.com</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">paths</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
            <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
            <span class="na">backend</span><span class="pi">:</span>
              <span class="na">service</span><span class="pi">:</span>
                <span class="na">name</span><span class="pi">:</span> <span class="s">app-service</span>
                <span class="na">port</span><span class="pi">:</span>
                  <span class="na">number</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div>

<p>This example:</p>
<ul>
  <li>Configures the ALB to listen on both HTTP (80) and HTTPS (443)</li>
  <li>Uses two different SSL certificates (the ALB will select the right one based on the domain)</li>
  <li>Enforces a strong SSL policy with forward secrecy</li>
  <li>Redirects all HTTP traffic to HTTPS</li>
</ul>

<p><br /></p>

<hr />

<h3 id="advanced-features-and-use-cases">Advanced Features and Use Cases</h3>

<h4 id="cross-zone-load-balancing-even-distribution-across-azs">Cross-Zone Load Balancing: Even distribution across AZs</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load_balancing.cross_zone.enabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<h4 id="idle-timeout-connection-idle-time">Idle Timeout: Connection idle time</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>idle_timeout.timeout_seconds<span class="o">=</span>60
</code></pre></div></div>

<h4 id="http2-support-enable-http2-protocol">HTTP/2 Support: Enable HTTP/2 protocol</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>routing.http2.enabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<h4 id="access-logging-log-traffic-to-s3">Access Logging: Log traffic to S3</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>access_logs.s3.enabled<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="cross-zone-load-balancing">Cross-Zone Load Balancing</h4>

<ul>
  <li>Controls whether load balancing is distributed across all availability zones.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/load-balancer-attributes: load_balancing.cross_zone.enabled=true</code></li>
  <li>Ensures even distribution of traffic across all registered targets regardless of AZ.</li>
</ul>

<h4 id="idle-timeout">Idle Timeout</h4>

<ul>
  <li>Configures how long connections can remain idle before being closed.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=60</code></li>
  <li>Default is 60 seconds, but can be increased for applications with longer processing times.</li>
</ul>

<h4 id="http2-support">HTTP/2 Support</h4>

<ul>
  <li>Enables HTTP/2 support on the ALB.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/load-balancer-attributes: routing.http2.enabled=true</code></li>
  <li>HTTP/2 offers improved performance through binary framing, multiplexing, and header compression.</li>
</ul>

<h4 id="access-logging">Access Logging</h4>

<ul>
  <li>Configures ALB access logs to be stored in an S3 bucket.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">alb.ingress.kubernetes.io/load-balancer-attributes: access_logs.s3.enabled=true,access_logs.s3.bucket=my-log-bucket,access_logs.s3.prefix=my-app-logs</code></li>
  <li>Useful for troubleshooting, security analysis, and traffic monitoring.</li>
</ul>

<p><br /></p>

<h3 id="best-practices">Best Practices</h3>

<div class="info-box info-box-success-not-check">
<br />
<strong>1. Ingress Groups:</strong>
<ul>
   <li>Use meaningful group names that reflect the application or team</li>
   <li>Set appropriate order values (10, 20, 30) with gaps to allow for future insertions</li>
   <li>Share ALBs efficiently by grouping related services</li>
   <li>Keep group membership stable to avoid unnecessary ALB creation/deletion</li>
</ul>

<strong>2. Security:</strong>
<ul>
   <li>Use appropriate scheme (internal for private services, internet-facing for public)</li>
   <li>Implement CIDR restrictions to limit access to trusted IP ranges</li>
   <li>Configure security groups with least privilege access</li>
   <li>Enable access logging for security monitoring</li>
   <li>Use WAF for additional layer of protection</li>
   <li>Use strong SSL policies and redirect HTTP to HTTPS</li>
</ul>

<strong>3. Routing:</strong>
<ul>
   <li>Choose the correct target type (instance vs. ip) based on your network setup</li>
   <li>Set proper protocols matching your application's expectations</li>
   <li>Configure appropriate health checks</li>
   <li>Define clear conditions for complex routing scenarios</li>
   <li>Use sticky sessions when needed for stateful applications</li>
</ul>

<strong>4. Performance:</strong>
<ul>
   <li>Enable HTTP/2 for improved client performance</li>
   <li>Configure appropriate idle timeout values</li>
   <li>Use cross-zone load balancing for even distribution</li>
   <li>Monitor ALB metrics in CloudWatch</li>
   <li>Set appropriate deregistration delay to allow in-flight requests to complete</li>
</ul>

<strong>5. Cost Optimization:</strong>
<ul>
   <li>Share ALBs using ingress groups to reduce the number of load balancers</li>
   <li>Use internal ALBs for services that don't need public access</li>
   <li>Consider using NLB for TCP/UDP workloads rather than ALB</li>
   <li>Monitor and clean up unused resources</li>
</ul>
</div>

<p><br /></p>

<h3 id="troubleshooting-tips">Troubleshooting Tips</h3>

<div class="info-box info-box-warning-not-check">
<br />

<strong>1. ALB Not Created:</strong>
<ul>
  <li>Check controller logs for errors</li>
  <li>Verify IAM permissions for the controller</li>
  <li>Ensure subnet discovery tags are correct</li>
</ul>

<strong>2. Traffic Not Reaching Service:</strong>
<ul>
  <li>Verify target group health checks are passing</li>
  <li>Check security group rules allow traffic flow</li>
  <li>Confirm service is running and listening on correct port</li>
</ul>

<strong>3. SSL/TLS Issues:</strong>
<ul>
  <li>Verify certificate ARN is correct and in the same region</li>
  <li>Ensure certificate covers the domain in your ingress host rule</li>
  <li>Check for certificate expiration</li>
</ul>

<strong>4. Authentication Problems:</strong>
<ul>
  <li>Verify configuration of Cognito/OIDC settings</li>
  <li>Check for proper secret configuration</li>
  <li>Look for errors in ALB access logs</li>
</ul>
</div>

<p><br /></p>

<hr />

<h3 id="reference">Reference</h3>
<ul>
  <li><a href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/latest/">AWS Load Balancer Controller Documentation</a></li>
  <li><a href="https://aws.amazon.com/blogs/containers/exposing-kubernetes-applications-part-3-nginx-ingress-controller/">AWS Blog: Exposing Kubernetes Applications</a></li>
  <li><a href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/latest/guide/ingress/annotations/">AWS Load Balancer Controller Annotations</a></li>
  <li><a href="https://docs.aws.amazon.com/eks/latest/userguide/aws-load-balancer-controller.html">AWS EKS Documentation</a></li>
  <li><a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/introduction.html">AWS ALB Documentation</a></li>
</ul>


                <!-- Pagination links -->


            </article>

            
                <aside class="see-also">
                    <h2>See also</h2>
                    <ul>
                        
                        
                        
                            <li>
                                <a href="/category/troubleshooting/db-connection-econnreset-resolution/">
                                    
                                        <img src="https://blog.kakaocdn.net/dna/s4D8a/btsOxNLMqM4/AAAAAAAAAAAAAAAAAAAAAORE6t2MVeHlg6zCJA1t5NVNNR4Wh10RQLa4nfpWBDNv/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1756652399&allow_ip=&allow_referer=&signature=BU3QjfHpdR4%2FWl2hapEWOzOIy2I%3D">
                                    
                                    <h3>Resolving DB Connection Error (ECONNRESET) Issues</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/openstack/openstack-trove/">
                                    
                                        <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1756185482/openstack-trove-1_ggheju.png">
                                    
                                    <h3>Deep Dive into OpenStack Trove</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/category/database/database-normalization/">
                                    
                                        <img src="https://blog.kakaocdn.net/dn/GY9Lf/btsMP5uevn7/JNMOge6dsyn4R6Lx0CbQF1/img.png">
                                    
                                    <h3>Database Normalization and Denormalization: A Complete Guide</h3>
                                </a>
                            </li>
                        
                    </ul>
                </aside>
            

        </section>

        <!-- Add time bar only for pages without pagination -->
        
            <div class="time-bar" data-minutes="22">
    <span class="time-completed"></span>
    <span class="time-remaining"></span>
    <div class="bar">
        <span class="completed" style="width:0%;"></span>
        <span class="remaining" style="width:100%;"></span>
    </div>
</div>

            <button class="toggle-preview" onclick="togglePreview()">
    <span>Hide Preview ▼</span>
</button>

<div id="recommendationSection" class="recommendation">
    <div class="message">
        <strong>Why don't you read something next?</strong>
        <div>
            <button>
                <svg><use xlink:href="#icon-arrow-right"></use></svg>
                <span>Go back to top</span>
            </button>
        </div>
    </div>
    <div id="previewSection" class="preview-section">
        
        <a href="/category/aws/aws-assume-role/" class="post-preview">
            <div class="image">
                
                    <img src="https://res.cloudinary.com/dkcm26aem/image/upload/c_scale,w_380/v1737423759/aws-assume-role_wtm7on.png">
                
            </div>
            <h3 class="title">Advanced AWS Assume Role Patterns & Enterprise Security Best Practices</h3>
        </a>
    </div>
</div>

<style>
.toggle-preview {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #333;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.toggle-preview:hover {
    background: #444;
}

.toggle-preview.visible {
    opacity: 1;
}

.recommendation {
    margin-top: 1000px;
    display: block;
    transition: all 0.3s ease;
}

.recommendation.hidden {
    display: none;
}

.hide-preview {
    margin-left: 10px;
    background: none;
    border: 1px solid #666;
    color: #666;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}

.hide-preview:hover {
    background: #f0f0f0;
}

.preview-section {
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.preview-section.hidden {
    max-height: 0;
}
</style>

<script>
function togglePreview() {
    const recommendation = document.getElementById('recommendationSection');
    const button = document.querySelector('.toggle-preview span');
    
    if (recommendation.classList.contains('hidden')) {
        recommendation.classList.remove('hidden');
        button.textContent = 'Hide Preview ▼';
    } else {
        recommendation.classList.add('hidden');
        button.textContent = 'Show Preview ▲';
    }
}

window.addEventListener('scroll', function() {
    const toggleButton = document.querySelector('.toggle-preview');
    const recommendation = document.getElementById('recommendationSection');
    const rect = recommendation.getBoundingClientRect();
    
    if (rect.top <= window.innerHeight) {
        toggleButton.classList.add('visible');
    } else {
        toggleButton.classList.remove('visible');
    }
});
</script>

        

        <!-- Show modal if the post is the last one -->
        

        <!-- Show modal before user leaves the page -->
        

        <!-- Add your newsletter subscription form here -->

        <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;A comprehensive guide to AWS Load Balancer Controller Ingress Annotations&quot;%20https://somaz.blog/category/aws/aws-ingress-annotations/%20via%20&#64;twitter_username&hashtags=aws,kubernetes,ingress,alb,eks"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://somaz.blog/category/aws/aws-ingress-annotations/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
</section>

        

  <section class="author">
    <div class="details">
      
        <img class="img-rounded" src="/assets/img/uploads/profile.png" alt="Somaz">
      
      <p class="def">Author</p>
      <h3 class="name">
        <a href="/authors/somaz/">Somaz</a>
      </h3>
      <p class="desc">DevOps engineer focused on cloud infrastructure and automation</p>
      <p>
        
          <a href="https://github.com/somaz94" title="Github">
            <svg><use xlink:href="#icon-github"></use></svg>
          </a>
        
        
        
        
        
        
          <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
            <svg><use xlink:href="#icon-linkedin"></use></svg>
          </a>
        
        
          <a href="https://somaz.tistory.com" title="Tistory">
            <svg><use xlink:href="#icon-tistory"></use></svg>
          </a>
        
      </p>
    </div>
  </section>

  
  
  
  
  
  
  
  

  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Somaz",
      
      "image": "/assets/img/uploads/profile.png",
      
      "jobTitle": "DevOps Engineer",
      "url": "https://somaz.blog/authors/somaz/",
      "sameAs": [
        "https://github.com/somaz94","https://www.linkedin.com/in/somaz","https://{{ author.tistory_username }}.tistory.com"
      ]
  }
  </script>


        

<section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = 'https-somaz94-github-io';
        var disqus_title = '';
        var disqus_url = '/category/aws/aws-ingress-annotations/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>



        <footer>
    <p>
      
        <a href="https://github.com/somaz94" title="Github">
          <svg><use xlink:href="#icon-github"></use></svg>
        </a>
      
      
        <a href="https://www.facebook.com/facebook_username" title="Facebook">
          <svg><use xlink:href="#icon-facebook"></use></svg>
        </a>
      
      
        <a href="https://twitter.com/twitter_username" title="Twitter">
          <svg><use xlink:href="#icon-twitter"></use></svg>
        </a>
      
      
        <a href="https://medium.com/@medium_username" title="Medium">
          <svg><use xlink:href="#icon-medium"></use></svg>
        </a>
      
      
        <a href="https://www.instagram.com/instagram_username" title="Instagram">
          <svg><use xlink:href="#icon-instagram"></use></svg>
        </a>
      
      
        <a href="https://www.linkedin.com/in/somaz" title="LinkedIn">
          <svg><use xlink:href="#icon-linkedin"></use></svg>
        </a>
      
      
        <a href="https://somaz.tistory.com" title="Tistory">
          <svg><use xlink:href="#icon-tistory"></use></svg>
        </a>
      
    </p>

    <ul>
  
    
      <li>
        <a href="https://somaz.blog/">Home</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/about">About</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/category">Category</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/contact">Contact</a>
      </li>
    
  
    
      <li>
        <a href="https://somaz.blog/feed.xml">Feed</a>
      </li>
    
  
</ul>


    <p>
      <a href="https://somaz.blog/sitemap.xml" title="sitemap">Sitemap</a> |
      <a href="https://somaz.blog/privacy-policy" title="Privacy Policy">Privacy Policy</a>
    </p>

    <p>
      <span>Somaz Tech Blog</span> <svg class="love"><use xlink:href="#icon-heart"></use></svg>
    </p>
</footer>










<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "somaz",
  "description": "DevOps engineer's tech blog.",
  "url": "https://somaz.blog/",
  "logo": {
      "@type": "ImageObject",
      "url": "https://somaz.blog/assets/img/icons/mediumtile.png",
      "width": "600",
      "height": "315"
  },
  "sameAs": [
    "https://github.com/somaz94","https://www.facebook.com/facebook_username","https://twitter.com/twitter_username","https://medium.com/@medium_username","https://www.instagram.com/instagram_username","https://www.linkedin.com/in/somaz","https://{{ site.tistory_username }}.tistory.com"
  ]
}
</script>

<!-- Include the script that allows Netlify CMS login -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<!-- Include the website scripts -->
<script src="/assets/js/scripts.min.js"></script>

<!-- Include Google Analytics script -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
<script>
  var host = window.location.hostname;
  if (host != 'localhost') {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXX-X');
  }
</script>
  


<!-- Include extra scripts -->



        

        
        
        
        
        
        
        
        
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "name": "What is AWS Ingress Annotations?",
            "headline": "",
            "description": "A comprehensive guide to AWS Load Balancer Controller Ingress Annotations",
            "image": "https://res.cloudinary.com/dkcm26aem/image/upload/v1737362570/ingress-nginx-aws_hxoiqe.png",
            "url": "https://somaz.blog/category/aws/aws-ingress-annotations/",
            "articleBody": "image reference link





Overview
Learn about AWS Load Balancer Controller Ingress Annotations and how they manage traffic routing to Kubernetes services using Application Load Balancers (ALB).

These annotations provide a powerful way to customize and configure how external traffic is routed to your applications running on EKS or other Kubernetes deployments on AWS.



What is Ingress Annotations?
In AWS, the AWS load balancer controller configures and manages the behavior of the Application Load Balancer (ALB) that routes traffic to the Kubernetes service using annotations for incoming resources.

Annotations allow you to specify settings such as SSL, routing behavior, and security groups directly within the Kubernetes Ingress resource.



How Load Balancer Controller Works


  Resource Creation: Create or update ALBs, their listeners, and target groups based on the specified annotations.
  Management: Manage status checks, security settings, routing rules, SSL certificates, and other defined configurations.
  Dynamic Updates: When annotations change, the controller updates ALB with new settings without manual intervention, allowing Kubernetes native resources to manage complex configurations.
  Integration with AWS: The controller integrates directly with AWS services, automatically provisioning AWS resources and connecting them to your Kubernetes resources.




Ingress Groups


  In AWS, ingress group is a feature that allows multiple ingress resources to be integrated into a single load balancer (ALB) for more efficient management.
  This allows applications from different Kubernetes namespaces or different teams to share the same ALB while setting different Ingress rules.
  Ingress groups can significantly reduce costs and increase management efficiency by consolidating multiple ALBs into a single one.
  By default, ingress does not belong to an ingress group (it exists as an “implicit ingress group”), functioning as an independent entity with its own ALB.


Ingress Group Name Settings


  Use the alb.ingress.kubernetes.io/group.name annotation to define the group name.
  Ingress resources with the same group name will share one ALB, consolidating resources.
  The ALB assigned to an ingress group is tagged with ingress.k8s.aws/stack and the group name as the value.
  For resources that do not use ingress groups, the tag value is set in the format of namespace/ingressname.
  If you change the groupName assigned to an ingress resource, the ingress moves from the existing group to a new ingress Group, managed by the ALB of the new group.
  If there is no ALB in the new IngressGroup, a new ALB is automatically created.
  Example: alb.ingress.kubernetes.io/group.name: my-team.awesome-group


Ingress Group Ranking


  You can specify the order using the alb.ingress.kubernetes.io/group.order annotation.
  The ingress rule with a lower order value is applied first, allowing you to prioritize specific rules when multiple ingresses share the same path or host.
  This is particularly useful when you have overlapping rule definitions and need to ensure specific traffic patterns are handled correctly.
  Example: alb.ingress.kubernetes.io/group.order: 10


Ingress Group Example

In the example below, two ingress resources share a group called my-shared-group, so one ALB processes the request.

# Ingress for Service A
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: service-a-ingress
  annotations:
    alb.ingress.kubernetes.io/group.name: &quot;my-shared-group&quot;
    alb.ingress.kubernetes.io/group.order: &quot;10&quot;
spec:
  rules:
    - host: &quot;service-a.example.com&quot;
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: service-a
                port:
                  number: 80

# Ingress for Service B
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: service-b-ingress
  annotations:
    alb.ingress.kubernetes.io/group.name: &quot;my-shared-group&quot;
    alb.ingress.kubernetes.io/group.order: &quot;20&quot;
spec:
  rules:
    - host: &quot;service-b.example.com&quot;
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: service-b
                port:
                  number: 80


  In this example, service-a and service-b both belong to the ingress group my-shared-group, with service-a having priority (order 10) over service-b (order 20).
  This means both services will be exposed through the same ALB, reducing costs and simplifying management.






Ingress Traffic Listening

listen-ports: Specify ports for ALB
[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;: 443}]


ssl-redirect: Enable SSL redirection
&apos;443&apos;


ip-address-type: IPv4 or dualstack support
ipv4 or dualstack


waf-acl-id: Associate AWS WAF WebACL
arn:aws:wafv2:region:account:webacl/my-web-acl/id




listen-ports


  Specifies the port(s) that the ALB listens on for incoming traffic.
  Example: alb.ingress.kubernetes.io/listen-ports: &apos;[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;: 443}, {&quot;HTTP&quot;: 8080}, {&quot;HTTPS&quot;: 8443}]&apos;
  Since it applies to all Ingress within IngressGroup, each Ingress can define its own port, and the rule applies only to the ports specified in each Ingress.
  If the same receiving port is defined by multiple ingress within the IngressGroup, it is applied in the order of the IngressGroup.
  Default behavior:
    
      If listen-ports is not specified and no certificate is configured, the default is {&quot;HTTP&quot;: 80}
      If a certificate is provided, the default becomes {&quot;HTTPS&quot;: 443}
    
  
  Warning: You cannot have duplicate load balancer ports in the same group (Exception: when alb.ingress.kubernetes.io/group.order is specified)
  Since ALB integrates these settings for all Ingress in the group, defining listen-ports in one Ingress in the IngressGroup is sufficient.


ssl-redirect


  Enables SSL redirection by specifying the port to which HTTP traffic is redirected, typically HTTPS port 443.
  Example: alb.ingress.kubernetes.io/ssl-redirect: &apos;443&apos;
  SSL redirection affects all ingress in the group if defined in the ingressGroup.
  When SSL redirection is enabled, all HTTP listeners are configured by default to redirect to HTTPS, ignoring other HTTP rules.
  This is recommended for production environments to ensure secure communication.


ip-address-type


  Specifies whether ALB should use ipv4 or dualstack for IPv4 and IPv6 traffic support.
  Example: alb.ingress.kubernetes.io/ip-address-type: ipv4 or alb.ingress.kubernetes.io/ip-address-type: dualstack
  ipv4: Configure ALB to use only IPv4 addresses, i.e., handle IPv4 traffic exclusively.
  dualstack: ALB supports both IPv4 and IPv6 traffic. When set to dualstack, ALB has both IPv4 and IPv6 addresses, allowing traffic to be routed in both address types.
  Note: For dualstack to work properly, your VPC and subnets must be configured to support IPv6.


waf-acl-id


  Associates a AWS WAF WebACL with your ALB for additional security protections.
  Example: alb.ingress.kubernetes.io/waf-acl-id: arn:aws:wafv2:region:account:webacl/my-web-acl/id
  The WebACL provides protection against common web exploits like SQL injection, cross-site scripting, and more.
  For this to work, the appropriate IAM permissions must be granted to the load balancer controller.


customer-owned-ipv4-pool


  Specifies the customer-owned IPv4 address pool for ALB when using the Outpost environment.
  Warning: This annotation cannot be changed after creation, and you will need to recreate the Ingress to change it.
  Example: alb.ingress.kubernetes.io/customer-owned-ipv4-pool: ipv4pool-coip-xxxxxxx
  This is specifically useful for AWS Outposts deployments where you might want to use your on-premises IP addresses.


Full Example

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: secure-app-ingress
  annotations:
    alb.ingress.kubernetes.io/listen-ports: &apos;[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;: 443}]&apos;
    alb.ingress.kubernetes.io/ssl-redirect: &apos;443&apos;
    alb.ingress.kubernetes.io/certificate-arn: &apos;arn:aws:acm:region:account:certificate/cert-id&apos;
    alb.ingress.kubernetes.io/ip-address-type: &apos;dualstack&apos;
    alb.ingress.kubernetes.io/waf-acl-id: &apos;arn:aws:wafv2:region:account:webacl/my-web-acl/id&apos;
spec:
  ingressClassName: alb
  rules:
    - host: secure-app.example.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: secure-app-service
                port:
                  number: 80






Ingress Traffic Routing

load-balancer-name: Specify custom ALB name
my-awesome-alb


target-type: Routing to instances or IP addresses
instance or ip


backend-protocol: Protocol for backend traffic
HTTP, HTTPS


target-group-attributes: Target group configuration
stickiness.enabled=true




load-balancer-name


  Allows you to specify a custom name for the ALB created by the controller.
  Example: alb.ingress.kubernetes.io/load-balancer-name: my-app-alb
  All Ingress resources within an IngressGroup must use the same load balancer name.
  The name cannot exceed 32 characters, and an error occurs when this limit is exceeded.
  This is useful for easier identification and management of resources in the AWS console.


target-type


  Defines how traffic from the load balancer should be routed to your application.
  Example: alb.ingress.kubernetes.io/target-type: instance or alb.ingress.kubernetes.io/target-type: ip
  instance mode:
    
      Routes traffic to all EC2 instances in the cluster via NodePort that is open for the service.
      When using instance mode, the service must use NodePort or LoadBalancer type.
      This is the default and works well for most standard deployments.
    
  
  ip mode:
    
      Routes traffic directly to the pod IPs.
      The network plugin must use the secondary IP address of the ENI for pod IPs to use ip mode (e.g., amazon-vpc-cni-k8s).
      IP mode is required for sticky sessions to work with application load balancer.
      Service type is not important when using ip mode.
      This mode offers more direct routing but has specific network requirements.
    
  


target-node-labels


  Specifies which nodes should be included in the target group registration when using the instance target type.
  Example: alb.ingress.kubernetes.io/target-node-labels: label1=value1, label2=value2
  This is useful for directing traffic to specific node groups (e.g., sending certain traffic only to GPU nodes).
  Only nodes with matching labels will be registered as targets in the ALB’s target group.


backend-protocol


  Specifies the protocol used to route traffic to your service backends.
  Example: alb.ingress.kubernetes.io/backend-protocol: HTTPS
  Supported values: HTTP, HTTPS, TCP, TLS, UDP, TCP_UDP
  Default is HTTP if not specified.
  Should match the protocol your application is listening on.
  Using HTTPS or TLS requires proper SSL configuration on your application.


backend-protocol-version


  Specifies the application protocol version used to route traffic to the pods.
  Example:
    
      alb.ingress.kubernetes.io/backend-protocol-version: HTTP2
      alb.ingress.kubernetes.io/backend-protocol-version: GRPC
    
  
  Only valid when HTTP or HTTPS is used as a backend protocol.
  Useful for modern applications that leverage HTTP/2 or gRPC for more efficient communication.


target-group-attributes


  Allows you to set attributes for the target groups created by the controller.
  Example: alb.ingress.kubernetes.io/target-group-attributes: stickiness.enabled=true
  Common use cases include:
    
      Setting up sticky sessions
      Configuring deregistration delay
      Adjusting health check settings
      Load balancing algorithm tuning
    
  


health-check-* annotations


  A set of annotations to configure the health check behavior for your service.
  Examples:
    
      alb.ingress.kubernetes.io/healthcheck-protocol: HTTP
      alb.ingress.kubernetes.io/healthcheck-port: traffic-port
      alb.ingress.kubernetes.io/healthcheck-path: /health
      alb.ingress.kubernetes.io/healthcheck-interval-seconds: &apos;15&apos;
      alb.ingress.kubernetes.io/healthcheck-timeout-seconds: &apos;5&apos;
      alb.ingress.kubernetes.io/success-codes: &apos;200&apos;
      alb.ingress.kubernetes.io/healthy-threshold-count: &apos;2&apos;
      alb.ingress.kubernetes.io/unhealthy-threshold-count: &apos;2&apos;
    
  
  These settings determine how the ALB checks if your application is healthy and ready to receive traffic.


actions.${action-name} and conditions.${conditions-name}


  Provides a method for configuring advanced load balancer listener rules beyond what is possible with standard Ingress specifications.
  actions.${action-name}: Defines what should happen for a specific rule, like redirects or fixed responses.
  conditions.${conditions-name}: Defines additional matching conditions beyond host/path.
  The serviceName in these annotations should match the serviceName in the Ingress rule, and the servicePort should be set to “use-annotation”.


Here’s an example showing how to use advanced actions and conditions:

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  namespace: default
  name: ingress
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/actions.rule-path1: &amp;gt;
      {&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Host is www.example.com OR anno.example.com&quot;}}
    alb.ingress.kubernetes.io/conditions.rule-path1: &amp;gt;
      [{&quot;field&quot;:&quot;host-header&quot;,&quot;hostHeaderConfig&quot;:{&quot;values&quot;:[&quot;anno.example.com&quot;]}}]
    # More actions and conditions...
spec:
  ingressClassName: alb
  rules:
    - host: www.example.com
      http:
        paths:
          - path: /path1
            pathType: Exact
            backend:
              service:
                name: rule-path1
                port:
                  name: use-annotation
          # More paths...


These advanced rules allow for complex traffic routing scenarios including:

  Multiple host conditions
  Path pattern matching
  HTTP header-based routing
  HTTP method-based routing
  Query string parameter routing
  Source IP filtering
  Combinations of multiple conditions






Ingress Access Control



Scheme: Define ALB as internal or internet-facing
alb.ingress.kubernetes.io/scheme




CIDR: Restrict IP ranges
alb.ingress.kubernetes.io/inbound-cidrs




Security Groups: Specify security groups
alb.ingress.kubernetes.io/security-groups




Subnet Discovery: Specify subnets for ALB
alb.ingress.kubernetes.io/subnets




Auth: Configure authentication
alb.ingress.kubernetes.io/auth-*




scheme


  Used to define whether the ALB should be accessible from the internet or only within your VPC.
  Example: alb.ingress.kubernetes.io/scheme: internal or alb.ingress.kubernetes.io/scheme: internet-facing
  internet-facing: Makes ALB accessible publicly via the internet. The ALB will have a public IP and DNS name.
  internal: Makes ALB private by restricting it to be accessible only within a VPC or connected networks.
  Use internal for services that should only be accessible within your private network, and internet-facing for public-facing applications.
  This setting affects all Ingress resources within an IngressGroup.


inbound-cidrs


  Restricts access to the ALB by allowing only the specified IP ranges (CIDRs) to connect.
  Example: alb.ingress.kubernetes.io/inbound-cidrs: 10.0.0.0/24, 192.168.1.0/24
  Particularly useful for controlling access to private applications or internal resources by limiting the range of IPs that can access the ALB.
  If Ingress is part of an IngressGroup, the inbound-cidrs annotation applies to all Ingress resources in the group.
  However, inbound-cidrs applies only to ports defined in that specific Ingress.
  If multiple ingresses share the same ingress port, you must define inbound-cidrs on only one of those ingresses to prevent collisions.
  Specifying alb.ingress.kubernetes.io/security-groups in Ingress will cause inbound-cidrs annotations to be ignored.
  Default behavior if not specified:
    
      0.0.0.0/0 (all IPv4 addresses) will be allowed if the ALB’s IPAddressType is set to ipv4.
      0.0.0.0/0 and ::/0 (all IPv4 and IPv6 addresses) will be allowed if the ALB’s IPAddressType is set to dualstack.
    
  


security-groups


  Specifies the security groups to attach to the load balancer.
  Example: alb.ingress.kubernetes.io/security-groups: sg-xxxx, nameOfSg1, nameOfSg2
  You can specify security groups by ID or by name.
  Without this annotation, the controller automatically creates a security group, attaches it to the load balancer, and configures it to allow traffic on the listen-ports from the inbound-cidrs.
  The controller also modifies this security group to allow inbound traffic to the Node/Pod security groups.
  Use this annotation when you want to apply your own custom security group policies.


manage-backend-security-group-rules


  Controls whether the controller should manage security group rules for traffic from the ALB to backend targets.
  Example: alb.ingress.kubernetes.io/manage-backend-security-group-rules: &quot;true&quot;
  This only applies when you specify custom security groups using the alb.ingress.kubernetes.io/security-groups annotation.
  Setting this to &quot;false&quot; means you’ll need to manually configure the rules to allow traffic from the ALB to your backend pods/nodes.


subnets


  Specifies which subnets the ALB should be created in.
  Example: alb.ingress.kubernetes.io/subnets: subnet-xxxx, subnet-yyyy, subnet-zzzz
  You can specify subnets by ID or by tags.
  By default, the controller automatically discovers subnets with the appropriate tags.
  For internet-facing ALBs, the controller looks for subnets tagged with kubernetes.io/role/elb: 1.
  For internal ALBs, it looks for subnets tagged with kubernetes.io/role/internal-elb: 1.
  This annotation is useful when you need to override the automatic subnet discovery.


auth-type and related annotations

The AWS Load Balancer Controller supports various authentication mechanisms through annotations:

OIDC Authentication

alb.ingress.kubernetes.io/auth-type: oidc
alb.ingress.kubernetes.io/auth-idp-oidc-config: &apos;{&quot;issuer&quot;:&quot;https://example.com&quot;,&quot;secretName&quot;:&quot;oidc-secret&quot;}&apos;
alb.ingress.kubernetes.io/auth-on-unauthenticated-request: authenticate
alb.ingress.kubernetes.io/auth-scope: openid


Cognito Authentication

alb.ingress.kubernetes.io/auth-type: cognito
alb.ingress.kubernetes.io/auth-idp-cognito: &apos;{&quot;userPoolARN&quot;:&quot;arn:aws:cognito-idp:region:account:userpool/id&quot;,&quot;userPoolClientID&quot;:&quot;client-id&quot;}&apos;
alb.ingress.kubernetes.io/auth-on-unauthenticated-request: authenticate
alb.ingress.kubernetes.io/auth-scope: openid


These authentication mechanisms allow you to secure your applications by ensuring users are authenticated before accessing them.

Example: Securing an Internal Application

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: secure-internal-app
  annotations:
    alb.ingress.kubernetes.io/scheme: internal
    alb.ingress.kubernetes.io/inbound-cidrs: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
    alb.ingress.kubernetes.io/security-groups: sg-private-apps
    alb.ingress.kubernetes.io/auth-type: cognito
    alb.ingress.kubernetes.io/auth-idp-cognito: &apos;{&quot;userPoolARN&quot;:&quot;arn:aws:cognito-idp:region:account:userpool/id&quot;,&quot;userPoolClientID&quot;:&quot;client-id&quot;}&apos;
spec:
  ingressClassName: alb
  rules:
    - host: internal-app.company.local
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: internal-app
                port:
                  number: 80


This example creates an internal ALB that:

  Is only accessible from private IP ranges
  Uses a specific security group
  Requires Cognito authentication
  Routes traffic to an internal application






SSL/TLS Configuration

certificate-arn: ARN of ACM certificate
arn:aws:acm:region:account:certificate/cert-id


ssl-policy: Security policy for TLS
ELBSecurityPolicy-TLS-1-2-2017-01


ssl-redirect: Redirect HTTP to HTTPS
&apos;443&apos;




certificate-arn


  Specifies the ARN of an AWS Certificate Manager (ACM) certificate to use for TLS termination.
  Example: alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:region:account:certificate/cert-id
  You can specify multiple certificate ARNs by separating them with commas.
  The first certificate in the list will be the default certificate.
  When multiple certificates are provided, the ALB will use Server Name Indication (SNI) to select the appropriate certificate based on the client’s requested hostname.
  If you’re using IngressGroups, all ingresses in the group should use the same certificates to avoid conflicts.


ssl-policy


  Defines the security policy that determines which ciphers and protocols are supported by the ALB.
  Example: alb.ingress.kubernetes.io/ssl-policy: ELBSecurityPolicy-TLS-1-2-2017-01
  AWS provides several predefined policies:
    
      ELBSecurityPolicy-2016-08: Recommended for general use
      ELBSecurityPolicy-TLS-1-2-2017-01: Supports TLS 1.2 only
      ELBSecurityPolicy-TLS-1-1-2017-01: Supports TLS 1.1 and later
      ELBSecurityPolicy-2015-05: Older policy with broader compatibility
      ELBSecurityPolicy-FS-2018-06: Forward secrecy policy
    
  
  Choose a policy that balances security and compatibility with your users’ browsers/clients.
  For maximum security, use ELBSecurityPolicy-FS-1-2-Res-2020-10 which supports only secure ciphers and TLS 1.2+.


Example: Configuring HTTPS with Multiple Certificates

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: multi-domain-app
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/listen-ports: &apos;[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;: 443}]&apos;
    alb.ingress.kubernetes.io/certificate-arn: &amp;gt;-
      arn:aws:acm:region:account:certificate/cert1,
      arn:aws:acm:region:account:certificate/cert2
    alb.ingress.kubernetes.io/ssl-policy: ELBSecurityPolicy-FS-2018-06
    alb.ingress.kubernetes.io/ssl-redirect: &apos;443&apos;
spec:
  ingressClassName: alb
  rules:
    - host: app.example.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: app-service
                port:
                  number: 80
    - host: app.another-domain.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: app-service
                port:
                  number: 80


This example:

  Configures the ALB to listen on both HTTP (80) and HTTPS (443)
  Uses two different SSL certificates (the ALB will select the right one based on the domain)
  Enforces a strong SSL policy with forward secrecy
  Redirects all HTTP traffic to HTTPS






Advanced Features and Use Cases

Cross-Zone Load Balancing: Even distribution across AZs
load_balancing.cross_zone.enabled=true


Idle Timeout: Connection idle time
idle_timeout.timeout_seconds=60


HTTP/2 Support: Enable HTTP/2 protocol
routing.http2.enabled=true


Access Logging: Log traffic to S3
access_logs.s3.enabled=true




Cross-Zone Load Balancing


  Controls whether load balancing is distributed across all availability zones.
  Example: alb.ingress.kubernetes.io/load-balancer-attributes: load_balancing.cross_zone.enabled=true
  Ensures even distribution of traffic across all registered targets regardless of AZ.


Idle Timeout


  Configures how long connections can remain idle before being closed.
  Example: alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=60
  Default is 60 seconds, but can be increased for applications with longer processing times.


HTTP/2 Support


  Enables HTTP/2 support on the ALB.
  Example: alb.ingress.kubernetes.io/load-balancer-attributes: routing.http2.enabled=true
  HTTP/2 offers improved performance through binary framing, multiplexing, and header compression.


Access Logging


  Configures ALB access logs to be stored in an S3 bucket.
  Example: alb.ingress.kubernetes.io/load-balancer-attributes: access_logs.s3.enabled=true,access_logs.s3.bucket=my-log-bucket,access_logs.s3.prefix=my-app-logs
  Useful for troubleshooting, security analysis, and traffic monitoring.




Best Practices



1. Ingress Groups:

   Use meaningful group names that reflect the application or team
   Set appropriate order values (10, 20, 30) with gaps to allow for future insertions
   Share ALBs efficiently by grouping related services
   Keep group membership stable to avoid unnecessary ALB creation/deletion


2. Security:

   Use appropriate scheme (internal for private services, internet-facing for public)
   Implement CIDR restrictions to limit access to trusted IP ranges
   Configure security groups with least privilege access
   Enable access logging for security monitoring
   Use WAF for additional layer of protection
   Use strong SSL policies and redirect HTTP to HTTPS


3. Routing:

   Choose the correct target type (instance vs. ip) based on your network setup
   Set proper protocols matching your application&apos;s expectations
   Configure appropriate health checks
   Define clear conditions for complex routing scenarios
   Use sticky sessions when needed for stateful applications


4. Performance:

   Enable HTTP/2 for improved client performance
   Configure appropriate idle timeout values
   Use cross-zone load balancing for even distribution
   Monitor ALB metrics in CloudWatch
   Set appropriate deregistration delay to allow in-flight requests to complete


5. Cost Optimization:

   Share ALBs using ingress groups to reduce the number of load balancers
   Use internal ALBs for services that don&apos;t need public access
   Consider using NLB for TCP/UDP workloads rather than ALB
   Monitor and clean up unused resources





Troubleshooting Tips




1. ALB Not Created:

  Check controller logs for errors
  Verify IAM permissions for the controller
  Ensure subnet discovery tags are correct


2. Traffic Not Reaching Service:

  Verify target group health checks are passing
  Check security group rules allow traffic flow
  Confirm service is running and listening on correct port


3. SSL/TLS Issues:

  Verify certificate ARN is correct and in the same region
  Ensure certificate covers the domain in your ingress host rule
  Check for certificate expiration


4. Authentication Problems:

  Verify configuration of Cognito/OIDC settings
  Check for proper secret configuration
  Look for errors in ALB access logs







Reference

  AWS Load Balancer Controller Documentation
  AWS Blog: Exposing Kubernetes Applications
  AWS Load Balancer Controller Annotations
  AWS EKS Documentation
  AWS ALB Documentation

",
            "wordcount": "3962",
            "inLanguage": "en",
            "dateCreated": "2025-03-31/",
            "datePublished": "2025-03-31/",
            "dateModified": "2025-03-31/",
            "author": {
                "@type": "Person",
                "name": "Somaz",
                
                "image": "/assets/img/uploads/profile.png",
                
                "jobTitle": "DevOps Engineer",
                "url": "https://somaz.blog/authors/somaz/",
                "sameAs": [
                    "https://github.com/somaz94","https://www.linkedin.com/in/somaz"
                ]
            },
            "publisher": {
                "@type": "Organization",
                "name": "somaz",
                "url": "https://somaz.blog/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://somaz.blog/assets/img/blog-image.png",
                    "width": "600",
                    "height": "315"
                }
            },
            "mainEntityOfPage": "True",
            "genre": "AWS",
            "articleSection": "AWS",
            "keywords": ["aws","kubernetes","ingress","alb","eks"]
        }
        </script>
    </body>
</html>
