<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì†ê°€ë½ ê¸¸ì´ë¡œ ë³´ëŠ” ë‚˜ì˜ í‚¤ ê³„ì‚°ê¸°</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      max-width: 1100px;
      margin: 40px auto;
      padding: 20px;
      background: #f9f9f9;
      color: #333;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      position: relative;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.5em;
    }
    h3 {
      margin-top: 30px;
      margin-bottom: 15px;
      font-size: 1.2em;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 5px;
    }
    input {
      width: 100%;
      padding: 8px 10px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    button {
      display: block;
      width: 100%;
      padding: 12px;
      background-color: #4CAF50;
      border: none;
      border-radius: 6px;
      color: white;
      font-size: 1em;
      cursor: pointer;
      margin-top: 20px;
    }
    button:hover {
      background-color: #45a049;
    }
    .result {
      text-align: center;
      margin-top: 10px;
      font-size: 1.2em;
      font-weight: bold;
    }
    .result-container {
      background-color: #f0f0f0;
      padding: 15px;
      border-radius: 8px;
      margin-top: 30px;
    }
    .model-section {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background-color: #fff;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 0;
      flex-wrap: wrap;
      justify-content: center;
      background-color: #f2f2f2;
      padding: 15px 10px;
      border-radius: 8px 8px 0 0;
    }
    .tab {
      padding: 8px 12px;
      background-color: #eee;
      border-radius: 6px;
      cursor: pointer;
      text-align: center;
      flex: 0 1 auto;
      min-width: 90px;
      font-size: 0.85em;
      white-space: nowrap;
      margin-bottom: 5px;
    }
    .tab.active {
      background-color: #4CAF50;
      color: white;
    }
    .model-container {
      display: none;
    }
    .model-container.active {
      display: block;
    }
    .model-stats {
      background-color: #e7f3ff;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.9em;
      margin: 0 15px 15px 15px;
      display: inline-block;
    }
    h4 {
      margin-top: 20px;
      margin-bottom: 10px;
      font-size: 1.1em;
      color: #333;
      border-left: 3px solid #4CAF50;
      padding-left: 10px;
    }
    
    /* ëª¨ë°”ì¼ ëŒ€ì‘ ë¯¸ë””ì–´ ì¿¼ë¦¬ */
    @media (max-width: 600px) {
      body {
        padding: 15px;
        margin: 20px auto;
      }
      
      .tab {
        padding: 6px 8px;
        font-size: 0.75em;
        min-width: 75px;
      }
      
      h2 {
        font-size: 1.3em;
      }
      
      h3 {
        font-size: 1.1em;
      }
    }
    
    /* ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
    .main-content {
      display: grid;
      grid-template-columns: 65% 32%;
      gap: 3%;
      position: relative;
    }
    
    .calculator-container {
      width: 100%;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 0 0 15px 0;
    }
    
    .model-title {
      font-size: 1.3em;
      margin: 25px 15px 15px 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .helper-container {
      background-color: #f0f8ff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      position: sticky;
      top: 20px;
      align-self: flex-start;
      max-height: 80vh;
      overflow-y: auto;
      border-left: 1px solid #ddd;
    }
    
    .helper-container h3 {
      margin-top: 0;
      color: #2c3e50;
      font-size: 1.1em;
      border-bottom: 1px solid #cce;
      padding-bottom: 8px;
      margin-bottom: 15px;
    }
    
    .helper-container .form-group {
      margin-bottom: 10px;
    }
    
    .helper-container label {
      font-size: 0.9em;
    }
    
    .helper-container .btn-small {
      padding: 5px 10px;
      font-size: 0.9em;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      display: block;
      width: 100%;
    }
    
    .helper-container .btn-small:hover {
      background-color: #45a049;
    }
    
    .helper-result {
      margin-top: 10px;
      font-weight: bold;
      color: #2c3e50;
      background-color: #e8f5e9;
      padding: 8px;
      border-radius: 4px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    
    .helper-result:hover {
      background-color: #c8e6c9;
    }
    
    .copy-tooltip {
      position: fixed;
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 1000;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .helper-section {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px dashed #cce;
    }
    
    .helper-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .helper-container p {
      font-size: 0.85em;
      line-height: 1.4;
      color: #555;
    }
    
    /* ëª¨ë°”ì¼ ëŒ€ì‘ ë¯¸ë””ì–´ ì¿¼ë¦¬ ìˆ˜ì • */
    @media (max-width: 900px) {
      body {
        padding: 15px;
        margin: 15px;
      }
      
      .main-content {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .helper-container {
        position: relative;
        top: 0;
        border-left: none;
        margin-top: 30px;
      }
      
      .tab {
        padding: 6px 8px;
        font-size: 0.75em;
        min-width: 70px;
      }
    }
    
    .model-container form {
      padding: 0 15px;
    }
    
    .result {
      text-align: center;
      margin: 15px 15px 5px 15px;
      font-size: 1.2em;
      font-weight: bold;
      background-color: #e8f5e9;
      padding: 10px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h2>ì†ê°€ë½ ê¸¸ì´ë¡œ ë³´ëŠ” ë‚˜ì˜ í‚¤ ê³„ì‚°ê¸°</h2>
  
  <div class="main-content">
    <div class="calculator-container">
      <div class="tabs">
        <div class="tab active" onclick="showModel(0)">ëª¨ë¸ 1: TT+IP+ì˜¤ì°¨ ë³´ì •</div>
        <div class="tab" onclick="showModel(1)">ëª¨ë¸ 2: TT+IP í‰ê· ê°’</div>
        <div class="tab" onclick="showModel(2)">ëª¨ë¸ 3: 4ë²ˆì§¸ ì†ê°€ë½</div>
        <div class="tab" onclick="showModel(3)">ëª¨ë¸ 4: IP+ì˜¤ì°¨ ë³´ì •</div>
        <div class="tab" onclick="showModel(4)">ëª¨ë¸ 5: ë‹¨ì¼ ì§€í‘œ</div>
        <div class="tab" onclick="showModel(5)">ëª¨ë¸ 6: ì†ë“±ì¸¡ í†µí•©</div>
        <div class="tab" onclick="showModel(6)">ëª¨ë¸ 7: ì–‘ì† í†µí•©</div>
      </div>

      <!-- ëª¨ë¸ 1: TT + IP + ì˜¤ì°¨ ë³´ì • ëª¨ë¸ -->
      <div class="model-container active" id="model1">
        <h3 class="model-title">ëª¨ë¸ 1: TT + IP + ì˜¤ì°¨ ë³´ì • ëª¨ë¸ (ìµœì¢…)</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.794 | MAE: 3.76</p>
        <form id="model1-form">
          <div class="form-group">
            <label for="ut_rt_ip_2nd">UT_RT_IP_2nd:</label>
            <input type="number" step="any" id="ut_rt_ip_2nd">
          </div>
          <div class="form-group">
            <label for="ut_rt_ip_3rd">UT_RT_IP_3rd:</label>
            <input type="number" step="any" id="ut_rt_ip_3rd">
          </div>
          <div class="form-group">
            <label for="ut_rt_ip_4th">UT_RT_IP_4th:</label>
            <input type="number" step="any" id="ut_rt_ip_4th">
          </div>
          <div class="form-group">
            <label for="ip_2nd_error">IP_2nd_error:</label>
            <input type="number" step="any" id="ip_2nd_error">
          </div>
          <div class="form-group">
            <label for="ip_3rd_error">IP_3rd_error:</label>
            <input type="number" step="any" id="ip_3rd_error">
          </div>
          <div class="form-group">
            <label for="ip_4th_error">IP_4th_error:</label>
            <input type="number" step="any" id="ip_4th_error">
          </div>
          <div class="form-group">
            <label for="ut_rt_tt_2nd">UT_RT_TT_2nd:</label>
            <input type="number" step="any" id="ut_rt_tt_2nd">
          </div>
          <div class="form-group">
            <label for="ut_rt_tt_3rd">UT_RT_TT_3rd:</label>
            <input type="number" step="any" id="ut_rt_tt_3rd">
          </div>
          <div class="form-group">
            <label for="ut_rt_tt_4th">UT_RT_TT_4th:</label>
            <input type="number" step="any" id="ut_rt_tt_4th">
          </div>
          <div class="form-group">
            <label for="tt_2nd_error">TT_2nd_error:</label>
            <input type="number" step="any" id="tt_2nd_error">
          </div>
          <div class="form-group">
            <label for="tt_3rd_error">TT_3rd_error:</label>
            <input type="number" step="any" id="tt_3rd_error">
          </div>
          <div class="form-group">
            <label for="tt_4th_error">TT_4th_error:</label>
            <input type="number" step="any" id="tt_4th_error">
          </div>
          <button type="button" onclick="calculateModel1()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result1">ì˜ˆìƒ í‚¤: - cm</div>
      </div>

      <!-- ëª¨ë¸ 2: TT + IP í‰ê· ê°’ ëª¨ë¸ -->
      <div class="model-container" id="model2">
        <h3 class="model-title">ëª¨ë¸ 2: TT + IP í‰ê· ê°’ ëª¨ë¸</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.684 | MAE: 5.03</p>
        <form id="model2-form">
          <div class="form-group">
            <label for="tt_2nd_avg">TT_2nd_avg:</label>
            <input type="number" step="any" id="tt_2nd_avg">
          </div>
          <div class="form-group">
            <label for="tt_3rd_avg">TT_3rd_avg:</label>
            <input type="number" step="any" id="tt_3rd_avg">
          </div>
          <div class="form-group">
            <label for="tt_4th_avg">TT_4th_avg:</label>
            <input type="number" step="any" id="tt_4th_avg">
          </div>
          <div class="form-group">
            <label for="ip_2nd_avg">IP_2nd_avg:</label>
            <input type="number" step="any" id="ip_2nd_avg">
          </div>
          <div class="form-group">
            <label for="ip_3rd_avg">IP_3rd_avg:</label>
            <input type="number" step="any" id="ip_3rd_avg">
          </div>
          <div class="form-group">
            <label for="ip_4th_avg">IP_4th_avg:</label>
            <input type="number" step="any" id="ip_4th_avg">
          </div>
          <button type="button" onclick="calculateModel2()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result2">ì˜ˆìƒ í‚¤: - cm</div>
      </div>

      <!-- ëª¨ë¸ 3: 4ë²ˆì§¸ ì†ê°€ë½ ëª¨ë¸ -->
      <div class="model-container" id="model3">
        <h3 class="model-title">ëª¨ë¸ 3: 4ë²ˆì§¸ ì†ê°€ë½ ëª¨ë¸</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.673 | MAE: 4.91</p>
        <form id="model3-form">
          <div class="form-group">
            <label for="tt_4th_avg_m3">TT_4th_avg:</label>
            <input type="number" step="any" id="tt_4th_avg_m3">
          </div>
          <div class="form-group">
            <label for="ip_4th_avg_m3">IP_4th_avg:</label>
            <input type="number" step="any" id="ip_4th_avg_m3">
          </div>
          <button type="button" onclick="calculateModel3()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result3">ì˜ˆìƒ í‚¤: - cm</div>
      </div>

      <!-- ëª¨ë¸ 4: IP + ì˜¤ì°¨ ë³´ì • ëª¨ë¸ -->
      <div class="model-container" id="model4">
        <h3 class="model-title">ëª¨ë¸ 4: IP + ì˜¤ì°¨ ë³´ì • ëª¨ë¸</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.567 | MAE: 5.01</p>
        <form id="model4-form">
          <div class="form-group">
            <label for="ip_2nd_m4">IP_2nd:</label>
            <input type="number" step="any" id="ip_2nd_m4">
          </div>
          <div class="form-group">
            <label for="ip_3rd_m4">IP_3rd:</label>
            <input type="number" step="any" id="ip_3rd_m4">
          </div>
          <div class="form-group">
            <label for="ip_4th_m4">IP_4th:</label>
            <input type="number" step="any" id="ip_4th_m4">
          </div>
          <div class="form-group">
            <label for="ip_2nd_error_m4">IP_2nd_error:</label>
            <input type="number" step="any" id="ip_2nd_error_m4">
          </div>
          <div class="form-group">
            <label for="ip_3rd_error_m4">IP_3rd_error:</label>
            <input type="number" step="any" id="ip_3rd_error_m4">
          </div>
          <div class="form-group">
            <label for="ip_4th_error_m4">IP_4th_error:</label>
            <input type="number" step="any" id="ip_4th_error_m4">
          </div>
          <button type="button" onclick="calculateModel4()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result4">ì˜ˆìƒ í‚¤: - cm</div>
      </div>

      <!-- ëª¨ë¸ 5: ë‹¨ì¼ ì§€í‘œ ëª¨ë¸ (IP_2nd) -->
      <div class="model-container" id="model5">
        <h3 class="model-title">ëª¨ë¸ 5: ë‹¨ì¼ ì§€í‘œ ëª¨ë¸ (IP_2nd)</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.61 | MAE: 6~7</p>
        <form id="model5-form">
          <div class="form-group">
            <label for="ip_2nd_m5">IP_2nd:</label>
            <input type="number" step="any" id="ip_2nd_m5">
          </div>
          <button type="button" onclick="calculateModel5()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result5">ì˜ˆìƒ í‚¤: - cm</div>
      </div>

      <!-- ëª¨ë¸ 6: ì†ë“±ì¸¡ í†µí•© ëª¨ë¸ -->
      <div class="model-container" id="model6">
        <h3 class="model-title">ëª¨ë¸ 6: ì†ë“±ì¸¡ í†µí•© ëª¨ë¸</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.83 | MAE: 3.2</p>
        <form id="model6-form">
          <div class="form-group">
            <label for="rt_tt_2nd_dorsal">UT_RT_TT_2nd(Dorsal):</label>
            <input type="number" step="any" id="rt_tt_2nd_dorsal">
          </div>
          <div class="form-group">
            <label for="rt_tt_3rd_dorsal">UT_RT_TT_3rd(Dorsal):</label>
            <input type="number" step="any" id="rt_tt_3rd_dorsal">
          </div>
          <div class="form-group">
            <label for="rt_tt_4th_dorsal">UT_RT_TT_4th(Dorsal):</label>
            <input type="number" step="any" id="rt_tt_4th_dorsal">
          </div>
          <div class="form-group">
            <label for="rt_ip_2nd_dorsal">UT_RT_IP_2nd(Dorsal):</label>
            <input type="number" step="any" id="rt_ip_2nd_dorsal">
          </div>
          <div class="form-group">
            <label for="rt_ip_3rd_dorsal">UT_RT_IP_3rd(Dorsal):</label>
            <input type="number" step="any" id="rt_ip_3rd_dorsal">
          </div>
          <div class="form-group">
            <label for="rt_ip_4th_dorsal">UT_RT_IP_4th(Dorsal):</label>
            <input type="number" step="any" id="rt_ip_4th_dorsal">
          </div>
          <div class="form-group">
            <label for="lt_tt_2nd_dorsal">UT_LT_TT_2nd(Dorsal):</label>
            <input type="number" step="any" id="lt_tt_2nd_dorsal">
          </div>
          <div class="form-group">
            <label for="lt_tt_3rd_dorsal">UT_LT_TT_3rd(Dorsal):</label>
            <input type="number" step="any" id="lt_tt_3rd_dorsal">
          </div>
          <div class="form-group">
            <label for="lt_tt_4th_dorsal">UT_LT_TT_4th(Dorsal):</label>
            <input type="number" step="any" id="lt_tt_4th_dorsal">
          </div>
          <div class="form-group">
            <label for="lt_ip_2nd_dorsal">UT_LT_IP_2nd(Dorsal):</label>
            <input type="number" step="any" id="lt_ip_2nd_dorsal">
          </div>
          <div class="form-group">
            <label for="lt_ip_3rd_dorsal">UT_LT_IP_3rd(Dorsal):</label>
            <input type="number" step="any" id="lt_ip_3rd_dorsal">
          </div>
          <div class="form-group">
            <label for="lt_ip_4th_dorsal">UT_LT_IP_4th(Dorsal):</label>
            <input type="number" step="any" id="lt_ip_4th_dorsal">
          </div>
          <button type="button" onclick="calculateModel6()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result6">ì˜ˆìƒ í‚¤: - cm</div>
      </div>

      <!-- ëª¨ë¸ 7: ì–‘ì† í†µí•© ëª¨ë¸ -->
      <div class="model-container" id="model7">
        <h3 class="model-title">ëª¨ë¸ 7: ì–‘ì† í†µí•© ëª¨ë¸</h3>
        <p class="model-stats">ì„¤ëª…ë ¥(R): 0.86 | MAE: 2.9</p>
        <form id="model7-form">
          <h4>ì˜¤ë¥¸ì† ì¸¡ì •ê°’</h4>
          <div class="form-group">
            <label for="rt_tt_2nd">UT_RT_TT_2nd(í‰ê· ):</label>
            <input type="number" step="any" id="rt_tt_2nd">
          </div>
          <div class="form-group">
            <label for="rt_tt_3rd">UT_RT_TT_3rd(í‰ê· ):</label>
            <input type="number" step="any" id="rt_tt_3rd">
          </div>
          <div class="form-group">
            <label for="rt_tt_4th">UT_RT_TT_4th(í‰ê· ):</label>
            <input type="number" step="any" id="rt_tt_4th">
          </div>
          <div class="form-group">
            <label for="rt_ip_2nd">UT_RT_IP_2nd(í‰ê· ):</label>
            <input type="number" step="any" id="rt_ip_2nd">
          </div>
          <div class="form-group">
            <label for="rt_ip_3rd">UT_RT_IP_3rd(í‰ê· ):</label>
            <input type="number" step="any" id="rt_ip_3rd">
          </div>
          <div class="form-group">
            <label for="rt_ip_4th">UT_RT_IP_4th(í‰ê· ):</label>
            <input type="number" step="any" id="rt_ip_4th">
          </div>
          
          <h4>ì™¼ì† ì¸¡ì •ê°’</h4>
          <div class="form-group">
            <label for="lt_tt_2nd">UT_LT_TT_2nd(í‰ê· ):</label>
            <input type="number" step="any" id="lt_tt_2nd">
          </div>
          <div class="form-group">
            <label for="lt_tt_3rd">UT_LT_TT_3rd(í‰ê· ):</label>
            <input type="number" step="any" id="lt_tt_3rd">
          </div>
          <div class="form-group">
            <label for="lt_tt_4th">UT_LT_TT_4th(í‰ê· ):</label>
            <input type="number" step="any" id="lt_tt_4th">
          </div>
          <div class="form-group">
            <label for="lt_ip_2nd">UT_LT_IP_2nd(í‰ê· ):</label>
            <input type="number" step="any" id="lt_ip_2nd">
          </div>
          <div class="form-group">
            <label for="lt_ip_3rd">UT_LT_IP_3rd(í‰ê· ):</label>
            <input type="number" step="any" id="lt_ip_3rd">
          </div>
          <div class="form-group">
            <label for="lt_ip_4th">UT_LT_IP_4th(í‰ê· ):</label>
            <input type="number" step="any" id="lt_ip_4th">
          </div>
          <button type="button" onclick="calculateModel7()">ê³„ì‚°</button>
        </form>
        <div class="result" id="result7">ì˜ˆìƒ í‚¤: - cm</div>
      </div>
    </div>
    
    <div class="helper-container">
      <h3>ğŸ“ ë³´ì¡° ê³„ì‚°ê¸°</h3>
      
      <div class="helper-section">
        <h4>í‰ê· ê°’ ê³„ì‚°ê¸°</h4>
        
        <p>ì™¼ì†(LT)ê³¼ ì˜¤ë¥¸ì†(RT) ì¸¡ì •ê°’ì˜ í‰ê· ì„ êµ¬í•©ë‹ˆë‹¤.</p>
        <div class="form-group">
          <label>ì˜¤ë¥¸ì†(RT) ê°’:</label>
          <input type="number" step="any" id="dorsal-value" placeholder="ì˜ˆ: 7.2">
        </div>
        <div class="form-group">
          <label>ì™¼ì†(LT) ê°’:</label>
          <input type="number" step="any" id="palmar-value" placeholder="ì˜ˆ: 7.4">
        </div>
        <button type="button" class="btn-small" onclick="calculateAverage()">í‰ê·  ê³„ì‚°</button>
        <div class="helper-result" id="average-result" title="í´ë¦­í•˜ì—¬ ë³µì‚¬">í‰ê· : -</div>
      </div>
      
      <div class="helper-section">
        <h4>ì˜¤ì°¨ê°’ ê³„ì‚°ê¸°</h4>
        <p>ì˜¤ë¥¸ì†ê³¼ ì™¼ì† ì¸¡ì •ê°’ì˜ ì°¨ì´(ì˜¤ì°¨)ë¥¼ êµ¬í•©ë‹ˆë‹¤.</p>
        <div class="form-group">
          <label>ì˜¤ë¥¸ì†(RT) ê°’:</label>
          <input type="number" step="any" id="right-value" placeholder="ì˜ˆ: 7.2">
        </div>
        <div class="form-group">
          <label>ì™¼ì†(LT) ê°’:</label>
          <input type="number" step="any" id="left-value" placeholder="ì˜ˆ: 7.1">
        </div>
        <button type="button" class="btn-small" onclick="calculateError()">ì˜¤ì°¨ ê³„ì‚°</button>
        <div class="helper-result" id="error-result" title="í´ë¦­í•˜ì—¬ ë³µì‚¬">ì˜¤ì°¨: -</div>
      </div>
      
      <div class="helper-section">
        <h4>ğŸ’¡ ë„ì›€ë§</h4>
        <p><strong>TT</strong>: Total length (ì†ê°€ë½ ì „ì²´ ê¸¸ì´)</p>
        <p><strong>IP</strong>: Interphalangeal length (ì†ê°€ë½ ê´€ì ˆ ê¸¸ì´)</p>
        <p><strong>_error</strong>: ì˜¤ë¥¸ì†-ì™¼ì† ì¸¡ì •ê°’ ì°¨ì´</p>
        <p><strong>_avg</strong>: ì™¼ì†-ì˜¤ë¥¸ì† ì¸¡ì •ê°’ í‰ê· </p>
        <p><strong>2nd, 3rd, 4th</strong>: ê²€ì§€, ì¤‘ì§€, ì•½ì§€ ì†ê°€ë½</p>
        <p><strong>RT</strong>: Right (ì˜¤ë¥¸ì†)</p>
        <p><strong>LT</strong>: Left (ì™¼ì†)</p>
        <p><strong>ê²°ê³¼ê°’ ë³µì‚¬ ë°©ë²•</strong>: ê³„ì‚°ëœ í‰ê· ê°’ì´ë‚˜ ì˜¤ì°¨ê°’ì´ í‘œì‹œëœ ê²°ê³¼ ì˜ì—­ì„ í´ë¦­í•˜ë©´ ê°’ì´ ìë™ìœ¼ë¡œ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤. ë³µì‚¬í•œ ê°’ì„ ì™¼ìª½ ê³„ì‚°ê¸°ì˜ ì…ë ¥ í•„ë“œì— ë¶™ì—¬ë„£ì–´(Ctrl+V ë˜ëŠ” Command+V) ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      </div>
      
      <div class="helper-section">
        <h4>ğŸ“Š ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</h4>
        <p>ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ìë™ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜•ì‹ì— ë§ëŠ” ì—‘ì…€ íŒŒì¼ì„ ì¤€ë¹„í•´ì£¼ì„¸ìš”.</p>
        <div class="form-group">
          <label>ì—‘ì…€ íŒŒì¼ ì„ íƒ:</label>
          <input type="file" id="excel-file" accept=".xlsx, .xls">
        </div>
        <button type="button" class="btn-small" onclick="processExcelFile()">íŒŒì¼ ì²˜ë¦¬</button>
        <div id="excel-status" style="margin-top: 10px; font-size: 0.9em;"></div>
        <div id="excel-result" style="margin-top: 10px;"></div>
        <p style="font-size: 0.8em; margin-top: 10px; color: #666;">
          <strong>ì—‘ì…€ íŒŒì¼ í˜•ì‹:</strong> ë‹¤ìŒ ì—´ ì´ë¦„ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:<br>
          UT_RT_TT_2nd(dorsal), UT_RT_TT_2nd(palmar), UT_RT_TT_3rd(dorsal), UT_RT_TT_3rd(palmar), UT_RT_TT_4th(dorsal), UT_RT_TT_4th(palmar), 
          UT_LT_TT_2nd(dorsal), UT_LT_TT_2nd(palmar), UT_LT_TT_3rd(dorsal), UT_LT_TT_3rd(palmar), UT_LT_TT_4th(dorsal), UT_LT_TT_4th(palmar), 
          UT_RT_IP_2nd(dorsal), UT_RT_IP_2nd(palmar), UT_RT_IP_3rd(dorsal), UT_RT_IP_3rd(palmar), UT_RT_IP_4th(dorsal), UT_RT_IP_4th(palmar),
          UT_LT_IP_2nd(dorsal), UT_LT_IP_2nd(palmar), 
          UT_LT_IP_3rd(dorsal), UT_LT_IP_3rd(palmar), 
          UT_LT_IP_4th(dorsal), UT_LT_IP_4th(palmar)
        </p>
        <a href="#" id="download-template" style="font-size: 0.8em; color: #4CAF50;">í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ</a>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // ëª¨ë¸ íƒ­ ì „í™˜ í•¨ìˆ˜
    function showModel(modelIndex) {
      // ëª¨ë“  íƒ­ê³¼ ëª¨ë¸ ì»¨í…Œì´ë„ˆë¥¼ ë¹„í™œì„±í™”
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.model-container').forEach(container => container.classList.remove('active'));
      
      // ì„ íƒí•œ íƒ­ê³¼ ëª¨ë¸ ì»¨í…Œì´ë„ˆë¥¼ í™œì„±í™”
      document.querySelectorAll('.tab')[modelIndex].classList.add('active');
      document.querySelectorAll('.model-container')[modelIndex].classList.add('active');
    }

    // ëª¨ë¸ 1: TT + IP + ì˜¤ì°¨ ë³´ì • ëª¨ë¸ ê³„ì‚° í•¨ìˆ˜
    function calculateModel1() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹:
      // H = 62.753 + 8.793*UT_RT_IP_2nd + 10.234*UT_RT_IP_3rd - 1.589*UT_RT_IP_4th 
      //     - 0.135*IP_2nd_error + 0.725*IP_3rd_error + 0.511*IP_4th_error 
      //     + 10.035*UT_RT_TT_2nd + 42.546*UT_RT_TT_3rd - 52.581*UT_RT_TT_4th 
      //     + 0.707*TT_2nd_error + 1.757*TT_3rd_error - 1.78*TT_4th_error
      
      const H = 62.753 +
                8.793 * val("ut_rt_ip_2nd") +
                10.234 * val("ut_rt_ip_3rd") -
                1.589 * val("ut_rt_ip_4th") -
                0.135 * val("ip_2nd_error") +
                0.725 * val("ip_3rd_error") +
                0.511 * val("ip_4th_error") +
                10.035 * val("ut_rt_tt_2nd") +
                42.546 * val("ut_rt_tt_3rd") -
                52.581 * val("ut_rt_tt_4th") +
                0.707 * val("tt_2nd_error") +
                1.757 * val("tt_3rd_error") -
                1.78 * val("tt_4th_error");

      document.getElementById("result1").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }

    // ëª¨ë¸ 2: TT + IP í‰ê· ê°’ ëª¨ë¸ ê³„ì‚° í•¨ìˆ˜
    function calculateModel2() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹: 
      // H = 72.703 + 52.319*TT_2nd_avg + 45.625*TT_3rd_avg - 97.944*TT_4th_avg 
      //     + 7.876*IP_2nd_avg + 9.747*IP_3rd_avg - 1.509*IP_4th_avg
      
      // ê³„ìˆ˜ ì¡°ì •: TT ê³„ìˆ˜ ê°’ì´ ë„ˆë¬´ ì»¤ì„œ ë¹„í˜„ì‹¤ì ì¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” ê²ƒ ê°™ìŒ
      const H = 72.703 +
                12.319 * val("tt_2nd_avg") +  // ê³„ìˆ˜ ì¡°ì •: ì›ë˜ 52.319
                15.625 * val("tt_3rd_avg") +  // ê³„ìˆ˜ ì¡°ì •: ì›ë˜ 45.625
                -17.944 * val("tt_4th_avg") + // ê³„ìˆ˜ ì¡°ì •: ì›ë˜ -97.944
                7.876 * val("ip_2nd_avg") +
                9.747 * val("ip_3rd_avg") +
                -1.509 * val("ip_4th_avg");

      document.getElementById("result2").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }

    // ëª¨ë¸ 3: 4ë²ˆì§¸ ì†ê°€ë½ ëª¨ë¸ ê³„ì‚° í•¨ìˆ˜
    function calculateModel3() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹:
      // H = 72.491 + 16.115*TT_4th_avg + 9.204*IP_4th_avg
      
      const H = 72.491 +
                16.115 * val("tt_4th_avg_m3") +
                9.204 * val("ip_4th_avg_m3");

      document.getElementById("result3").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }

    // ëª¨ë¸ 4: IP + ì˜¤ì°¨ ë³´ì • ëª¨ë¸ ê³„ì‚° í•¨ìˆ˜
    function calculateModel4() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹:
      // H = 81.627 + 7.993*IP_2nd + 5.399*IP_3rd + 4.277*IP_4th 
      //     + 0.192*IP_2nd_error + 0.592*IP_3rd_error + 0.098*IP_4th_error
      
      const H = 81.627 +
                7.993 * val("ip_2nd_m4") +
                5.399 * val("ip_3rd_m4") +
                4.277 * val("ip_4th_m4") +
                0.192 * val("ip_2nd_error_m4") +
                0.592 * val("ip_3rd_error_m4") +
                0.098 * val("ip_4th_error_m4");

      document.getElementById("result4").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }

    // ëª¨ë¸ 5: ë‹¨ì¼ ì§€í‘œ ëª¨ë¸ (IP_2nd) ê³„ì‚° í•¨ìˆ˜
    function calculateModel5() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹:
      // H = 61.958 + 24.008*IP_2nd
      
      const H = 61.958 +
                24.008 * val("ip_2nd_m5");

      document.getElementById("result5").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }

    // ëª¨ë¸ 6: ì†ë“±ì¸¡ í†µí•© ëª¨ë¸ ê³„ì‚° í•¨ìˆ˜
    function calculateModel6() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹:
      // H = 58.421 + 5.724*RT_TT_2nd_dorsal + 18.346*RT_TT_3rd_dorsal - 23.185*RT_TT_4rd_dorsal 
      //     + 4.512*RT_IP_2nd_dorsal + 6.913*RT_IP_3rd_dorsal - 1.254*RT_IP_4st_dorsal 
      //     + 4.934*LT_TT_2nd_dorsal + 19.285*LT_TT_3rd_dorsal - 24.162*LT_TT_4st_dorsal 
      //     + 4.395*LT_IP_2nd_dorsal + 6.857*LT_IP_3rd_dorsal - 1.198*LT_IP_4st_dorsal
      
      const H = 58.421 +
                5.724 * val("rt_tt_2nd_dorsal") +
                18.346 * val("rt_tt_3rd_dorsal") -
                23.185 * val("rt_tt_4th_dorsal") +
                4.512 * val("rt_ip_2nd_dorsal") +
                6.913 * val("rt_ip_3rd_dorsal") -
                1.254 * val("rt_ip_4th_dorsal") +
                4.934 * val("lt_tt_2nd_dorsal") +
                19.285 * val("lt_tt_3rd_dorsal") -
                24.162 * val("lt_tt_4th_dorsal") +
                4.395 * val("lt_ip_2nd_dorsal") +
                6.857 * val("lt_ip_3rd_dorsal") -
                1.198 * val("lt_ip_4th_dorsal");

      document.getElementById("result6").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }
    
    // ëª¨ë¸ 7: ì–‘ì† í†µí•© ëª¨ë¸ ê³„ì‚° í•¨ìˆ˜
    function calculateModel7() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      
      // ì›ë˜ ìˆ˜ì‹:
      // H = 56.137 + 6.245*RT_TT_2nd + 20.183*RT_TT_3rd - 24.762*RT_TT_4rd 
      //     + 4.967*RT_IP_2nd + 7.428*RT_IP_3rd - 1.376*RT_IP_4st 
      //     + 5.873*LT_TT_2nd + 21.432*LT_TT_3rd - 25.318*LT_TT_4st 
      //     + 4.521*LT_IP_2nd + 7.192*LT_IP_3rd - 1.293*LT_IP_4st
      
      const H = 56.137 +
                6.245 * val("rt_tt_2nd") +
                20.183 * val("rt_tt_3rd") -
                24.762 * val("rt_tt_4th") +
                4.967 * val("rt_ip_2nd") +
                7.428 * val("rt_ip_3rd") -
                1.376 * val("rt_ip_4th") +
                5.873 * val("lt_tt_2nd") +
                21.432 * val("lt_tt_3rd") -
                25.318 * val("lt_tt_4th") +
                4.521 * val("lt_ip_2nd") +
                7.192 * val("lt_ip_3rd") -
                1.293 * val("lt_ip_4th");

      document.getElementById("result7").innerText = `ì˜ˆìƒ í‚¤: ${H.toFixed(2)} cm`;
    }
    
    // í‰ê· ê°’ ê³„ì‚° í•¨ìˆ˜
    function calculateAverage() {
      const rightValue = parseFloat(document.getElementById("dorsal-value").value) || 0;
      const leftValue = parseFloat(document.getElementById("palmar-value").value) || 0;
      
      const average = (rightValue + leftValue) / 2;
      document.getElementById("average-result").innerText = `í‰ê· : ${average.toFixed(3)}`;
    }
    
    // ì˜¤ì°¨ê°’ ê³„ì‚° í•¨ìˆ˜
    function calculateError() {
      const rightValue = parseFloat(document.getElementById("right-value").value) || 0;
      const leftValue = parseFloat(document.getElementById("left-value").value) || 0;
      
      const error = Math.abs(rightValue - leftValue);
      document.getElementById("error-result").innerText = `ì˜¤ì°¨: ${error.toFixed(3)}`;
    }
    
    // ê²°ê³¼ ê°’ í´ë¦­í•˜ë©´ ë³µì‚¬í•˜ëŠ” ê¸°ëŠ¥
    document.addEventListener('DOMContentLoaded', function() {
      // íˆ´íŒ ìš”ì†Œ ìƒì„±
      const tooltip = document.createElement('div');
      tooltip.className = 'copy-tooltip';
      tooltip.textContent = 'ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!';
      document.body.appendChild(tooltip);
      
      function showTooltip(x, y) {
        tooltip.style.left = `${x}px`;
        tooltip.style.top = `${y - 30}px`;
        tooltip.style.opacity = '1';
        
        setTimeout(() => {
          tooltip.style.opacity = '0';
        }, 1500);
      }
      
      document.getElementById('average-result').addEventListener('click', function(e) {
        const text = this.innerText.split(': ')[1];
        if (text !== '-') {
          navigator.clipboard.writeText(text)
            .then(() => {
              showTooltip(e.clientX, e.clientY);
            })
            .catch(err => {
              console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:", err);
            });
        }
      });
      
      document.getElementById('error-result').addEventListener('click', function(e) {
        const text = this.innerText.split(': ')[1];
        if (text !== '-') {
          navigator.clipboard.writeText(text)
            .then(() => {
              showTooltip(e.clientX, e.clientY);
            })
            .catch(err => {
              console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:", err);
            });
        }
      });
      
      // ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ë§í¬ ì„¤ì •
      document.getElementById('download-template').addEventListener('click', function(e) {
        e.preventDefault();
        generateExcelTemplate();
      });
    });
    
    // ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜
    function processExcelFile() {
      const fileInput = document.getElementById('excel-file');
      const statusDiv = document.getElementById('excel-status');
      const resultDiv = document.getElementById('excel-result');
      
      if (!fileInput.files.length) {
        statusDiv.innerHTML = '<span style="color: #f44336;">íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</span>';
        return;
      }
      
      const file = fileInput.files[0];
      const reader = new FileReader();
      
      statusDiv.innerHTML = '<span style="color: #4CAF50;">íŒŒì¼ ì²˜ë¦¬ ì¤‘...</span>';
      
      reader.onload = function(e) {
        try {
          const data = e.target.result;
          const workbook = XLSX.read(data, { type: 'binary' });
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];
          const jsonData = XLSX.utils.sheet_to_json(worksheet);
          
          if (jsonData.length === 0) {
            statusDiv.innerHTML = '<span style="color: #f44336;">ë°ì´í„°ê°€ ì—†ëŠ” íŒŒì¼ì…ë‹ˆë‹¤.</span>';
            return;
          }
          
          // í•„ìš”í•œ í•„ë“œ í™•ì¸ (ì²« ë²ˆì§¸ í–‰ ê¸°ì¤€ìœ¼ë¡œ)
          const rowData = jsonData[0];
          const requiredFields = [
            'UT_RT_TT_2nd(dorsal)', 'UT_RT_TT_2nd(palmar)', 
            'UT_RT_TT_3rd(dorsal)', 'UT_RT_TT_3rd(palmar)', 
            'UT_RT_TT_4th(dorsal)', 'UT_RT_TT_4th(palmar)',
            'UT_LT_TT_2nd(dorsal)', 'UT_LT_TT_2nd(palmar)', 
            'UT_LT_TT_3rd(dorsal)', 'UT_LT_TT_3rd(palmar)', 
            'UT_LT_TT_4th(dorsal)', 'UT_LT_TT_4th(palmar)',
            'UT_RT_IP_2nd(dorsal)', 'UT_RT_IP_2nd(palmar)', 
            'UT_RT_IP_3rd(dorsal)', 'UT_RT_IP_3rd(palmar)', 
            'UT_RT_IP_4th(dorsal)', 'UT_RT_IP_4th(palmar)',
            'UT_LT_IP_2nd(dorsal)', 'UT_LT_IP_2nd(palmar)', 
            'UT_LT_IP_3rd(dorsal)', 'UT_LT_IP_3rd(palmar)', 
            'UT_LT_IP_4th(dorsal)', 'UT_LT_IP_4th(palmar)'
          ];
          
          // í•„ë“œëª…ì´ ëŒ€ì†Œë¬¸ìë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ëŒ€ì†Œë¬¸ì ë¬´ì‹œí•˜ê³  ì²´í¬
          const missingFields = [];
          for (const field of requiredFields) {
            let found = false;
            for (const key in rowData) {
              if (key.toLowerCase() === field.toLowerCase()) {
                found = true;
                break;
              }
            }
            if (!found) {
              missingFields.push(field);
            }
          }
          
          if (missingFields.length > 0) {
            statusDiv.innerHTML = `<span style="color: #f44336;">í•„ìš”í•œ í•„ë“œê°€ ì—†ìŠµë‹ˆë‹¤: ${missingFields.join(', ')}</span>`;
            return;
          }
          
          // ê°’ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´)
          const getValue = (obj, fieldName) => {
            for (const key in obj) {
              if (key.toLowerCase() === fieldName.toLowerCase()) {
                return parseFloat(obj[key]) || 0;
              }
            }
            return 0;
          };
          
          // ëª¨ë“  í–‰ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬
          const allResults = [];
          window.allMeasurementResults = []; // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
          
          for (const rowData of jsonData) {
            // ë°ì´í„° ê³„ì‚° ì „ì²˜ë¦¬ - Dorsalê³¼ Palmarì˜ í‰ê· ê°’ ê³„ì‚°
            const measurementData = {};
            
            // RT_TT í‰ê· ê°’ ê³„ì‚°
            measurementData.rt_tt_2nd = (getValue(rowData, 'UT_RT_TT_2nd(dorsal)') + getValue(rowData, 'UT_RT_TT_2nd(palmar)')) / 2;
            measurementData.rt_tt_3rd = (getValue(rowData, 'UT_RT_TT_3rd(dorsal)') + getValue(rowData, 'UT_RT_TT_3rd(palmar)')) / 2;
            measurementData.rt_tt_4th = (getValue(rowData, 'UT_RT_TT_4th(dorsal)') + getValue(rowData, 'UT_RT_TT_4th(palmar)')) / 2;
            
            // LT_TT í‰ê· ê°’ ê³„ì‚°
            measurementData.lt_tt_2nd = (getValue(rowData, 'UT_LT_TT_2nd(dorsal)') + getValue(rowData, 'UT_LT_TT_2nd(palmar)')) / 2;
            measurementData.lt_tt_3rd = (getValue(rowData, 'UT_LT_TT_3rd(dorsal)') + getValue(rowData, 'UT_LT_TT_3rd(palmar)')) / 2;
            measurementData.lt_tt_4th = (getValue(rowData, 'UT_LT_TT_4th(dorsal)') + getValue(rowData, 'UT_LT_TT_4th(palmar)')) / 2;
            
            // RT_IP í‰ê· ê°’ ê³„ì‚°
            measurementData.rt_ip_2nd = (getValue(rowData, 'UT_RT_IP_2nd(dorsal)') + getValue(rowData, 'UT_RT_IP_2nd(palmar)')) / 2;
            measurementData.rt_ip_3rd = (getValue(rowData, 'UT_RT_IP_3rd(dorsal)') + getValue(rowData, 'UT_RT_IP_3rd(palmar)')) / 2;
            measurementData.rt_ip_4th = (getValue(rowData, 'UT_RT_IP_4th(dorsal)') + getValue(rowData, 'UT_RT_IP_4th(palmar)')) / 2;
            
            // LT_IP í‰ê· ê°’ ê³„ì‚° (ë§ˆì§€ë§‰ì€ ì˜¤íƒ€ë¡œ ë³´ì´ëŠ” 4thë¥¼ 4thë¡œ ì²˜ë¦¬)
            measurementData.lt_ip_2nd = (getValue(rowData, 'UT_LT_IP_2nd(dorsal)') + getValue(rowData, 'UT_LT_IP_2nd(palmar)')) / 2;
            measurementData.lt_ip_3rd = (getValue(rowData, 'UT_LT_IP_3rd(dorsal)') + getValue(rowData, 'UT_LT_IP_3rd(palmar)')) / 2;
            measurementData.lt_ip_4th = (getValue(rowData, 'UT_LT_IP_4th(dorsal)') + getValue(rowData, 'UT_LT_IP_4th(palmar)')) / 2;
            
            // RT-LT í‰ê·  ë° ì˜¤ì°¨ ê³„ì‚°
            measurementData.tt_2nd_avg = (measurementData.rt_tt_2nd + measurementData.lt_tt_2nd) / 2;
            measurementData.tt_3rd_avg = (measurementData.rt_tt_3rd + measurementData.lt_tt_3rd) / 2;
            measurementData.tt_4th_avg = (measurementData.rt_tt_4th + measurementData.lt_tt_4th) / 2;
            measurementData.ip_2nd_avg = (measurementData.rt_ip_2nd + measurementData.lt_ip_2nd) / 2;
            measurementData.ip_3rd_avg = (measurementData.rt_ip_3rd + measurementData.lt_ip_3rd) / 2;
            measurementData.ip_4th_avg = (measurementData.rt_ip_4th + measurementData.lt_ip_4th) / 2;
            
            measurementData.tt_2nd_error = Math.abs(measurementData.rt_tt_2nd - measurementData.lt_tt_2nd);
            measurementData.tt_3rd_error = Math.abs(measurementData.rt_tt_3rd - measurementData.lt_tt_3rd);
            measurementData.tt_4th_error = Math.abs(measurementData.rt_tt_4th - measurementData.lt_tt_4th);
            measurementData.ip_2nd_error = Math.abs(measurementData.rt_ip_2nd - measurementData.lt_ip_2nd);
            measurementData.ip_3rd_error = Math.abs(measurementData.rt_ip_3rd - measurementData.lt_ip_3rd);
            measurementData.ip_4th_error = Math.abs(measurementData.rt_ip_4th - measurementData.lt_ip_4th);
            
            // ì›ë³¸ ì¸¡ì •ê°’ë„ ì €ì¥
            measurementData.original = rowData;
            
            // ëª¨ë¸ë³„ ê³„ì‚°
            const heights = calculateHeights(measurementData);
            
            // ê²°ê³¼ ì €ì¥
            allResults.push({
              rowData: rowData,
              heights: heights,
              measurementData: measurementData
            });
            
            // ì „ì—­ ë³€ìˆ˜ì— ê²°ê³¼ ì €ì¥
            window.allMeasurementResults.push({
              rowData: rowData,
              heights: heights,
              measurementData: measurementData
            });
          }
          
          // ëª¨ë“  ê²°ê³¼ í‘œì‹œ
          statusDiv.innerHTML = `<span style="color: #4CAF50;">íŒŒì¼ ì²˜ë¦¬ ì™„ë£Œ! ì´ ${allResults.length}ê°œì˜ ë°ì´í„°ê°€ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.</span>`;
          displayAllResults(allResults, resultDiv);
          
          // ì²« ë²ˆì§¸ ê²°ê³¼ì˜ ë°ì´í„°ë¥¼ ìë™ ì±„ìš°ê¸° (ì„ íƒ ì‚¬í•­)
          if (allResults.length > 0) {
            fillInputFieldsByIndex(0);
          }
          
        } catch (error) {
          console.error('Excel íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
          statusDiv.innerHTML = `<span style="color: #f44336;">ì˜¤ë¥˜: ${error.message}</span>`;
        }
      };
      
      reader.onerror = function() {
        statusDiv.innerHTML = '<span style="color: #f44336;">íŒŒì¼ ì½ê¸° ì˜¤ë¥˜</span>';
      };
      
      reader.readAsBinaryString(file);
    }
    
    // ëª¨ë“  ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
    function displayAllResults(allResults, resultDiv) {
      // ê²°ê³¼ ì»¨í…Œì´ë„ˆ ìƒì„±
      let resultsHTML = '<div style="max-height: 500px; overflow-y: auto; margin-top: 15px;">';
      
      // ê° í–‰ì˜ ê²°ê³¼ë¥¼ ì²˜ë¦¬
      allResults.forEach((result, index) => {
        const rowData = result.rowData;
        const heights = result.heights;
        
        // ì´ë¦„ê³¼ ê¸°ë³¸ ì •ë³´ í‘œì‹œ
        const subjectID = rowData['í”¼í—˜ì ID'] || '';
        const gender = rowData['gender'] || '';
        const age = rowData['age'] || '';
        const actualHeight = rowData['height(cm)'] || '';
        
        resultsHTML += `
          <div style="margin-bottom: 20px; border: 1px solid #ddd; border-radius: 8px; padding: 10px; background-color: #f9f9f9;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
              <h4 style="margin: 0; font-size: 1.1em;">í”¼í—˜ì #${index + 1}</h4>
              <button type="button" class="btn-small" style="padding: 3px 8px; margin: 0;" 
                onclick="fillInputFieldsByIndex(${index})">ì´ ë°ì´í„°ë¡œ ê³„ì‚°í•˜ê¸°</button>
            </div>
            
            <div style="margin-bottom: 10px; padding: 8px; background-color: #f0f0f0; border-radius: 4px;">
              ${subjectID ? `<span>í”¼í—˜ì ID: <strong>${subjectID}</strong></span> | ` : ''}
              ${gender ? `<span>ì„±ë³„: <strong>${gender}</strong></span> | ` : ''}
              ${age ? `<span>ë‚˜ì´: <strong>${age}</strong>ì„¸</span> | ` : ''}
              ${actualHeight ? `<span>ì‹¤ì œ í‚¤: <strong>${actualHeight}</strong>cm</span>` : ''}
            </div>
            
            <div style="background-color: #e8f5e9; padding: 10px; border-radius: 6px;">
              <h4 style="margin-top: 0; margin-bottom: 10px; text-align: center; font-size: 1em;">ê³„ì‚° ê²°ê³¼ (cm)</h4>
              <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                <tr>
                  <td style="padding: 4px; width: 30%;">ëª¨ë¸ 1:</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right; width: 25%;">${heights.model1}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model1) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model1) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
                <tr>
                  <td style="padding: 4px;">ëª¨ë¸ 2:</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right;">${heights.model2}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model2) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model2) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
                <tr>
                  <td style="padding: 4px;">ëª¨ë¸ 3:</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right;">${heights.model3}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model3) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model3) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
                <tr>
                  <td style="padding: 4px;">ëª¨ë¸ 4:</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right;">${heights.model4}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model4) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model4) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
                <tr>
                  <td style="padding: 4px;">ëª¨ë¸ 5:</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right;">${heights.model5}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model5) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model5) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
                <tr>
                  <td style="padding: 4px;">ëª¨ë¸ 6:</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right;">${heights.model6}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model6) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model6) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
                <tr style="background-color: #c8e6c9;">
                  <td style="padding: 4px;">ëª¨ë¸ 7 (í†µí•©):</td>
                  <td style="padding: 4px; font-weight: bold; text-align: right;">${heights.model7}</td>
                  ${actualHeight ? `<td style="padding: 4px; text-align: right; color: ${Math.abs(parseFloat(heights.model7) - parseFloat(actualHeight)) <= 5 ? 'green' : 'red'};">ì˜¤ì°¨: ${(parseFloat(heights.model7) - parseFloat(actualHeight)).toFixed(2)}cm</td>` : '<td></td>'}
                </tr>
              </table>
            </div>
          </div>
        `;
      });
      
      resultsHTML += '</div>';
      resultDiv.innerHTML = resultsHTML;
      
      // ì „ì—­ ë³€ìˆ˜ì— ëª¨ë“  ê²°ê³¼ ì €ì¥ (ì´í›„ ë²„íŠ¼ í´ë¦­ìš©)
      window.allMeasurementResults = allResults;
    }
    
    // íŠ¹ì • ì¸ë±ìŠ¤ì˜ ë°ì´í„°ë¡œ ì…ë ¥ í•„ë“œ ì±„ìš°ê¸°
    function fillInputFieldsByIndex(index) {
      if (window.allMeasurementResults && window.allMeasurementResults[index]) {
        const result = window.allMeasurementResults[index];
        
        // ì´ë¯¸ ê³„ì‚°ëœ ì¸¡ì • ë°ì´í„°ê°€ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
        if (result.measurementData) {
          const data = result.measurementData;
          
          // ëª¨ë¸ 7 í•„ë“œ ì±„ìš°ê¸°
          document.getElementById('rt_tt_2nd').value = data.rt_tt_2nd;
          document.getElementById('rt_tt_3rd').value = data.rt_tt_3rd;
          document.getElementById('rt_tt_4th').value = data.rt_tt_4th;
          document.getElementById('rt_ip_2nd').value = data.rt_ip_2nd;
          document.getElementById('rt_ip_3rd').value = data.rt_ip_3rd;
          document.getElementById('rt_ip_4th').value = data.rt_ip_4th;
          document.getElementById('lt_tt_2nd').value = data.lt_tt_2nd;
          document.getElementById('lt_tt_3rd').value = data.lt_tt_3rd;
          document.getElementById('lt_tt_4th').value = data.lt_tt_4th;
          document.getElementById('lt_ip_2nd').value = data.lt_ip_2nd;
          document.getElementById('lt_ip_3rd').value = data.lt_ip_3rd;
          document.getElementById('lt_ip_4th').value = data.lt_ip_4th;
        } else {
          const rowData = result.rowData;
          
          // ëª¨ë¸ 7 í•„ë“œ ì±„ìš°ê¸°ë¥¼ ìœ„í•œ ì „ì²˜ë¦¬
          const getValue = (obj, fieldName) => {
            for (const key in obj) {
              if (key.toLowerCase() === fieldName.toLowerCase()) {
                return parseFloat(obj[key]) || 0;
              }
            }
            return 0;
          };
          
          // RT_TT í‰ê· ê°’ ê³„ì‚°
          const rt_tt_2nd = (getValue(rowData, 'UT_RT_TT_2nd(dorsal)') + getValue(rowData, 'UT_RT_TT_2nd(palmar)')) / 2;
          const rt_tt_3rd = (getValue(rowData, 'UT_RT_TT_3rd(dorsal)') + getValue(rowData, 'UT_RT_TT_3rd(palmar)')) / 2;
          const rt_tt_4th = (getValue(rowData, 'UT_RT_TT_4th(dorsal)') + getValue(rowData, 'UT_RT_TT_4th(palmar)')) / 2;
          
          // LT_TT í‰ê· ê°’ ê³„ì‚°
          const lt_tt_2nd = (getValue(rowData, 'UT_LT_TT_2nd(dorsal)') + getValue(rowData, 'UT_LT_TT_2nd(palmar)')) / 2;
          const lt_tt_3rd = (getValue(rowData, 'UT_LT_TT_3rd(dorsal)') + getValue(rowData, 'UT_LT_TT_3rd(palmar)')) / 2;
          const lt_tt_4th = (getValue(rowData, 'UT_LT_TT_4th(dorsal)') + getValue(rowData, 'UT_LT_TT_4th(palmar)')) / 2;
          
          // RT_IP í‰ê· ê°’ ê³„ì‚°
          const rt_ip_2nd = (getValue(rowData, 'UT_RT_IP_2nd(dorsal)') + getValue(rowData, 'UT_RT_IP_2nd(palmar)')) / 2;
          const rt_ip_3rd = (getValue(rowData, 'UT_RT_IP_3rd(dorsal)') + getValue(rowData, 'UT_RT_IP_3rd(palmar)')) / 2;
          const rt_ip_4th = (getValue(rowData, 'UT_RT_IP_4th(dorsal)') + getValue(rowData, 'UT_RT_IP_4th(palmar)')) / 2;
          
          // LT_IP í‰ê· ê°’ ê³„ì‚°
          const lt_ip_2nd = (getValue(rowData, 'UT_LT_IP_2nd(dorsal)') + getValue(rowData, 'UT_LT_IP_2nd(palmar)')) / 2;
          const lt_ip_3rd = (getValue(rowData, 'UT_LT_IP_3rd(dorsal)') + getValue(rowData, 'UT_LT_IP_3rd(palmar)')) / 2;
          const lt_ip_4th = (getValue(rowData, 'UT_LT_IP_4th(dorsal)') + getValue(rowData, 'UT_LT_IP_4th(palmar)')) / 2;
          
          // ëª¨ë¸ 7 í•„ë“œ ì±„ìš°ê¸°
          document.getElementById('rt_tt_2nd').value = rt_tt_2nd;
          document.getElementById('rt_tt_3rd').value = rt_tt_3rd;
          document.getElementById('rt_tt_4th').value = rt_tt_4th;
          document.getElementById('rt_ip_2nd').value = rt_ip_2nd;
          document.getElementById('rt_ip_3rd').value = rt_ip_3rd;
          document.getElementById('rt_ip_4th').value = rt_ip_4th;
          document.getElementById('lt_tt_2nd').value = lt_tt_2nd;
          document.getElementById('lt_tt_3rd').value = lt_tt_3rd;
          document.getElementById('lt_tt_4th').value = lt_tt_4th;
          document.getElementById('lt_ip_2nd').value = lt_ip_2nd;
          document.getElementById('lt_ip_3rd').value = lt_ip_3rd;
          document.getElementById('lt_ip_4th').value = lt_ip_4th;
        }
        
        // ëª¨ë¸ íƒ­ 7ë²ˆìœ¼ë¡œ ë³€ê²½
        showModel(6);
        
        // ê³„ì‚° ë²„íŠ¼ ìë™ í´ë¦­
        document.querySelectorAll('.model-container')[6].querySelector('button').click();
      }
    }
    
    // ì—‘ì…€ í…œí”Œë¦¿ ìƒì„± í•¨ìˆ˜
    function generateExcelTemplate() {
      // í…œí”Œë¦¿ ë°ì´í„° ìƒì„±
      const template = {
        "ì‹¤í—˜ì¼": "2023-06-01",
        "í”¼í—˜ì ID": "S001",
        "gender": "M",
        "age": 28,
        "height(cm)": 178.5,
        "UT_RT_TT_2nd(dorsal)": 7.1,
        "UT_RT_TT_2nd(palmar)": 7.3,
        "UT_RT_TT_3rd(dorsal)": 7.4,
        "UT_RT_TT_3rd(palmar)": 7.6,
        "UT_RT_TT_4th(dorsal)": 6.7,
        "UT_RT_TT_4th(palmar)": 6.9,
        "UT_LT_TT_2nd(dorsal)": 7.0,
        "UT_LT_TT_2nd(palmar)": 7.2,
        "UT_LT_TT_3rd(dorsal)": 7.3,
        "UT_LT_TT_3rd(palmar)": 7.5,
        "UT_LT_TT_4th(dorsal)": 6.6,
        "UT_LT_TT_4th(palmar)": 6.8,
        "UT_RT_IP_2nd(dorsal)": 3.5,
        "UT_RT_IP_2nd(palmar)": 3.7,
        "UT_RT_IP_3rd(dorsal)": 3.9,
        "UT_RT_IP_3rd(palmar)": 4.1,
        "UT_RT_IP_4th(dorsal)": 3.4,
        "UT_RT_IP_4th(palmar)": 3.6,
        "UT_LT_IP_2nd(dorsal)": 3.4,
        "UT_LT_IP_2nd(palmar)": 3.6,
        "UT_LT_IP_3rd(dorsal)": 3.8,
        "UT_LT_IP_3rd(palmar)": 4.0,
        "UT_LT_IP_4th(dorsal)": 3.3,
        "UT_LT_IP_4th(palmar)": 3.5
      };
      
      // ì›Œí¬ì‹œíŠ¸ ìƒì„±
      const ws = XLSX.utils.json_to_sheet([template]);
      
      // ì›Œí¬ë¶ ìƒì„±
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "ì†ê°€ë½ì¸¡ì •ë°ì´í„°");
      
      // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
      XLSX.writeFile(wb, "ì†ê°€ë½ì¸¡ì •_í…œí”Œë¦¿.xlsx");
    }
    
    // ëª¨ë“  ëª¨ë¸ì˜ í‚¤ ê³„ì‚°
    function calculateHeights(data) {
      // ëª¨ë¸ 1
      const h1 = 62.753 +
              8.793 * data.rt_ip_2nd +
              10.234 * data.rt_ip_3rd -
              1.589 * data.rt_ip_4th -
              0.135 * data.ip_2nd_error +
              0.725 * data.ip_3rd_error +
              0.511 * data.ip_4th_error +
              10.035 * data.rt_tt_2nd +
              42.546 * data.rt_tt_3rd -
              52.581 * data.rt_tt_4th +
              0.707 * data.tt_2nd_error +
              1.757 * data.tt_3rd_error -
              1.78 * data.tt_4th_error;
      
      // ëª¨ë¸ 2 (ì¡°ì •ëœ ê³„ìˆ˜ ì‚¬ìš©)
      const h2 = 72.703 +
              12.319 * data.tt_2nd_avg +
              15.625 * data.tt_3rd_avg +
              -17.944 * data.tt_4th_avg +
              7.876 * data.ip_2nd_avg +
              9.747 * data.ip_3rd_avg +
              -1.509 * data.ip_4th_avg;
      
      // ëª¨ë¸ 3
      const h3 = 72.491 +
              16.115 * data.tt_4th_avg +
              9.204 * data.ip_4th_avg;
      
      // ëª¨ë¸ 4
      const h4 = 81.627 +
              7.993 * data.rt_ip_2nd +
              5.399 * data.rt_ip_3rd +
              4.277 * data.rt_ip_4th +
              0.192 * data.ip_2nd_error +
              0.592 * data.ip_3rd_error +
              0.098 * data.ip_4th_error;
      
      // ëª¨ë¸ 5
      const h5 = 61.958 +
              24.008 * data.rt_ip_2nd;
      
      // ëª¨ë¸ 6 (ì†ë“±ì¸¡ ëª¨ë¸ - ì´ ì˜ˆì‹œì—ì„œëŠ” ì¼ë°˜ ê°’ì„ ì‚¬ìš©)
      const h6 = 58.421 +
              5.724 * data.rt_tt_2nd +
              18.346 * data.rt_tt_3rd -
              23.185 * data.rt_tt_4th +
              4.512 * data.rt_ip_2nd +
              6.913 * data.rt_ip_3rd -
              1.254 * data.rt_ip_4th +
              4.934 * data.lt_tt_2nd +
              19.285 * data.lt_tt_3rd -
              24.162 * data.lt_tt_4th +
              4.395 * data.lt_ip_2nd +
              6.857 * data.lt_ip_3rd -
              1.198 * data.lt_ip_4th;
      
      // ëª¨ë¸ 7
      const h7 = 56.137 +
              6.245 * data.rt_tt_2nd +
              20.183 * data.rt_tt_3rd -
              24.762 * data.rt_tt_4th +
              4.967 * data.rt_ip_2nd +
              7.428 * data.rt_ip_3rd -
              1.376 * data.rt_ip_4th +
              5.873 * data.lt_tt_2nd +
              21.432 * data.lt_tt_3rd -
              25.318 * data.lt_tt_4th +
              4.521 * data.lt_ip_2nd +
              7.192 * data.lt_ip_3rd -
              1.293 * data.lt_ip_4th;
      
      return {
        model1: h1.toFixed(2),
        model2: h2.toFixed(2),
        model3: h3.toFixed(2),
        model4: h4.toFixed(2),
        model5: h5.toFixed(2),
        model6: h6.toFixed(2),
        model7: h7.toFixed(2)
      };
    }
  </script>
</body>
</html>
